<!--
Section: Piecewise Forcing Functions
====================================

Introduction
============
	* We have looked at solving linear differential equations with constant coefficients when the forcing function is some combination of polynomial, exponential, sine, or cosine functions.
	* We assumed that the forcing function remained the same for any value of the independent variable.
	* Now, we want to consider the case when the forcing function can switch from one function to another function at some point. For example, we might have a forcing function that is initially <m>t^2</m>, then at some time later it switches to <m>\sin(t)</m>.
	* This behavior can be described using a piecewise defined function and in this section we will see how the Laplace transform can be used to solve linear differential equations with piecewise defined forcing functions.
	* Before we can solve such equations, we first need to learn how to rewrite piecewise defined functions in terms of functions that the Laplace transform can easily handle.
	* These functions are called <em>unit step functions</em>.

Topics
======
	* Piecewise Functions
	* Unit-Step Functions
	* Writing Piecewise Functions in Terms of Unit-Step Functions
	* Laplace Transforms of Unit-Step Functions
	* Laplace Transforms of Piecewise Functions
	* Solving Linear Differential Equations with Piecewise Forcing Functions
  -->

<section xmlns:xi="http://www.w3.org/2001/XInclude"><title> Piecewise Forcing Functions </title>

	<introduction>

		<p>
			Needs to be written.
		</p>
		
	</introduction>

<subsection><title>Piecewise Functions and Motivation</title>

	<p>
		Recall that a <em>forcing function</em> is the expression on the right-hand side of a differential equation—it's what drives or “forces” the system to behave in a certain way. So far, we've looked at smooth and continuous forcing functions like polynomials, exponentials, and trigonometric functions. These always start at <m>t = 0</m> and continue without interruption.
	</p>

	<me>
		y'' + 2y' + 3y = t + \sin(t)
	</me>

	<p>
		But what if the forcing function changes depending on the value of <m>t</m>? Suppose, for instance, that we want to solve the following differential equation:
	</p>

	<sidebyside widths="45% 5% 50%">
		<p>
			Use the <strong>top slider</strong> to adjust the value of <m>t</m>. The red point traces the value of the function at that moment in time.
			Use the <strong>number box</strong> to control when the function switches from <m>f(t) = t</m> to <m>f(t) = \sin(t)</m>.
			The active region is highlighted in bold.
		</p>
		<p/>
		<figure xml:id="figure-piecewise-single-v2">
			<caption>Visualizing a Piecewise Forcing Function</caption>
		
			<interactive xml:id="interactive-piecewise-single-v2"
				platform="jsxgraph"
				aspect="1:1"
				source="code/piecewise-interactive/piecewise-jsxgraph-v2.js">
				<sidebyside width="100%" margins="0%">
					<slate xml:id="box" surface="jsxboard" aspect="1:1"/>
				</sidebyside>
				<instructions>
					<p>
						Use the <strong>top slider</strong> to adjust the value of <m>t</m>. The red point traces the value of the function at that moment in time.
						Use the <strong>number box</strong> to control when the function switches from <m>f(t) = t</m> to <m>f(t) = \sin(t)</m>.
						The active region is highlighted in bold.
					</p>
				</instructions>
			</interactive>
		</figure>
	</sidebyside>

	<me>
		y'' + 2y' + 3y = 
		\begin{cases}
			t, 			\amp 0 \le t &lt; 2 \\
			\sin(t), 	\amp t \ge 2
		\end{cases}
	</me>

	<p>
		<sidebyside widths="48% 4% 44% 4%" valign="top">
			<p>
				That is, for the first two seconds the forcing function is a linear ramp, <m>f(t) = t</m>, then it switches to <m>\sin(t)</m> for all time after that. We could write this as a piecewise function:
				<me>
					f(t) = 
					\begin{cases}
						t, \amp 0 \le t &lt; 2 \\
						\sin(t), \amp t \ge 2
					\end{cases}
				</me>
			</p>
			<p/>
			<p>
				<image>
					<latex-image>
						\begin{tikzpicture}[domain=-2:5, samples=200, scale=0.8]

							% === Piecewise Function with 2 Parts ===
							
							% === figure/domain/tick bounds ===
							\def\tmin{-1.2}	\def\tmax{4.6}
							\def\ymin{-1.3}	\def\ymax{3}
							\def\tI{0}		\def\tF{4.6}
							\def\ttickI{-1}	\def\ttickF{4}
							\def\ytickI{-1}	\def\ytickF{2}
						
							% === Transistions ===
							\def\c{2}
						
							% === Function definitions/colors ===
							\newcommand{\f}[1]{#1}	\def\ftex{t}	\def\fColor{blue}			\def\fFill{blue!15}
							\newcommand{\g}[1]{sin(#1 r)}	\def\gtex{\sin t}		\def\gColor{green!60!black}	\def\gFill{green!15}

							% === Evaluate endpoint values ===
							\def\fc{\f{\c}}		\def\gc{\g{\c}}
						
							% === Background regions ===
							\fill[\fFill] (\tI,	\ymin)	rectangle (\c,	\ymax);
							\fill[\gFill] (\c,	\ymin)	rectangle (\tF,	\ymax);
						
							% === Axes ===
							\draw[-&gt;] (\tmin	,0		) -- (\tmax	,0		) node[below]	{$t$};
							\draw[-&gt;] (0		,\ymin	) -- (0		,\ymax	) node[left]	{};

							% === Tick marks and labels ===
							\foreach \t in {\ttickI,...,\ttickF} {
								\draw[gray!70]	(\t,0.1) -- (\t,-0.1);					% t ticks
								\node[below, font=\scriptsize] at	(\t,-0.15) {\t};	% t labels	
							}
							\foreach \y in {\ytickI,...,\ytickF} {
								\draw[gray!70]	(0.1,\y) -- (-0.1,\y);					% y ticks
								\node[left, font=\scriptsize] at	(-0.15,\y) {\y};	% y labels
							}
						
							% === Function plots ===
							\draw[\fColor, very thick] plot[domain=\tI:\c-0.05, variable=\t]	(\t, {\f{\t}});
							\draw[\gColor, very thick] plot[domain=\c:\tF, variable=\t]	(\t, {\g{\t}});

							% === Endpoint dots ===
							\draw[\fColor, thick]	(\c,{\f{\c}})	circle[radius=2pt];
							\fill[\gColor]			(\c,{\g{\c}})	circle[radius=2pt];

							% === Region Labels ===
							\node[\fColor, font=\scriptsize, above] at ({(\tI + \c)/2}, {\ymin}) {$0 \le t \lt \c$};
							\node[\gColor, font=\scriptsize, above] at ({(\c + \tF)/2}, {\ymin}) {$t \ge \c$};

							\node[\fColor, font=\small, below] at ({(\tI + \c)/2}, {\ymax}) {$f(t)=\ftex$};
							\node[\gColor, font=\small, below] at ({(\c + \tF)/2}, {\ymax}) {$f(t)=\gtex$};
						
						\end{tikzpicture}
					</latex-image>
				</image>
			</p>
			<p/>
		</sidebyside>
	</p>

	<p>
		This means the system is first forced by a ramp, <m>f(t) = t</m>, then abruptly switches to a sine wave, <m>f(t) = \sin(t)</m>, starting at <m>t = 2</m>.
	</p>

	<p>
		This function is perfectly well-defined—but it's not so easy to plug into a Laplace transform. Why? Because the definition changes halfway through. The standard Laplace table doesn't cover functions that "switch" like this.
	</p>

	<p>
		<sidebyside widths="48% 4% 44% 4%" valign="top">
			<p>
				We can write the right-hand side as a piecewise-defined function:
				<me>
					f(t) = 
					\begin{cases}
						t, \amp 0 \le t &lt; 2 \\
						\sin(t), \amp t \ge 2
					\end{cases}
				</me>
				This type of function is perfectly valid, but it doesn't play nicely with the Laplace transform—at least, not in its current form. Our standard Laplace table can't handle a function that changes its definition halfway through.
			</p>
			<p/>
			<p>
				<image>
					<latex-image>
						\begin{tikzpicture}[domain=-2:5, samples=200, scale=0.8]

							% === Piecewise Function with 2 Parts ===
							
							% === figure/domain/tick bounds ===
							\def\tmin{-1.2}	\def\tmax{4.6}
							\def\ymin{-1.3}	\def\ymax{3}
							\def\tI{0}		\def\tF{4.6}
							\def\ttickI{-1}	\def\ttickF{4}
							\def\ytickI{-1}	\def\ytickF{2}
						
							% === Transistions ===
							\def\c{2}
						
							% === Function definitions/colors ===
							\newcommand{\f}[1]{#1}	\def\ftex{t}	\def\fColor{blue}			\def\fFill{blue!15}
							\newcommand{\g}[1]{sin(#1 r)}	\def\gtex{\sin t}		\def\gColor{green!60!black}	\def\gFill{green!15}

							% === Evaluate endpoint values ===
							\def\fc{\f{\c}}		\def\gc{\g{\c}}
						
							% === Background regions ===
							\fill[\fFill] (\tI,	\ymin)	rectangle (\c,	\ymax);
							\fill[\gFill] (\c,	\ymin)	rectangle (\tF,	\ymax);
						
							% === Axes ===
							\draw[-&gt;] (\tmin	,0		) -- (\tmax	,0		) node[below]	{$t$};
							\draw[-&gt;] (0		,\ymin	) -- (0		,\ymax	) node[left]	{};

							% === Tick marks and labels ===
							\foreach \t in {\ttickI,...,\ttickF} {
								\draw[gray!70]	(\t,0.1) -- (\t,-0.1);					% t ticks
								\node[below, font=\scriptsize] at	(\t,-0.15) {\t};	% t labels	
							}
							\foreach \y in {\ytickI,...,\ytickF} {
								\draw[gray!70]	(0.1,\y) -- (-0.1,\y);					% y ticks
								\node[left, font=\scriptsize] at	(-0.15,\y) {\y};	% y labels
							}
						
							% === Function plots ===
							\draw[\fColor, very thick] plot[domain=\tI:\c-0.05, variable=\t]	(\t, {\f{\t}});
							\draw[\gColor, very thick] plot[domain=\c:\tF, variable=\t]	(\t, {\g{\t}});

							% === Endpoint dots ===
							\draw[\fColor, thick]	(\c,{\f{\c}})	circle[radius=2pt];
							\fill[\gColor]			(\c,{\g{\c}})	circle[radius=2pt];

							% === Region Labels ===
							\node[\fColor, font=\scriptsize, above] at ({(\tI + \c)/2}, {\ymin}) {$0 \le t \lt \c$};
							\node[\gColor, font=\scriptsize, above] at ({(\c + \tF)/2}, {\ymin}) {$t \ge \c$};

							\node[\fColor, font=\small, below] at ({(\tI + \c)/2}, {\ymax}) {$f(t)=\ftex$};
							\node[\gColor, font=\small, below] at ({(\c + \tF)/2}, {\ymax}) {$f(t)=\gtex$};
						
						\end{tikzpicture}
					</latex-image>
				</image>
			</p>
			<p/>
		</sidebyside>
	</p>

	<p>
		So how do we apply the Laplace transform to a piecewise-defined function? The answer is to rewrite it using building blocks that <m>\laplacesym</m> can understand. Specifically, we'll use a special function that acts like an on-off switch. It's called the <em>unit step function</em>, and it's the key to unlocking piecewise analysis.
	</p>

	<p>
		So how do we handle functions like this in the Laplace world? The trick is to rewrite them using building blocks that the Laplace transform <m>\laplacesym</m> can understand. Specifically, we'll introduce a special kind of function that acts like a light switch—off until a certain time, and on forever after. It's called the <em>unit step function</em>, and it's the key to handling piecewise-defined forcing terms.
	</p>

	<exercise label="chkpt-piecewise-form-1"><title>Spot the Piecewise Function</title>
		<statement>
			<p>
				Click on the expression that defines a piecewise function.
			</p>
		</statement>
		<areas>
			<p>
				<sidebyside>
					<p><area correct="no"><m>f(t) = t + \sin(t)</m></area></p>
					<p><area correct="yes"><m>f(t) = \begin{cases} t, \amp 0 \le t &lt; 2 \\ \sin(t), \amp t \ge 2 \end{cases}</m></area></p>
				</sidebyside>
			</p>
		</areas>
	</exercise>

	<exercise label="chkpt-piecewise-form-2"><title>Why Can't We Use the Table?</title>
		<statement>
			<p>
				Why can't we apply the standard Laplace table directly to piecewise-defined forcing functions?
			</p>
		</statement>
		<choices>
			<choice>
				<statement>The Laplace transform only works for polynomials.</statement>
				<feedback><p>No, we can handle polynomials. That's not the issue.</p></feedback>
			</choice>
			<choice correct="yes">
				<statement>The Laplace table doesn't cover functions that change definition at different times.</statement>
				<feedback><p>Correct! A piecewise function needs to be rewritten into a form the table understands.</p></feedback>
			</choice>
			<choice>
				<statement>Piecewise functions have no Laplace transform.</statement>
				<feedback><p>Incorrect. They do! But we must express them differently first.</p></feedback>
			</choice>
		</choices>
	</exercise>

	<exercise label="chkpt-piecewise-form-3"><title>Match Function to Description</title>
		<statement>
			<p>
				Match each function to the best description of its behavior.
			</p>
		</statement>
		<matches>
			<match>
				<premise><m>f(t) = t + \sin(t)</m></premise>
				<response>Continuous ramp plus oscillation</response>
			</match>
			<match>
				<premise><m>f(t) = \begin{cases} t, \amp t &lt; 2 \\ \sin(t), \amp t \ge 2 \end{cases}</m></premise>
				<response>Switches from ramp to sine at <m>t = 2</m></response>
			</match>
		</matches>
	</exercise>

</subsection>


	<subsection><title> Piecewise Functions </title>

		<p>
			We will encounter piecewise defined functions in differential equations when we think about some physical phenomenon. For example, we might consider the vibration of an airplane wing that is struck by some external object or a circuit that is initially open and then we close the circuit and the current immediately starts flowing. Both of these scenarios would require a piecewise defined function because there is a moment in time when something about the physical system changes.
		</p>
		
		<p>
		As such, we need to remember how piecewise defined functions work. Consider the function
		
		<me>
			g(t) = \left\{
			\begin{array}{ll}
				0,		\amp t \lt 1 		\\
				t^2,	\amp 1 \le t \lt 2 	\\
				-t+1,	\amp 2 \le t \lt 6 	\\
				0,		\amp t \ge 6.		\\
			\end{array} \right.
		</me>
		
		</p>
		
		<p>
			If we want to evaluate the function at a particular <m>t</m>-value, we use the restrictions on the right to point us to which piece of the function definition we should use. For example, if we want to know <m>g(3)</m>, then we look over at that right side and see that 3 falls into the interval <m>2 \le t \lt 6,</m> so we use the corresponding function, <m>-t+1</m>. Thus, <m>g(3) = -3 + 1 = -2.</m>	
		</p>
		
		<p>
			If we want to graph, we also use those restrictions. When <m>t \lt 1</m>,  or equivalently when <m>t</m> is in the interval <m>(-\infty, 1),</m> we know that the graph of <m>g</m> will look like the horizontal line <m>y=0</m>; on the interval <m>[1, 2),</m> the graph will look like the graph of the parabola <m>y = t^2</m>; etc.
		</p>

		<p>
			In the plots below you can see the entire graphs of the functions, dotted, with a solid segment that will be part of the piecewise function <m>g</m>.
		
			<sidebyside width="50%" margins="auto" valign="middle">
				<image source="./figures/piecewise_1.png"/>
				<image source="./figures/piecewise_2.png"/>
			</sidebyside>
			<sidebyside width="50%" margins="auto" valign="middle">
				<image source="./figures/piecewise_3.png"/>
				<image source="./figures/piecewise_4.png"/>
			</sidebyside>
		</p>
		
		<p>
			Now we are prepared to assemble the pieces and generate the graph of the piecewise-defined function
		
			<me>
				g(t) = \left\{
				\begin{array}{ll}
					0,		\amp t \lt 1		\\
					t^2,	\amp 1 \le t \lt 2	\\
					-t+1,	\amp 2 \le t \lt 6	\\
					0,		\amp t \ge 6		\\
				\end{array} \right.
			</me>.
		</p>
		
		<p>
			<sidebyside width="90%" margins="auto" valign="middle">
				<image source="./figures/piecewise_g.png"/>
			</sidebyside>
		</p>

		<p>
			<sidebyside width="90%" margins="auto" valign="middle">
				<image width="100%">
					<latex-image>
						\begin{tikzpicture}[domain=-3:3]
							\def\tmin{-2.5}
							\def\tmax{2.5}
							\def\c{0}

							% Draw the axes
							\draw[thick, -&gt;] (\tmin, 0) -- (\tmax, 0) node[right] {$t$};
							\draw[thick, -&gt;] (0, -0.5) -- (0, 1.8);
			
							% Draw the grid
							\draw[very thin,color=gray] (\tmin,-0.5) grid (\tmax,1.5);
			
							% Unit step function
							\draw[very thick,blue] (\tmin,0) -- (\c,0);
							\draw[dashed, blue] (\c,0) -- (\c,1);
							\draw[very thick,blue] (\c,1) -- (\tmax,1) node[above] {$U(t)$};
							
							% Open circle at the step
							\draw[fill=white] (\c,0) circle (0.08);
							
							% Solid dot at the point of the step
							\filldraw[blue] (\c,1) circle (0.08) node[left] {$1$};
			
						\end{tikzpicture}
					</latex-image>
				</image>
			</sidebyside>
		</p>

		<p>
			<sidebyside width="60%" margins="auto" valign="middle">
				<image width="100%">
					<latex-image>
						\begin{tikzpicture}[domain=-1:6, samples=200, scale=0.8]

							% === x y Bounds ===
							\def\tmin{-1}
							\def\tmax{6}
							\def\ymin{-1}
							\def\ymax{3}
						
							% === Transistions ===
							\def\t1{1}	\def\t2{4}
						
							% === Function definitions and colors ===
							\def\fA{(\x)^2}	\def\fAColor{blue}				\def\fAFill{blue!15}
							\def\fB{-\x + 4}		\def\fBColor{green!60!black}	\def\fBFill{green!15}
							\def\fC{-1}				\def\fCColor{red!70!black}		\def\fCFill{red!15}

							% === Evaluate endpoint values ===
							<!-- \pgfmathsetmacro{\fAright}{(\t1)^2} -->
							<!-- \pgfmathsetmacro{\fBleft}{-\t1 + 4} -->
							<!-- \pgfmathsetmacro{\fBright}{-\t2 + 4} -->
							<!-- \pgfmathsetmacro{\fCleft}{-1} -->
						
							% === Background regions ===
							<!-- \fill[\fAFill] (\tmin-0.5,\ymin-1)	rectangle (\t1,\ymax+1); -->
							<!-- \fill[\fBFill] (\t1,\ymin-1)	rectangle (\t2,\ymax+1); -->
							<!-- \fill[\fCFill] (\t2,\ymin-1)	rectangle (\tmax+0.5,\ymax+1); -->
						
							% === Axes ===
							\draw[-&gt;] (\tmin-0.5,0)		-- (\tmax+0.3,0)	node[above] {$t$};
							\draw[-&gt;] (0,\ymin-0.4)	-- (0,\ymax+0.5)	node[left] {$f(t)$};

							% === Tick marks and labels ===
							\foreach \x in {\tmin,...,\tmax} {
								\draw[gray!70] (\x,0.1) -- (\x,-0.1);  % t ticks
								\node[below] at (\x,-0.15) {\small \x}; 
							}
							\foreach \y in {\ymin,...,\ymax} {
								\draw[gray!70] (0.1,\y) -- (-0.1,\y);  % y ticks
								\node[left] at (-0.15,\y) {\small \y}; 
							}
						
							% === Function plots ===
							<!-- \draw[\fAColor, very thick] plot[domain=\tmin-0.5:\t1-0.02, variable=\x]	(\x, {\fA}); -->
							<!-- \draw[\fBColor, very thick] plot[domain=\t1:\t2-0.05, variable=\x]		(\x, {\fB}); -->
							<!-- \draw[\fCColor, very thick] plot[domain=\t2:\tmax+0.5, variable=\x]	(\x, {\fC}); -->

							% === Endpoint dots ===
							% fA
							<!-- \draw[\fAColor, thick] (\t1,\fAright) circle[radius=2pt]; -->
						
							% fB
							<!-- \fill[\fBColor] (\t1,\fBleft) circle[radius=2pt];           -->
							<!-- \draw[\fBColor, thick] (\t2,\fBright) circle[radius=2pt];   -->
						
							% fC
							<!-- \fill[\fCColor] (\t2,\fCleft) circle[radius=2pt]; -->

							% === Region Labels ===
							<!-- \node[\fAColor, font=\small] at ({(\tmin-0.5 + \t1)/2}, {\ymin - 0.8}) {$t &lt; \t1$}; -->
							<!-- \node[\fBColor, font=\small] at ({(\t1 + \t2)/2}, {\ymin - 0.8}) {$\t1 &lt; t &lt; \t2$}; -->
							<!-- \node[\fCColor, font=\small] at ({(\t2 + \tmax+0.5)/2}, {\ymin - 0.8}) {$t &gt; \t2$}; -->
						
						\end{tikzpicture}
					</latex-image>
				</image>
			</sidebyside>
		</p>
		
		<p>
			If you'd like more of a review feel free to look at VMI's precalculus text,
			<url href="https://drive.google.com/file/d/12b2cwH7afXhsYSDb-QCWKmFK2QCq7UfY/view">
				here
			</url>
		</p>
		
		<p> Now you try some. </p>
		
		<p>
			<term> Sketch each of the following piecewise defined functions.</term>
			<ol>
				<li> <p><m>\ds f(t) = \left\{
						\begin{array}{ll}
							0,		\amp t \lt 0		\\
							5-t,	\amp 0 \le t \lt 3	\\
							2,		\amp t \ge 3		\\
						\end{array} \right.
						</m></p>
				<answer>
					<p>
						<sidebyside widths="90%" margins="auto" valign="middle">
						<image source="./figures/piecewise_Q1.png"/>
					</sidebyside>
					</p>
				</answer>
				</li>
				<li> <p><m>\ds h(t) = \left\{
						\begin{array}{ll}
							\sin t,	\amp t \lt \pi	\\
							0,		\amp t \ge \pi	\\
						\end{array} \right.
						</m></p>
				<answer>
					<p>
						<sidebyside widths="90%" margins="auto" valign="middle">
						<image source="./figures/piecewise_Q2.png"/>
					</sidebyside>
					</p>
				</answer>
				</li>
				<li> <p><m>\ds w(t) = \left\{
						\begin{array}{ll}
							-t,		\amp t \lt 1		\\
							t^2+1,	\amp 1 \le t \lt 2	\\
							e^{-t},	\amp t \ge 2		\\
						\end{array} \right.
						</m></p>
				<answer>
					<p>
						<sidebyside widths="90%" margins="auto" valign="middle">
						<image source="./figures/piecewise_Q3.png"/>
					</sidebyside>
					</p>
				</answer>
				</li>
			</ol>
		</p>			
		
	</subsection>

	<subsection><title> Unit-Step Functions </title>

		<aside>
			<p><xref ref="audio-test1" text="custom"><em>Read Aloud</em></xref>.</p>
			<figure xml:id="audio-test1">
				<caption>Listen to the Audio</caption>
				<audio xml:id="audio-test" source="audio/test-recording-1.mp3" width="100%" />
			</figure>
		</aside>

		<p>
			The two solution techniques we have been studying most recently (undetermined coefficients and laplace transform methods) can be used to solve differential equations that are linear and have constant coefficients. Recall, however, that we would not be able to use the method of undetermined coefficients when the nonhomogeneous function is discontinuous. We will be able to use Laplace transforms to solve such equations, but we first need	to understand the <em>unit step function</em>, which will be used to rewrite discontinuous functions in a particular way.
		</p>
		
		<p>
			We begin by introducing the definition of the standard unit step function.
		</p>

		<definition xml:id="unit-step-function">
			<statement>
				<p>
					The <em> unit step function</em>, <m>U(t)</m>, is defined and graphed as below.
				</p>
				<sidebyside widths="40% 50%">
					<p>
						<me>
							U(t) = \left\{
							\begin{array}{ll}
								0,	&amp; t \lt 0\\
								1,	&amp; t \ge 0.
							\end{array} \right.
						</me>
					</p>
					<p>
						<image width="100%">
							<latex-image>
								\begin{tikzpicture}[domain=-3:3]
									\def\tmin{-2.5}
									\def\tmax{2.5}
									\def\c{0}

									% Draw the axes
									\draw[thick, -&gt;] (\tmin, 0) -- (\tmax, 0) node[right] {$t$};
									\draw[thick, -&gt;] (0, -0.5) -- (0, 1.8);
					
									% Draw the grid
									\draw[very thin,color=gray] (\tmin,-0.5) grid (\tmax,1.5);
					
									% Unit step function
									\draw[very thick,blue] (\tmin,0) -- (\c,0);
									\draw[dashed, blue] (\c,0) -- (\c,1);
									\draw[very thick,blue] (\c,1) -- (\tmax,1) node[above] {$U(t)$};
									
									% Open circle at the step
									\draw[fill=white] (\c,0) circle (0.08);
									
									% Solid dot at the point of the step
									\filldraw[blue] (\c,1) circle (0.08) node[left] {$1$};
					
								\end{tikzpicture}
							</latex-image>
						</image>
					</p>
				</sidebyside>
			</statement>
		</definition>

		<sidebyside width="60%">
			<stack>

				<image width="100%">
					<latex-image>
						\begin{tikzpicture}[domain=-4:4]
							\def\tmin{-3}
							\def\tmax{-2}
							\def\c{1}
							\def\d{3}

							% Draw the axes
							\draw[thick, -&gt;] (\tmin, 0) -- (\d, 0) node[right] {$t$};
							\draw[thick, -&gt;] (0, -0.5) -- (0, 1.8);
			
							% Draw the grid
							\draw[very thin,color=gray] (\tmin,-0.5) grid (\d,1.5);
			
							% Unit step function
							\draw[very thick,blue] (\tmin,0) -- (\tmax,0);
							\draw[dashed, blue] (\tmax,0) -- (\tmax,1);
							\draw[very thick,blue] (\tmax,1) -- (\d,1);
							\draw[blue] (2,1) node[above] {$U(t+2)$};
							
							% Open circle at the step
							\draw[fill=white] (\tmax,0) circle (0.08) node[below] {$\tmax$};
							
							% Solid dot at the point of the step
							\filldraw[blue] (\tmax,1) circle (0.08) node[left] {$1$};
			
						\end{tikzpicture}
					</latex-image>
				</image>
		
				<image width="100%">
					<latex-image>
						\begin{tikzpicture}[domain=-4:4]
							\def\tmin{-3}
							\def\tmax{-2}
							\def\c{1}
							\def\d{3}

							% Draw the axes
							\draw[thick, -&gt;] (\tmin, 0) -- (\d, 0) node[right] {$t$};
							\draw[thick, -&gt;] (0, -0.5) -- (0, 1.8);
			
							% Draw the grid
							\draw[very thin,color=gray] (\tmin,-0.5) grid (\d,1.5);
			
							% Unit step function
							\draw[very thick,blue] (\tmin,0) -- (\c,0);
							\draw[dashed, blue] (\c,0) -- (\c,1);
							\draw[very thick,blue] (\c,1) -- (\d,1);
							\draw[blue] (2,1) node[above] {$U(t-1)$};
							
							% Open circle at the step
							\draw[fill=white] (\c,0) circle (0.08) node[below] {$\c$};
							
							% Solid dot at the point of the step
							\filldraw[blue] (\c,1) circle (0.08) node[left] {$1$};
			
						\end{tikzpicture}
					</latex-image>
				</image>

				<image width="100%">
					<latex-image>
						\begin{tikzpicture}[domain=-4:4]
							\def\tmin{-3}
							\def\tmax{-2}
							\def\c{1}
							\def\d{3}

							% Draw the axes
							\draw[thick, -&gt;] (\tmin, 0) -- (\d, 0) node[right] {$t$};
							\draw[thick, -&gt;] (0, -0.5) -- (0, 1.8);
			
							% Draw the grid
							\draw[very thin,color=gray] (\tmin,-0.5) grid (\d,1.5);
			
							% Unit step function
							\draw[very thick,blue] (\tmin,0) -- (\tmax,0);
							\draw[dashed, blue] (\tmax,0) -- (\tmax,1);
							\draw[very thick,blue] (\tmax,1) -- (\c,1);
							\draw[dashed, blue] (\c,1) -- (\c,0);
							\draw[very thick,blue] (\c,0) -- (\d,0);
							\draw[blue] (-0.5,1) node[above] {$U(t+2)-U(t-1)$};
							
							% Open circle at the step
							\draw[fill=white] (\tmax,0) circle (0.08) node[below] {$\tmax$};
							\draw[fill=white] (\c,1) circle (0.08);
							
							% Solid dot at the point of the step
							\filldraw[blue] (\tmax,1) circle (0.08) node[left] {$1$};
							\filldraw[blue] (\c,0) circle (0.08) node[below] {$\c$};
						\end{tikzpicture}
					</latex-image>
				</image>

			</stack>
			
		</sidebyside>

		<example><title> Let <m>U(t)</m> be the unit step function and <m> f(t) = t^2-2 </m>. Then compute the following values </title>

			<solution><title> <m>U(2.7)</m> </title>
				<p>
					Since <m>t = 2.7 \ge 0</m> (positive),
					<me>
						U(2.7) = 1
					</me>.
				</p>
			</solution>

			<solution><title> <m>U(-5.32)</m> </title>

				<p>
					Since <m>-5.32 &lt; 0</m> (negative),
					<me>
						U(-5.32) = 0
					</me>.
				</p>
			
			</solution>

			<solution><title> <m>U(2)\cdot f(2)</m> </title>

				<p>
					<me>
						U(2)\cdot f(2) = 1\cdot f(2) = (2)^2 - 2 = (4 - 2) = 2
					</me>.
				</p>

			</solution>

			<solution><title> <m>U(-3)\cdot f(-3)</m> </title>

				<p>
					<me>
						U(-3)\cdot f(-3) = 0\cdot ((-3)^2 - 2) = 0\cdot (9 - 2) = 0
					</me>.
				</p>

			</solution>

			<solution><title> <m>U(k)\cdot f(k)</m>, where <m>k \ge 0</m> </title>

				<p>
					Since <m>k \ge 0,</m> we know that <m>U(k) = 1,</m> so
					<me>
						U(k)\cdot f(k) = 1\cdot f(k) = k^2 - 2
					</me>.
				</p>

			</solution>

			<solution><title> <m>U(k)\cdot f(k)</m>, where <m>k &lt; 0</m> </title>

				<p>
					Since <m>k \lt 0,</m> we know that <m>U(k) = 0,</m> so
					<me>
						U(k)\cdot f(k) = 0\cdot f(k) = 0
					</me>.
				</p>

			</solution>

		</example> 

		<p>
			It's important to remember that from this point forward, that the unit step function is well-defined. There is only one unit step function, <m>U(t)</m>, in the same way that there is only one sine function, <m>\sin(t).</m>  We will now build on the definition to learn more about how this function behaves.
		</p>

		<example>
			<p>
				Consider the function <m>f(t) = U(t-3)</m> and complete the following:
				<ol>
					<li>evaluate <m>f(2)</m>.</li>
					<li>evaluate  <m>f(7.43)</m>.</li>
					<li>evaluate  <m>f(-1)</m>.</li>
					<li>evaluate <m>f(k),</m> where <m>k \gt 3</m>.</li>
					<li>evaluate  <m>f(k),</m> where <m>k \lt 3</m>.</li>
					<li>Sketch <m>f(t).</m></li>
					<li>Write <m>f(t)</m> as a piecewise defined function.</li>
				</ol>
			</p>
			
			<p/>
			<solution>
				<p>
					<ol>
						<li>
							Notice that <m>f(2) = U(2-3) = U(-1)</m>.  Since the input to the unit step function is	negative, we have <m>f(2) = 0.</m>
						</li>
						<li>
							Similar to the previous question, <m>f(7.43) = U(7.43-3) = U(4.43)</m>.  In this case, the input to the unit step function is positive, so we have <m>f(7.43) = 1.</m>
						</li>
						<li>
							As in the previous two questions, we evaluate <m>f(-1)</m> as follows.
							<me>
								f(-1) = U(-1 - 3) = U(-4) = 0
							</me>
						</li>
						<li>
							Suppose <m>k \gt 3.</m> If we substitute <m>k</m> into the function <m>f</m>, we have <m>f(k) = U(k-3).</m>	In order to evaluate this, we need to know if the input to the unit step function, <m>k - 3</m>, is positive or negative.  Since <m>k \gt 3,</m> we know that <m>k - 3</m> is positive, and therefore
							<me>
								f(k) = U(k-3) = 1
							</me>.
						</li>
						<li>
							Suppose now that <m>k \lt 3.</m> If we substitute <m>k</m> into the function <m>f</m>, we have <m>f(k) = U(k-3).</m>	Since <m>k \lt 3,</m> we know that the input to the unit step function, <m>k - 3</m>, is negative, and therefore
							<me>
								f(k) = U(k-3) = 0
							</me>.
						</li>
						<li>
							<sidebyside widths="90%" margins="auto" valign="middle">
								<image source="figures/soln_fig2.png" />
							</sidebyside>
							<image xml:id="unit-step-t-minus-3-plot" width="60%">
								<sageplot>
									U = plot(0, (x, -2, 2.9), color='blue', thickness=4, ymin=-1, ymax=1.5, fontsize=20, ticks=[1,1])
									U += plot(1, (x, 3, 5), color='blue', thickness=4, ymin=-1, ymax=1.5, fontsize=20, ticks=[1,1])
									U += point([3,0], color = "blue", faceted=True, size = 80)
									U += point([3,0], color = "white", faceted=True, size = 15)
									U += point([3,1], color = "blue", faceted=True, size = 80)
									U
								</sageplot>
							</image>
						</li>
						<li>
							<me>
								f(t) =  \left\{
								\begin{array}{ll}
									0,	\amp t \lt 3\\
									1,	\amp t \ge 3.
								\end{array} \right.
							</me>
						</li>
					</ol>
				</p>
			</solution>
		</example>

		<example><title>Forcing with a Step Function</title>
			<p>
				<statement>
					<p>
						Solve the initial value problem using the Laplace transform:
					</p>
					<me>
						y'' + 4y = u_3(t), \quad y(0) = 0,\quad y'(0) = 0
					</me>
				</statement>
			</p>

			<solution>
				<p>
					<theorem xml:id="lt-roadmap-example-4"><title> Roadmap-Summary </title>
						<p>
							<sidebyside widths="30% 12% 58%" valign="middle">
								<p>
									<md>
										<mrow>	y'' + 4y = u_3(t)	</mrow>
										<mrow>	\small y(0) = 0,\ y'(0) = 0	</mrow>
									</md>
								</p>
								<p><me>\os{\Large\text{1️⃣}}{\us{\large\text{forward}}{\os{\large\laplacesym}{\longrightarrow}}}</me></p>
								<p>
									<me>
										s^2Y + 4Y = \frac{e^{-3s}}{s}
									</me>
								</p>
							</sidebyside>
							<sidebyside widths="60% 10% 30%" valign="middle">
								<p/>
								<p><me>\downarrow</me></p>
								<p>
									2️⃣ Solve for <m>Y</m>
								</p>
							</sidebyside>
						</p>
						<p>
							<sidebyside widths="40% 10% 50%" valign="middle">
								<p/>
								<p/>
								<p>
									<me>
										Y(s) = \frac{e^{-3s}}{s(s^2 + 4)}
									</me>
								</p>
							</sidebyside>
						</p>
						<p>
							<sidebyside widths="60% 10% 30%" valign="middle">
								<p/>
								<p><me>\downarrow</me></p>
								<p>
									3️⃣ Prepare for <m>\laplacesym^{-1}</m>
								</p>
							</sidebyside>
							<sidebyside widths="38% 12% 50%" valign="middle">
								<p>
									<me>
										y(t) = u_3(t)\left(1 - \cos(2(t - 3))\right)
									</me>
								</p>
								<p><me>\os{\Large\text{4️⃣}}{\us{\large\text{backward}}{\os{\large\laplacesym^{-1}}{\longleftarrow}}}</me></p>
								<p>
									<me>
										Y(s) = \frac{e^{-3s}}{s(s^2 + 4)}
									</me>
								</p>
							</sidebyside>
						</p>
					</theorem>
				</p>

				<p><term>Step 1: Apply the Laplace Transform</term>.</p>
				<p>
					<sidebyside widths="83% 17%" valign="bottom">
						<p>
							<md>
								<mrow>
									\lap{y'' + 4y} = \lap{u_3(t)}
								</mrow>
								<mrow>
									s^2Y + 4Y \amp = \frac{e^{-3s}}{s}
								</mrow>
							</md>
						</p>
						<p>
							<md>
								<mrow>				\amp\text{ Laplace}	</mrow>
								<mrow>	\leftarrow	\amp\text{ Equation}	</mrow>
							</md>
						</p>
					</sidebyside>
				</p>

				<p><term>Step 2: Solve for <m>Y(s)</m></term>.</p>
				<p>
					<sidebyside widths="15% 50% 35%" valign="bottom">
						<p/>
						<p>
							<md>
								<mrow>	(s^2 + 4)Y	\amp = \frac{e^{-3s}}{s}	</mrow>
								<mrow>	Y(s)		\amp = \frac{e^{-3s}}{s(s^2 + 4)}	</mrow>
							</md>
						</p>
						<p>
							<md>
								<mrow>	\leftarrow\text{ Laplace Solution}\vphantom{\frac12}	</mrow>
							</md>
						</p>
					</sidebyside>
				</p>

				<p><term>Step 3: Prepare for the Inverse Transform</term>.</p>
				<p>
					The exponential factor <m>e^{-3s}</m> indicates a delay. Focus on the base transform:
					<me>
						\frac{1}{s(s^2 + 4)}
					</me>
					<p>
						From the table, this matches the transform of <m>1 - \cos(2t)</m>. Therefore:
					</p>
					<me>
						\ilap{ \frac{1}{s(s^2 + 4)} } = 1 - \cos(2t)
					</me>
					<p>
						The delay is applied using the shift theorem.
					</p>
				</p>

				<p><term>Step 4: Take the Inverse Transform</term>.</p>
				<p>
					<md>
						<mrow>
							y(t) = \ilap{ \frac{e^{-3s}}{s(s^2 + 4)} } = u_3(t)\left[1 - \cos(2(t - 3))\right]
						</mrow>
					</md>
				</p>

				<p>
					Therefore, the solution is:
					<me>
						y(t) = u_3(t)\left(1 - \cos(2(t - 3))\right)
					</me>
				</p>
			</solution>
		</example>

		<p>
			This result is consistent with our understanding of shifting functions.  That is, if we want to sketch the graph of the function <m>U(t-3),</m> then we can shift the graph of <m>U(t)</m> three units to the right. Another way to think about this is that the function <m>U(t-3)</m> changes its behavior at <m>t = 3</m> (in that its output is 0 when the input variable <m>t</m> is less than 3 and its output is 1 when the input variable <m>t</m> is greater than 3).
		</p>

		<p>
			Using this same line of thinking, if <m>g(t) = U(t-7),</m> we can surmise that <m>g</m> changes behavior at <m>t = 7</m>.
		</p>

		<example><title> Sketch the function <m>p(t) = -2\ U(t-2)</m> </title>
			<solution><title> Sketch <m>p(t)</m> </title>
				<p>
					Since <m>U(t-2)</m> is <m>U(t)</m> shifted to the right by <m>2</m>, the jump in the graph occurs at <m>t=2</m> (see below). Additionally, multiplying by <m>-2</m> reflects the graph about the <m>x</m>-axis and scales it by <m>2</m>, as shown below.
				</p>

				<sidebyside width="75%">
						<image width="100%">
							<latex-image>
								\begin{tikzpicture}

									\def\tmin{-1}
									\def\t1{2}
									\def\tmax{5}

									% Axis, Ticks and labels
									\draw[-&gt;] (\tmin, 0) -- (\tmax, 0) node[anchor=north] {$t$};
									\draw[-&gt;] (0, -2.6) -- (0, 1.6) node[anchor=east] {$g(t)$};
									\node at (-0.2, 1) {$1$};
									\draw[shift={(0,1)},color=black] (2pt,0pt) -- (-2pt,0pt);
									\node at (-0.3, -2) {$-2$};
									\draw[shift={(0,-2)},color=black] (2pt,0pt) -- (-2pt,0pt);
									\node[anchor=north] at (\t1, 0) {$2$};
									\draw[shift={(\t1,0)},color=black] (0pt,2pt) -- (0pt,-2pt);
									
									% Function plot
									\draw[thick, blue] (\tmin, 0) -- (\t1, 0);
									\draw[thick, blue] (\t1, -2) -- (\tmax, -2);
									\draw[thick, black!60!green, opacity=0.3] (\t1, 1) -- (\tmax, 1);

									% Dots and labels
									\filldraw[black!60!green, opacity=0.8] (\t1, 1) circle (2pt) node[anchor=south west] {$U(t-2)$};
									\filldraw[blue] (\t1, -2) circle (2pt) node[anchor=south west] {$-2U(t-2)$};
									\draw[dashed, opacity=0.2] (\t1, 1) -- (\t1, -2);
									

								\end{tikzpicture}
							</latex-image>
						</image>
				</sidebyside>
			</solution>
		</example>

		<xi:include href="./c7-exercises/c7-chkpts-4-1-1-unit-step-functions.ptx" />

	</subsection>

	<subsection><title> Writing Piecewise Functions in terms of Unit-Step Functions </title>
		
		<p>
			In the previous section, we were learning the definition of unit step function and finding a piecewise defined formula for the function. This was an important step for us as we got used to unit step functions, but we what we really need is to be able to do the opposite of what we have been doing in the previous section: when given a piecewise defined function, we need to be able to write the function in terms of unit step functions. Once we have this skill, we will focus on taking Laplace transforms involving unit step functions, which we will need when we solve DEs.
		</p>

		<p>
			Another useful way to think about unit step functions is to think about them as being on or off.  For example, <m>U(t-2)</m> has a value of zero, or is 'turned off', when <m>t \lt 2</m>, and when <m>t \gt 2,</m> <m>U(t-2)</m> has a value of 1, or is 'turned on'.  Framing unit step functions this way may be helpful as we move forward and consider more complicated functions.
		</p>

		<example><title> Complete the following for the function <m>w(t)</m> </title>

			<p>
				<me>
					w(t) = 6 + 5\ U(t-1) - 4\ U(t-3)
				</me>.
			</p>

			<solution><title> Sketch <m>w(t)</m> </title>
				<p>
					We can begin by identifying <m>t</m>-values where the function changes behavior.  We know that <m>U(t-1)</m> changes behavior at <m>t = 1</m> and <m>U(t-3)</m> changes behavior at <m>t = 3,</m>	so <m>w(t)</m> will change behavior at both <m>t = 1</m> and <m>t = 3.</m>  These <m>t</m>-values break the	<m>t</m>-number line into three regions:  (1)  <m>t \lt 1</m>, (2) <m>1 \lt t \lt 3,</m> and (3) <m>t \gt 3.</m>

					<image xml:id="unit-step-number-line-01" width="60%">
						<latex-image>
							\begin{tikzpicture}
								% Axis, ticks, and labels
								\draw[latex-latex] (-2.5,0) -- (5.5,0);
								\foreach \x in {-2,-1,0,1,2,3,4,5} \draw[shift={(\x,0)},color=black] (0pt,3pt) -- (0pt,-3pt);
								\foreach \x in {-2,-1,0,1,2,3,4,5} \draw[shift={(\x,0)},color=black] (0pt,0pt) -- (0pt,-3pt) node[below] {$\x$};

								\draw [line width=1.5mm, red  , opacity=0.3] (-2.5,0) -- node[align=center,above, opacity=1] {t \lt\ 1} (1,0) ;
								\draw [line width=1.5mm, black!60!green, opacity=0.3] (1,0)	-- node[align=center,above, opacity=1] {1 \lt\ t \lt\ 3} (3,0) ;
								\draw [line width=1.5mm, blue , opacity=0.3] (3,0)	-- node[align=center,above, opacity=1] {t \gt\ 3} (5.5,0) ;
							\end{tikzpicture}
						</latex-image>
					</image>

					<ul>
						<li>
							<p>
								<em> If we choose <m>t</m>-values such that <m>t \lt 1</m> (red):</em>
								<ul>
									<li><m>t-1</m> is negative, so <m>U(t-1) = 0,</m></li>
									<li><m>t-3</m> is negative, so <m>U(t-3) = 0.</m></li>
								</ul>
								<aside>
									<p>How about this for formatting the analysis?</p>
								</aside>
								Therefore, when <m>t \lt 1</m> (red), we have
								<me>
									w(t) = 6 + 5\ U(t-1) - 4\ U(t-3) = -3 + 5\cdot 0 - 4\cdot 0 = 6
								</me>.
							</p>
						</li>
					
						<li>
							<em> If we choose <m>t</m>-values such that <m>1 \lt t \lt 2</m>:</em> then <m>t - 1</m> is positive, so <m>U(t-1) = 1,</m>	and <m>t - 2</m> is negative, so <m>U(t-2) = 0.</m> Therefore  when <m>1 \lt t \lt 2,</m>	<m>w(t) = 6 + 5\ U(t-1) - 4\ U(t - 2) = 6 + 5\cdot 1 - 4 \cdot 0 = 11.</m>
						</li>
					
						<li>
							<em> If we choose <m>t</m>-values such that <m>t \gt 2</m>:</em> then <m>t - 1</m> is positive, so <m>U(t-1) = 1,</m>	and <m>t - 2</m> is positive, so <m>U(t-2) = 1.</m> Therefore  when <m>t \gt 2,</m>	<m>w(t) = 6 + 5\ U(t-1) - 4\ U(t - 2) = 6 + 5\cdot 1 - 4 \cdot 1 = 7.</m>
						</li>
					</ul>
				</p>

				<p>
					Thus, we can sketch the function as shown below.
					<image xml:id="unit-step-w-plot1" width="60%">
						<sageplot>
							U = plot(6, (x, -2, 0.9), color='red', thickness=4, ymin=-1, ymax=11.5, fontsize=20, ticks=[list(range(-2,6)),list(range(1,12,2))])
							U += plot(11, (x, 1, 1.9), color='green', thickness=4)
							U += plot(7, (x, 2, 5), color='blue', thickness=4)
							U += point([1,6], color = "red", faceted=True, size = 80)
							U += point([1,6], color = "white", faceted=True, size = 15)
							U += point([1,11], color = "green", faceted=True, size = 80)
							U += point([2,11], color = "green", faceted=True, size = 80)
							U += point([2,11], color = "white", faceted=True, size = 15)
							U += point([2,7], color = "blue", faceted=True, size = 80)
							U
						</sageplot>
					</image>
				</p>
			</solution>

			<solution><title> Write <m>w(t)</m> as a piecewise function. </title>
				<p>
					The piecewise defined function representation of <m>w(t)</m> is
					<me>
						w(t) = \left\{
						\begin{array}{ll}
							6,	&amp; t \lt 1,\\
							11,	&amp; 1\le t \lt 2,\\
							7,	&amp; t \ge 2.
						\end{array} \right.
					</me>.
				</p>
			</solution>
		</example>

		<p>
			What lessons can we take away from this example?  When <m>t \lt 1,</m> both of the unit step functions are 'turned off', so the only thing contributing to the function is the constant term, <m>6.</m>  At <m>t = 1,</m> the first unit step function, <m>5\ U(t-1),</m> 'turns on', and the result is a jump discontinuity in the graph of the function at <m>t = 1,</m> and the function jumps from a value of <m>6</m> to a value of <m>6+5 = 11.</m>
		</p>

		<p>
			The function changes behavior next at <m>t = 2</m>, when the <m>-4\ U(t-2)</m> function 'turns on' and therefore the function jumps from the previous value of <m>11</m> to its final value of <m>11 + (-4) = 7.</m>
		</p>

		<example><title> Complete the following for the function <m>z(t)</m> </title>
		
			<p>
				<me>
					z(t) = 7 - 7\ U(t-2) + t^2\ U(t-4)
				</me>.
			</p>

			<solution><title> Evaluate <m>z(1)</m> </title>
				<p>
					<md>
						<mrow> z(1)	\amp = 7 - 7\ U(1-2) + (1)^2\ U(1-4)</mrow>
						<mrow>		\amp = 7 - 7\ \ub{U(-1)}_{=\ 0} + \ub{U(-3)}_{=\ 0} = 7</mrow>
					</md>
				</p>
			</solution>
			
			<solution><title> Evaluate <m>z(3)</m> </title>
				<p>
					<md>
						<mrow> z(3)	\amp = 7 - 7\ U(3-2) + (3)^2\ U(3-4)</mrow>
						<mrow>		\amp = 7 - 7\ \ub{U(1)}_{=\ 1} + 9\ \ub{U(-1)}_{=\ 0} = 0</mrow>
					</md>
				</p>
			</solution>

			<solution><title> Evaluate <m>z(10)</m> </title>
				<p>
					<md>
						<mrow> z(10)	\amp = 7 - 7\ U(10-2) + (10)^2\ U(10-4)</mrow>
						<mrow>			\amp = 7 - 7\ \ub{U(8)}_{=\ 1} + 100\ \ub{U(7)}_{=\ 1} = 100</mrow>
					</md>
				</p>
			</solution>

			<solution><title> Sketch <m>z(t)</m> </title>
				<p>
					We can begin by identifying <m>t</m>-values where the function changes behavior.  We know that <m>U(t-2)</m> changes behavior at <m>t = 2</m> and <m>U(t-4)</m> changes behavior at <m>t = 4,</m>
					so <m>z(t)</m> will change behavior at both <m>t = 2</m> and <m>t = 4.</m>  These <m>t</m>-values break the <m>t</m>-number line into three regions:  (1)  <m>t \lt 2</m>, (2) <m>2 \lt t \lt 4,</m> and (3) <m>t \gt 4.</m> (INSERT A SMALL PICTURE OF A NUMBER LINE IN THE MARGIN HERE?)
				</p>

				<ul>
				
					<li>
						<em> If we choose <m>t</m>-values such that <m>t \lt 2</m>:</em> Then <m>t - 2</m> is negative, so <m>U(t-2) = 0,</m>
						and <m>t - 4</m> is negative, so <m>U(t-4) = 0.</m> Therefore  when <m>t \lt 2,</m>
						<m>z(t) = 7 - 7\ U(t-2) +t^2\ U(t - 4) = 7 - 7\cdot 0 + t^2\cdot 0 = 7.</m>
					</li>
				
					<li>
						<em> If we choose <m>t</m>-values such that <m>2 \lt t \lt 4</m>:</em> then <m>t - 2</m> is positive, so <m>U(t-2) = 1,</m>
						and <m>t - 4</m> is negative, so <m>U(t-4) = 0.</m> Therefore  when <m>2 \lt t \lt 4,</m>
						<m>z(t) = 7 - 7\ U(t-2) - t^2\ U(t - 4) = 7 + 7\cdot 1 + t^2 \cdot 0 = 0.</m>
					</li>
				
					<li>
						<em> If we choose <m>t</m>-values such that <m>t \gt 4</m>:</em> then <m>t - 2</m> is positive, so <m>U(t-2) = 1,</m>
						and <m>t - 4</m> is positive, so <m>U(t-4) = 1.</m> Therefore  when <m>t \gt 4,</m>
						<m>z(t) = 7 - 7\ U(t-2) - t^2\ U(t - 4) = 7 - 7\cdot 1 + t^2\cdot 1 = t^2.</m>
					</li>
				</ul>
				<p>
					We see that when <m>t \gt 4</m>, the function should look like the parabola <m>t^2.</m>
					Thus, we can sketch the function as shown below.
					<image xml:id="unit-step-3term-w-t-squared-plot" width="60%">
						<sageplot>
							U = plot(0, (x, -2, 1.9), color='blue', thickness=4, ymin=-2.5, ymax=1.5, fontsize=20, ticks=[1,1])
							U += plot(-2, (x, 2, 5), color='blue', thickness=4, ymin=-2.5, ymax=1.5, fontsize=20, ticks=[1,1])
							U += point([2,0], color = "blue", faceted=True, size = 80)
							U += point([2,0], color = "white", faceted=True, size = 15)
							U += point([2,-2], color = "blue", faceted=True, size = 80)
							U
						</sageplot>
					</image>
				</p>
			</solution>

			<solution><title> Write <m>z(t)</m> as a piecewise function. </title>
				<p>
					We can write <m>z(t)</m> as a piecewise defined function as follows.
					<me>
						z(t) = \left\{
						\begin{array}{ll}
							7,	\amp t \lt 2,\\
							0,	\amp 2\le t \lt 4,\\
							t^2,\amp t \ge 4.
						\end{array} \right.
					</me>.
				</p>
			</solution>
			
		</example>

		<p>
			Let's step back again and see what we can generalize from this example.  Notice that this function had a value of <m>7</m> for <m>t \lt 2.</m>  Then the unit step function <m>U(t-2)</m> became relevant, but because its coefficient was <m>-7</m>, it had the effect of 'turning off' the <m>7</m> that was already present.  It can be helpful for us moving forward to be able to think about negative coefficients as 'turning off' a function.
		</p>

		<p>
			This is also the first example that demonstrates a non-constant coefficient.  Notice that it behaves no differently than a constant coefficient; the unit step function served to turn the function on after <m>t = 4.</m>
		</p>

		<p>
			Let's reflect on what happened.  For the function <m>h(t) = 3\ U(t-2),</m> the 2 indicates that the function changes behavior at <m>t = 2,</m> and the 3 changes the amplitude of the nonzero portion of the function.
		</p>

		<example>
			<p>
				Sketch the function <m>s(t) = \sin t + (-\sin t + 4 - t)U(t-\pi).</m>
			</p>
					
			<p/>
			<solution>
				<p>
					We first identify where the function will change behavior.  In this case, it will change behavior only at <m>t = \pi.</m>  We can then think about the functions behavior for <m>t \lt \pi</m> and for <m>t \ge \pi.</m>  Notice that when <m>t \lt \pi,</m>  <m>U(t-\pi) = 0,</m> and therefore <m>s(t) = \sin t.</m>  When <m>t \ge \pi,</m> <m>U(t-\pi) = 1,</m> and then we have <m>s(t)= \sin t + (-\sin t +4 - t) \cdot 1 = 4 - t.</m>  This means we could write <m>s(t)</m> as the following piecewise defined function, and sketch it .
					<me>
						s(t) = \left\{
						\begin{array}{ll}
							\sin t,	\amp t \lt \pi,\\
							4 - t,	\amp t \ge \pi.
						\end{array} \right.
					</me>
				</p>

				<p>
					(INSERT FIGURE HERE)
				</p>
			</solution>
		</example>


		<example>
			<p>
				Sketch the function <m>v(t) = t+5 - (t+5)U(t-2) + (t-4)U(t-3).</m>
			</p>
			
			<p/>
			<solution>
				<p>
					We first identify where the function will change behavior: <m>t = 2</m> and <m>t = 3.</m> Since there are two <m>t</m>-values where the function changes behavior, we need to consider three regions of the number line:  (1) <m>t \lt 2</m>, (2) <m>2 \lt t \lt 3</m>, and (3) <m>t \gt 3.</m>

					<ul>
					
						<li>
							When <m>t \lt 2</m>, both unit step functions are 'turned off', so <m>v(t) = t+5.</m>
						</li>
						
						<li>
							When <m>2\le t \lt 3,</m> <m>v(t) = </m>
						</li>

					</ul>

					<me>
						s(t) = \left\{
						\begin{array}{ll}
							\sin t,	\amp t \lt \pi,\\
							4 - t,	\amp t \ge \pi.
						\end{array} \right.
					</me>
				</p>

				<p>
					(INSERT FIGURE HERE)
				</p>
			</solution>
		</example>

		<p>
			Now that we've determined what the function looks like, we can look back at the formula for	the function and see that we start with a sine function, but then at <m>t = \pi,</m> the sine function gets 'turned off' (because of the negative sign) and the linear function <m>4 - t</m> gets 'turned on'.
		</p>

		<example xml:id="ex_sketch_write_f_as_pw_func">
			<p>
				Sketch the function
				<me>
					f(t) = \left\{
					\begin{array}{ll}
						e^t,	\amp t \lt 1,\\
						t^3	\amp t \ge 1,
					\end{array} \right.
				</me>.
				and then write the function in terms of unit step functions.
			</p>

			<p>
				(include a sketch of the function here)
			</p>

			<p/>
			<solution>
				<p>
					The first thing we want to take note of is for what <m>t</m>-values the function changes behavior. This function changes behavior at <m>t = 1,</m> and we will use a unit step function to help us capture that change in behavior, so we need a unit step function that has a discontinuity at <m>t = 1.</m> That is, we know we need at <m>U(t-1).</m> Thus, the form of our function is
					<me>
						f(t) = <fillin>{50}</fillin> + <fillin>{50}</fillin>\cdot U(t-1)
					</me>.
				</p>

				<p>
					Now we need only determine what goes in the blanks. When <m>t \lt 1,</m> the unit step function <m>U(t-1)</m> will have a value of zero. We also know that when <m>t \lt 1,</m> <m>f(t) = e^t.</m> Therefore the first blank must be <m>e^t.</m> That is,
					<me>
						f(t) = e^t + <fillin>{50}</fillin>\cdot U(t-1)
					</me>.
				</p>

				<p>
					When <m>t&gt;1,</m> <m>U(t-1) = 1,</m> and <m>f(t) = t^3.</m> Thus we have
					<md>
						<mrow>t \gt 1:	f(t)	\amp = e^t + <fillin>{50}</fillin>\cdot 1</mrow>
						<mrow>t^3	\amp = e^t + <fillin>{50}</fillin>\cdot 1</mrow>
					</md>
				</p>

				<p>
					In order to make the equation true, it must be that the function that goes in the line is <m>-e^t + t^3,</m> so that we have
					<me>
						f(t) = e^t + (-e^t + t^3)\cdot U(t-1)
					</me>.
				</p>

				<p>
					This makes sense because when <m>t = 1,</m> we "turn off" the <m>e^t</m> function and "turn on" the <m>t^3</m> function.
				</p>
			</solution>
		</example>
		

		<example xml:id="ex_write_h_as_">
			<p>
				Write the function
				<me>
					h(t) = \left\{
					\begin{array}{ll}
						4,	\amp t \lt 3,\\
						t - 2,	\amp 3 \le t \lt 5,\\
						7,	\amp t \ge 5
					\end{array} \right.
				</me>.
				terms of unit step functions.
			</p>

			<p/>
			<solution>
				<p>
					We notice that the function changes behavior at <m>t = 3</m> and <m>t = 5.</m> That means that the form of the function is
					<me>
						h(t) = <fillin>{50}</fillin> + <fillin>{50}</fillin>\cdot U(t-3) + <fillin>{50}</fillin>\cdot U(t - 5)
					</me>.
				</p>

				<p>
					Based on the previous example, we see that the left-most piece of the piecewise defined function fills in the first blank, as below.
					<me>
						h(t) = 4 + <fillin>{50}</fillin>\cdot U(t-3) + <fillin>{50}</fillin>\cdot U(t - 5)
					</me>
				</p>

				<p>
					In the next blank, we need to "turn off" the previous function and turn on new function, as we see here.
					<md>
						<mrow>h(t)	\amp = 4 + \Big(-4 + (t - 2)\Big)\cdot U(t-3) + <fillin>{50}</fillin>\cdot U(t - 5)</mrow>
						<mrow>\amp = 4 + (t - 6)\cdot U(t-3) + <fillin>{50}</fillin>\cdot U(t - 5)</mrow>
					</md>
				</p>

				<p>
					Similarly, we use the remaining blank to "turn off" the <m>t - 2</m> function and "turn on" the <m>7</m> function.	
					<md>
						<mrow>h(t)	\amp = 4 + (t - 6)\cdot U(t-3) + \Big( -(t - 2) + 7 \Big)\cdot U(t - 5)</mrow>
						<mrow>\amp = 4 + (t - 6)\cdot U(t-3) + (-t + 9)\cdot U(t - 5)</mrow>
					</md>
				</p>
			</solution>
		</example>

		<xi:include href="./c7-exercises/c7-chkpts-4-1-3-piecewise-to-unit-step.ptx" />

	</subsection>

	<subsection><title> Laplace Transform of Unit-Step Functions </title>
		

		<aside><p>Swap sections 4.8 and 4.9</p></aside>

		<p>
			We are now able to rewrite piecewise defined functions in terms of unit step functions. We now need to take Laplace transforms of piecewise defined functions, and then we will be ready to solve DEs involving piecewise defined functions.
		</p>

		<example xml:id="ex_g_as_u">
			<p>
				Consider the function
				<me>
					g(t) = \left\{
					\begin{array}{ll}
						0,	\amp t \lt 2, \\
						6,	\amp 2 \le t \lt 5,\\
						-4,	\amp t \ge 5
					\end{array} \right.
				</me>.

				<ol>
					<li>
						Write <m>g(t)</m> in terms of unit step functions.
						<me>
							g(t) = 6\ U(t-2) - 10\ U(t-5)
						</me>.
					</li>
					<li>
						Find the Laplace transform of <m>g(t)</m> using the definition of the Laplace transform.
					</li>
					<li>
						Based on your answers to parts (a) and (b), hypothesize about a rule for taking the Laplace transform of a unit step function.
					</li>
				</ol>
			<p/>

			</p>
			<solution>
				<p>
					<ol>
						<li>
							The function changes behavior at <m>t = 2</m> and <m>t = 5.</m>  We can then assemble	the function as follows, thinking about turning the pieces 'on' and 'off' as described in the previous section.
							<md>
								<mrow>g(t)	\amp = 0 + (-0 + 6)\cdot U(t-2) + (-6 + -4) \cdot U(t-5)</mrow>
								<mrow>\amp = 6\ U(t-2) - 10\ U(t-5)</mrow>
							</md>
						</li>
						<li>
							We will use the definition of the Laplace transform and properties of integration, as follows.
							<md>
								<mrow>G(s)	\amp = \lap{ g(t) }</mrow>
								<mrow>\amp = \int_0^{\infty} e^{-st}g(t)dt</mrow>
								<mrow>\amp = \int_0^2 e^{-st}g(t)dt + \int_2^5 e^{-st}g(t)dt + \int_5^{\infty} e^{-st}g(t)dt</mrow>
								<mrow>\amp = \int_0^2 e^{-st}\cdot 0dt + \int_2^5 e^{-st}\cdot 6dt </mrow>
											+ \int_5^{\infty} e^{-st}\cdot (-4)dt
								<mrow>\amp = \int_0^2 e^{-st}\cdot 0dt + \int_2^5 e^{-st}\cdot 6dt </mrow>
											+ \int_5^{\infty} e^{-st}\cdot (-4)dt
								<mrow>\amp = 0 + 6\int_2^5 e^{-st}dt </mrow>
											- 4\lim_{b\to\infty}\int_5^b e^{-st}dt
								<mrow>\amp = -\frac{6}{s}e^{-st}\Big|_2^5 </mrow>
											- 4\lim_{b\to\infty}\int_5^b e^{-st}dt,
											s gt 0
								<mrow>\amp = -\frac{6}{s}\left[e^{-s\cdot 5} - e^{-s\cdot 2}\right]</mrow>
										+ 4\lim_{b\to\infty}\frac{1}{s}e^{-st}\Big|_5^b,
										s gt 0	
								<mrow>\amp = -\frac{6e^{-5s}}{s} + \frac{6e^{-2s}}{s}</mrow>
										+ 4\lim_{b\to\infty}\frac{1}{s}\left[ e^{-s\cdot b} - e^{-s\cdot 5} \right],
										s gt 0	
								<mrow>\amp = -\frac{6e^{-5s}}{s} + \frac{6e^{-2s}}{s}</mrow>
										+ \frac{4}{s}\left[ \lim_{b\to\infty}e^{-sb}
													- \lim_{b\to\infty}e^{-5s} \right],
										s gt 0	
								<mrow>\amp = -\frac{6e^{-5s}}{s} + \frac{6e^{-2s}}{s}</mrow>
										+ \frac{4}{s}\left[ 0 - e^{-5s} \right],
										s gt 0	
								<mrow>\amp = -\frac{6e^{-5s}}{s} + \frac{6e^{-2s}}{s} - \frac{4e^{-5s}}{s},</mrow>
										s gt 0	
								<mrow>\amp = \frac{6e^{-2s}}{s} - \frac{10e^{-5s}}{s},  s \gt 0	</mrow>
							</md>
						</li>
						<li>
							If we put together the results from the last two questions, we have
							<me>
								\lap{ 6\ U(t-2) - 10\ U(t-5) } = \frac{6e^{-2s}}{s} - \frac{10e^{-5s}}{s}
							</me>.
							Based on this, we can surmise the following property for Laplace transforms:
							<me>
								\lap{ U(t-a) } = \frac{e^{-as}}{s}
							</me>.
						</li>
					</ol>
				</p>
			</solution>
		</example>

		<p>
			We will add this property and a couple more to our table of Laplace transforms. These properties (<xref ref="LT-Table-L14-L16" text="custom"><m>L14</m> through <m>L16</m></xref>) will be added to the bottom of the table we used previously.
		</p>

		<p>
			<em> Table of Laplace Transforms</em>
			<me>
				\begin{array}{|c|c|c|}
				\hline
									\amp f(t) 								\amp \lap{ f(t) } 	\amp 	\text{Condition/Notes}\\
				\hline
				\hline
				\text{L1}	\amp 1									\amp \ds \frac{1}{s}	\amp 	s>0\\
				\hline
				\text{L2}	\amp e^{at}								\amp \ds \frac{1}{s-a}	\amp 	s>a\\
				\hline
				\text{L3}	\amp t^n, \hspace{0.25cm}n = 1, 2, \ldots		\amp \ds \frac{n!}{s^{n+1}}	\amp 	s>0\\
				\hline
				\text{L4}	\amp \sin (bt)							\amp \ds \frac{b}{s^2 + b^2}	\amp 	s>0\\
				\hline
				\text{L5}	\amp \cos(bt)							\amp \ds \frac{s}{s^2 + b^2}	\amp 	s>0\\
				\hline
				\text{L6}	\amp t^n e^{at},  \hspace{0.25cm}n = 1, 2, \ldots	\amp \ds \frac{n!}{(s-a)^{n+1}}	\amp 	s>a\\
				\hline
				\text{L7}	\amp e^{at} \sin(bt)						\amp \ds \frac{b}{(s-a)^2 + b^2}	\amp 	s>a\\
				\hline
				\text{L8}	\amp e^{at} \cos(bt)						\amp \ds \frac{s-a}{(s-a)^2 + b^2}	\amp 	s>a\\
				\hline
				\text{L9}	\amp \alpha f(t) + \beta g(t)					\amp \ds \alpha \lap{ f(t) } + \beta \lap{ g(t) }	\amp 	 \alpha, \beta \text{ constant}\\
				\hline
				\text{L10}	\amp f'(t)								\amp s\lap{ f(t) } - f(0)	\amp 	\\
				\hline
				\text{L11}	\amp f''(t)								\amp s\lap{ f'(t) } - f'(0)	\amp 	\\
				\hline
				\text{L12}	\amp f^{(n)}(t)							\amp s\lap{ f^{(n-1)}(t) } - f^{(n-1)}(0)	\amp 	\\
				\hline
				\text{L13}	\amp t^n f(t)							\amp \ds (-1)^n\frac{d^n}{ds^n}\big( \lap{ f(t) } \big)	\amp 	\\
				\hline
				\text{L14.}	\amp U(t-a)								\amp \ds  \frac{e^{-as}}{s}\amp 	\\
				\hline
				\text{L15.}	\amp \ds f(t) U(t-a)						\amp \ds e^{-as} \lap{ f(t+a) }\amp 	\\
				\hline
				\text{L16.}	\amp \ds f(t-a)U(t-a)						\amp \ds e^{-as}F(s)\amp 	\\
				\hline
				\hline
				\end{array}
			</me>
		</p>

		<p>
			Let's practice using the new properties that have been added to the table for	Laplace transforms involving unit step functions.
		</p>

		<example xml:id="ex_lt_of_pw_func">
			<p>
				Find the Laplace transform of the function
				<me>
					q(t) = 3\ U(t-7) + t^2 U(t-4)
				</me>
			<p/>
			
			</p>
			<solution>
				<p>
					We will need to use linearity and then properties <xref ref="LT-Table-L14" text="custom"><m>L14</m></xref> and <xref ref="LT-Table-L15" text="custom"><m>L15</m></xref>.  We begin as	follows.
					<md>
						<mrow>Q(s)	\amp = \lap{ q(t) }</mrow>
						<mrow>\amp = \lap{  3\ U(t-7) + t^2 U(t-4) }</mrow>
						<mrow>\amp = 3\lap{ U(t-7) } + \lap{ t^2 U(t-4) }</mrow>
						<mrow>\amp = 3\cdot \frac{e^{-7s}}{s} + \lap{ t^2 U(t-4) }</mrow>
					</md>

				</p>

				<p>
					(Point out common mistake here??  In the margin??)
				</p>

				<p>
					For the second term, we need to use  <xref ref="LT-Table-L15" text="custom"><m>L15</m></xref>, with <m>f(t) = t^2</m> and <m>a = 4</m>. Then we have
					<md>
						<mrow>Q(s)	\amp = 3\cdot \frac{e^{-7s}}{s} + \lap{ t^2 U(t-4) },</mrow>
						<mrow>\amp = 3\cdot \frac{e^{-7s}}{s} + e^{-4s} \lap{ f(t+4) }.</mrow>
					</md>
				</p>

				<p>
					We aren't done yet, because we still need to evaluate <m>\lap{ f(t+4) }.</m>  First, since <m>f(t) = t^2,</m> then we know that
					<md>
						<mrow>f(t+4)	\amp = (t+4)^2,</mrow>
						<mrow>\amp = t^2 + 8t + 16.</mrow>
					</md>
				</p>

				<p>
					We need to take the Laplace transform of this function; we will use linearity and properties <xref ref="LT-Table-L1" text="custom"><m>L1</m></xref> and <xref ref="LT-Table-L3" text="custom"><m>L3</m></xref>.  We continue below.
					<md>
						<mrow>Q(s)	\amp = 3\cdot \frac{e^{-7s}}{s} + e^{-4s} \lap{ f(t+4) }</mrow>
						<mrow>\amp = 3\cdot \frac{e^{-7s}}{s} + e^{-4s} \lap{ t^2 + 8t + 16 } </mrow>
						<mrow>\amp = 3\cdot \frac{e^{-7s}}{s} + e^{-4s} \Big[ \lap{ t^2 } + 8\lap{ t } + 16\lap{ 1 } \Big]</mrow>
						<mrow>\amp = 3\cdot \frac{e^{-7s}}{s} + e^{-4s} \left[ \frac{2}{s^3} + \frac{8}{s^2} + \frac{16}{s} \right]</mrow>
					</md>
				</p>
			</solution>
		</example>

		<example xml:id="ex_lt_of_exp_times_u">
			<p>
				Evaluate <m>\lap{ e^{5t} U(t-6)}.</m>
			<p/>
			
			</p>
			<solution>
				<p>
					Here we will use  <xref ref="LT-Table-L15" text="custom"><m>L15</m></xref>, with <m>f(t) = e^{5t}</m> and <m>a = 6.</m>
					<md>
						<mrow>\lap{ e^{5t} U(t-6) }	\amp = e^{-6s}\lap{ f(t+6) }</mrow>
						<mrow>\amp = e^{-6s}\lap{ e^{5(t+6)} }</mrow>
						<mrow>\amp = e^{-6s}\lap{ e^{5t+30} }</mrow>
						<mrow>\amp = e^{-6s}\lap{ e^{5t}\cdot e^{30} }</mrow>
						<mrow>\amp = e^{-6s}e^{30}\lap{ e^{5t} }</mrow>
						<mrow>\amp = e^{-6s}e^{30}\cdot \frac{1}{s-5}</mrow>
						<mrow>\amp = \frac{e^{-6s + 30}}{s-5}</mrow>
					</md>
				</p>
			</solution>
		</example>

		<p>
			So far we have been taking Laplace transforms of functions involving unit step functions, and we have used properties <xref ref="LT-Table-L14" text="custom"><m>L14</m></xref> and <xref ref="LT-Table-L15" text="custom"><m>L15</m></xref>.  We will use  <xref ref="LT-Table-L16" text="custom"><m>L16</m></xref> for inverse Laplace transforms involving unit step functions.
		</p>

		<example xml:id="ex_ilt_of_exp_over_s_power">
			<p>
				Find the inverse Laplace transform of
				<me>
					X(s) = \frac{e^{-2s}}{s^3}
				</me>.
			<p/>
			
			</p>
			<solution>
				<p>
					We have a function of <m>s</m> that contains an exponential, and we want to find the inverse Laplace transform.  The presence of the exponential is a cue that we will be dealing with unit step functions.  In particular, we will use <xref ref="LT-Table-L16" text="custom"><m>L16</m></xref>. First it may be easier for us to rewrite <m>X(s)</m> as
					<md>
						<mrow>X(s)	\amp = e^{-2s}\cdot \frac{1}{s^3}</mrow>
						<mrow>\amp = e^{-2s}\cdot F(s)</mrow>
					</md>
				</p>

				<p>
					where <m>\ds F(s) = \frac{1}{s^3}.</m>  Now we can apply  <xref ref="LT-Table-L16" text="custom"><m>L16</m></xref> with  <m>a = 2</m>.
					<md>
						<mrow>x(t)	\amp = \lap^{-1}\left\{ X(s) \right\}</mrow>
						<mrow>\amp = \lap^{-1}\left\{ \frac{e^{-2s}}{s^3} \right\}</mrow>
						<mrow>\amp = \lap^{-1}\left\{ e^{-2s}\cdot \frac{1}{s^3} \right\}</mrow>
						<mrow>\amp = f(t-2)\cdot U(t-2)</mrow>
					</md>
				</p>

				<p>
					We know exactly what the function <m>U(t-2)</m> is; but we don't yet know what <m>f(t-2)</m> is.  We do know the function <m>F(s),</m> and therefore we need to take the inverse Laplace transform of <m>F(s)</m> to find the function <m>f(t).</m>
					<md>
						<mrow>f(t)	\amp = \lap^{-1}\left\{ F(s) \right\}</mrow>
						<mrow>\amp = \lap^{-1}\left\{ \frac{1}{s^3} \right\}</mrow>
						<mrow>\amp = \frac{1}{2} \lap^{-1}\left\{ \frac{2}{s^3} \right\}</mrow>
						<mrow>\amp = \frac{1}{2}t^2</mrow>
					</md>
				</p>

				<p>
					Now that we know the function <m>f(t),</m> we are prepared to finish assembling our answer.
					<md>
						<mrow>x(t)	\amp = f(t-2)\cdot U(t-2)</mrow>
						<mrow>\amp = \frac{1}{2}(t-2)^2 \cdot U(t-2)</mrow>
					</md>
				</p>
			</solution>
		</example>

		<example xml:id="ex_ilt_of_exp_over_sum_of_sqrs">
			<p>
				Find the inverse Laplace transform of
				<me>
					A(s) = \frac{e^{-3s}}{s^2 + 16}
				</me>.
			<p/>
			
			</p>
			<solution>
				<p>
					The cue that we need to use <xref ref="LT-Table-L16" text="custom"><m>L16</m></xref> when taking an inverse Laplace transform is the presence of an exponential.  We can rewrite <m>A(s)</m> as
					<md>
						<mrow>A(s)	\amp = e^{-3s}\cdot \frac{1}{s^2 + 16},</mrow>
						<mrow>\amp = e^{-3s}\cdot F(s),</mrow>
					</md>
				</p>

				<p>
					where <m>\ds F(s) = \frac{1}{s^2 + 16}.</m>  This form aligns with  <xref ref="LT-Table-L16" text="custom"><m>L16</m></xref>, using <m>a = 3</m>, and we can proceed to take the inverse Laplace transform as follows.
					<md>
						<mrow>a(t)	\amp = \lap^{-1}\left\{ A(s) \right\}</mrow>
						<mrow>\amp = \lap^{-1}\left\{ \frac{e^{-3s}}{s^2 + 16} \right\}</mrow>
						<mrow>\amp = \lap^{-1}\left\{ e^{-3s}\cdot \frac{1}{s^2 + 16} \right\}</mrow>
						<mrow>\amp = f(t - 3)\cdot U(t-3)</mrow>
					</md>
				</p>

				<p>
					We are not done yet; the function <m>U(t-3)</m> is well-defined, but we don't yet know what <m>f(t-3)</m> is.  Recall that <m>\ds F(s) = \frac{1}{s^2 + 16}.</m>  First we can find <m>f(t)</m> by taking the inverse Laplace transform of <m>F(s).</m>
					<md>
						<mrow>f(t)	\amp = \lap^{-1}\{ F(s) \}</mrow>
						<mrow>\amp = \lap^{-1}\{ \frac{1}{s^2 + 16} \}</mrow>
						<mrow>\amp = \lap^{-1}\{ \frac{1}{s^2 + 4^2} \}</mrow>
						<mrow>\amp = \frac{1}{4}\cdot \lap^{-1}\{ \frac{4}{s^2 + 4^2} \}</mrow>
						<mrow>\amp = \frac{1}{4}\sin(4t)</mrow>
					</md>
				</p>

				<p>
					Now that we know <m>f(t),</m> we are prepared to evaluate <m>f(t-3).</m>
					<md>
						<mrow>a(t)	\amp = f(t - 3)\cdot U(t-3)</mrow>
						<mrow>\amp = \frac{1}{4}\sin\big(4(t-3)\big) \cdot U(t-3)</mrow>
					</md>
				</p>
			</solution>
		</example>

		<example xml:id="ex_ilt_of_s_exp_over_quadratic">
			<p>
				Find the inverse LT of
				<me>
					Y(s) = \frac{se^{-7s}}{s^2 + 4s + 5}
				</me>
			<p/>
			
			</p>
			<solution>
				<p>
					It may be easiest for us to rewrite <m>Y(s)</m> before we begin, as
					<md>
						<mrow>Y(s)	\amp =  e^{-7s}\cdot \frac{s}{s^2 + 4s + 5},</mrow>
						<mrow>\amp = e^{-7s}F(s),</mrow>
					</md>
				</p>

				<p>
					where <m>F(s) = \ds  \frac{s}{s^2 + 4s + 5}.</m>  Since we have done several examples like this one, we know that we will need to find the inverse Laplace transform of <m>F(s),</m> so let's find that now.  This will require some algebraic manipulation as we saw in (name the section here).
					<md>
						<mrow>f(t)	\amp = \lap^{-1}\left\{ F(s) \right\}</mrow>
						<mrow>\amp = \lap^{-1}\left\{ \frac{s}{s^2 + 4s + 5} \right\}</mrow>
						<mrow>\amp = \lap^{-1}\left\{ \frac{s}{(s^2 + 4s + 4) + 5 - 4} \right\}</mrow>
						<mrow>\amp = \lap^{-1}\left\{ \frac{s}{(s+2)^2 + 1} \right\}</mrow>
						<mrow>\amp = \lap^{-1}\left\{ \frac{(s+2) - 2}{(s+2)^2 + 1^2} \right\}</mrow>
						<mrow>\amp = \lap^{-1}\left\{ \frac{s+2}{(s+2)^2 + 1^2} - 2\cdot \frac{1}{(s+2)^2 + 1^2}  \right\}</mrow>
						<mrow>\amp = \lap^{-1}\left\{ \frac{s+2}{(s+2)^2 + 1^2} \right\} - 2\cdot \lap^{-1}\left\{\frac{1}{(s+2)^2 + 1^2}  \right\}</mrow>
						<mrow>\amp = e^{-2t}\cos(t) - 2e^{-2t}\sin(t)</mrow>
					</md>
				</p>

				<p>
					Now we return to the question at hand: finding the inverse Laplace transform of <m>Y(s).</m>
					<md>
						<mrow>y(t)	\amp = \lap^{-1}\left\{ Y(s) \right\}</mrow>
						<mrow>\amp = \lap^{-1}\left\{ e^{-7s}F(s) \right\}</mrow>
						<mrow>\amp = f(t-7)\cdot U(t-7)</mrow>
						<mrow>\amp = \Big[e^{-2(t-7)}\cos(t-7) - 2e^{-2(t-7)}\sin(t-7)\Big]\cdot U(t-7)</mrow>
					</md>
				</p>
			</solution>
		</example>

		<xi:include href="./c7-exercises/c7-chkpts-4-1-2-transforming-unit-step-functions.ptx" />

	</subsection>

	<subsection><title> Solving Equations with Piecewise Forcing Functions </title>

		<p>
			Recall that we already had a solution technique (Undetermined Coefficients) that allowed us to solve linear DEs with constant coefficients, so long as the non-homogeneous part of the DE is continuous (and has a specific form).  We now finally have all of the tools we need to be able to solve DEs where the non-homogenous part is discontinuous.
		</p>

		<example xml:id="ex_solve_ivp_w_pw_func">
			<p>
				Solve the following initial value problem.
				<me>
					i''(t) + 4i(t) = g(t),  i(0) = 0,  i'(0) = 0,
				</me>
				where
				<me>
					g(t) = \left\{
					\begin{array}{ll}
						1,	\amp t \lt 1,\\
						-1,	\amp 1 \le t \lt 2,\\
						0,	\amp t \ge 2
					\end{array} \right.
				</me>.
			</p>

			<p/>
			<solution>
				<p>
					We observe that this DE is linear and has constant coefficients. It is non-homogeneous, but the non-homogenous part of the DE, the function <m>g(t),</m> is a piecewise defined function.  As such, the only solution technique we have available in using Laplace transforms.

				</p>

				<p>
					In order to take the Laplace transform of the DE, we first need to rewrite <m>g(t)</m> in terms of unit step functions. (If you need to review this process, refer back to section NAME/NUMBER.)
					<me>
						g(t) = 1 - 2\ U(t-1) + U(t-2)
					</me>.
					
				</p>

				<p>
					Thus, the DE can be written
					<me>
						i''(t) + 4i(t) = 1 - 2\ U(t-1) + U(t-2)
					</me>.
				</p>

				<p>
					We take the Laplace transform of both sides of the DE, apply properties from our table, and use the provided initial conditions as follows.
					<md>
						<mrow>\lap{ i''(t) + 4i(t) }	\amp = \lap{1 - 2\ U(t-1) + U(t-2)}</mrow>
						<mrow>\lap{ i''(t)} + \lap{4i(t) }	\amp = \lap{1} - 2\lap{U(t-1)} + \lap{U(t-2)}</mrow>
						<mrow>\Big[s^2 I(s) - s\cdot i(0) - i'(0)\Big] + 4I(s)	\amp = \frac{1}{s} - \frac{2e^{-s}}{s} + \frac{e^{-2s}}{s}</mrow>
						<mrow>\Big[s^2 I(s) - s\cdot 0 - \cdot 0\Big] + 4I(s)	\amp = \frac{1}{s}\Big[1 - 2e^{-s} + e^{-2s}\Big]</mrow>
						<mrow>s^2 I(s)+ 4I(s)	\amp = \frac{1}{s}\Big[1 - 2e^{-s} + e^{-2s}\Big]</mrow>
					</md>

				</p>

				<p>
					Next we solve for <m>I(s).</m>
					<md>
						<mrow>[s^2+ 4]I(s)	\amp = \frac{1}{s}\Big[1 - 2e^{-s} + e^{-2s}\Big]</mrow>
						<mrow>I(s)	\amp = \frac{1}{s(s^2 + 4)}\Big[1 - 2e^{-s} + e^{-2s}\Big]</mrow>
						<mrow>\amp = F(s)\cdot \Big[1 - 2e^{-s} + e^{-2s}\Big]</mrow>
						<mrow>\amp = F(s) - 2e^{-s}F(s) + e^{-2s}F(s),</mrow>
					</md>
				</p>

				<p>
					where <m>F(s) = \ds \frac{1}{s(s^2 + 4)}.</m>

				</p>

				<p>
					We see those exponentials which means we will need to use  <xref ref="LT-Table-L16" text="custom"><m>L16</m></xref> to find the inverse Laplace transform.  In order to do that, we also know that we will need the inverse Laplace transform of <m>F(s),</m> so we work on that, first.  We note that a partial fraction decomposition is needed.
					<md>
						<mrow>\frac{1}{s(s^2 + 4)}	\amp = \frac{A}{s} + \frac{Bs+C}{s^2 + 4}</mrow>
						<mrow>s(s^2 + 4) \cdot \frac{1}{s(s^2 + 4)}	\amp = \left[\frac{A}{s} + \frac{Bs+C}{s^2 + 4}\right]\cdot s(s^2 + 4)</mrow>
						<mrow>1	\amp = A(s^2 + 4) + (Bs+C)s</mrow>
						<mrow>1	\amp = As^2 + 4A + Bs^2 + Cs</mrow>
						<mrow>0s^2 + 0s + 1	\amp = (A+B)s^2 + Cs + 4A</mrow>
					</md>
					
					<md>
						<mrow>A+B	\amp = 0			\amp	C	\amp = 0	\amp	4A	\amp = 1</mrow>
						<mrow>\amp			\amp		\amp	\amp	A	\amp = \frac{1}{4}</mrow>
						<mrow>\frac{1}{4} + B	\amp = 0			\amp		\amp	\amp		\amp</mrow>
						<mrow>B	\amp = -\frac{1}{4}	\amp		\amp	\amp		\amp</mrow>
					</md>
				</p>

				<p>
					Therefore we have
					<me>
						F(s) = \frac{\frac{1}{4}}{s} - \frac{\frac{1}{4}s}{s^2 + 4}
					</me>.
					
				</p>

				<p>
					We now take the inverse Laplace transform.
					<md>
						<mrow>f(t)	\amp = \lap^{-1}\left\{ F(s) \right\}</mrow>
						<mrow>\amp = \lap^{-1}\left\{ \frac{\frac{1}{4}}{s} - \frac{\frac{1}{4}s}{s^2 + 4} \right\}</mrow>
						<mrow>\amp = \frac{1}{4}\lap^{-1}\left\{ \frac{1}{s}\right\} - \frac{1}{4}\lap^{-1}\left\{\frac{s}{s^2 + 2^2} \right\}</mrow>
						<mrow>\amp = \frac{1}{4}\cdot 1 - \frac{1}{4}\cos(2t)</mrow>
						<mrow>\amp = \frac{1}{4} - \frac{1}{4}\cos(2t)</mrow>
					</md>
					
				</p>

				<p>
					Now we are prepared to return to the actual question at hand.  We return to our equation for <m>I(s):</m>
					<me>
						I(s)	= F(s) - 2e^{-s}F(s) + e^{-2s}F(s)
					</me>.
				</p>

				<p>
					We take the inverse Laplace transform, using  <xref ref="LT-Table-L16" text="custom"><m>L16</m></xref>.
					<md>
						<mrow>i(t)	\amp = \lap^{-1}\left\{ F(s) - 2e^{-s}F(s) + e^{-2s}F(s) \right\}</mrow>
						<mrow>\amp = \lap^{-1}\left\{ F(s) \right\} - 2\lap^{-1}\left\{ e^{-s}F(s) \right\} + \lap^{-1}\left\{ e^{-2s}F(s) \right\}</mrow>
						<mrow>\amp = f(t) - 2f(t-1)U(t-1) + f(t-2)U(t-2)</mrow>
						<mrow>\amp = \left[ \frac{1}{4} - \frac{1}{4}\cos(2t) \right]</mrow>
							- 2\left[ \frac{1}{4} - \frac{1}{4}\cos\Big(2(t-1)\Big) \right]U(t-1)
							+ \left[ \frac{1}{4} - \frac{1}{4}\cos\Big(2(t-2)\Big) \right]U(t-2)
					</md>

				</p>

				<p>
				(Maybe include here a graph of the solution...explain how the initial conditions are seen in the solution...and how the solution changes at <m>t = 1</m> and at <m>t = 2</m> because the external forcing function changes at those times...)
				</p>
			</solution>
		</example>

		<xi:include href="./c7-exercises/c7-chkpts-4-1-4-solving-des-w-unit-step-functions.ptx" />

	</subsection>

</section>