<section xmlns:xi="http://www.w3.org/2001/XInclude"><title> The Product Rule </title>

	<introduction>
	
		<p>
			The integrating factor method is a systematic process that converts a first-order linear differential equation into a direct integration problem. In terms of equation, it looks like
			<men xml:id="if-completed-derivative-eqn">
				\ub{\frac{dy}{dx} + P(x) y = Q(x)}_{\text{Given Equation}} \quad 
				\os{\text{Integrating}}{\us{\text{Factor Method}}{\longrightarrow}} \quad 
				\ub{\frac{d}{dx}[ \mu(x) y ] = \mu(x) Q(x)}_{\text{Completed Derivative Equation}}
			</men>.
		</p>

		<p>
			The method gets its name from the function <m>\mu(x)</m> that must be included to get the <q>completed derivative equation</q> in <xref ref="if-completed-derivative-eqn"/>.
		</p>

		<p>
			The goal of this section is to develop an intuition for the integrating factor method by first exploring the idea of <q>completing the derivative</q>. We will start by drawing a parallel to completing the square, then move on to reversing the product rule, and finally examine how to introduce the missing component—<em>the integrating factor</em>—that makes the method work.
		</p>

		<outcomes>
			<ul>
				<li>
					<p>
						Explain the analogy between solving a quadratic equation by completing the square and solving a differential equation using the integrating factor method.
					</p>
				</li>
				<li>
					<p>
						Recognize how the product rule from calculus plays a central role in <q>completing the derivative</q> of a first-order linear differential equation.
					</p>
				</li>
				<li>
					<p>
						Practice reversing the product rule to rewrite expressions as a single derivative.
					</p>
				</li>
				<li>
					<p>
						Apply the concept of <q>completing the derivative</q> to transform a first-order linear differential equation into a form that can be solved by direct integration.
					</p>
				</li>
			</ul>
		</outcomes>

		<p>
			Let's begin by exploring the completing the square analogy and how it relates to the integrating factor method.
		</p>

	</introduction>

	<subsection><title> <q>Completing the Square</q> Analogy </title>

		<p>
			Solving a differential equation using the integrating factor method is similar to solving a quadratic equation by <q>completing the square</q>. In both cases, you are including some missing component to get the equation into a form that makes it easier to solve. For example, consider the equation
			<men xml:id="if-analogy-quadratic-eqn">
				x^2 + 6x = -1
			</men>.
		</p>

		<p>
			One approach to solving this equation is to move <m>-1</m> to the left side and apply the quadratic formula. However, another way is to <q>complete the square</q> by strategically adding the one number to both sides in order to make the left-hand side a perfect square. In this case, adding <m>9</m> gives:
		</p>

		<me>
			x^2 + 6x + 9 = -1 + 9
		</me>.

		<p>
			This allows us to rewrite the left-hand side as
		</p>

		<men xml:id="if-analogy-perfect-sqr-eqn">
			(x + 3)^2 = 8
		</men>,

		<p>
			which is much easier to solve (take the square root of both sides).
		</p>

		<p>
			The key idea here is that we artifically added the specific number needed to create the prefect square. This is useful since the square can be eliminated by a square root, allowing us to isolate <m>x</m>.
		</p>

		<p>
			The integrating factor method follows a similar approach but applied to differential equations. Instead of <q>completing the square</q>, we aim to <q>complete the derivative</q> and use an integral to eliminate the derivative, allowing us to isolate for <m>y</m>. For example, the first-order linear differential equation,
		</p>

		<men xml:id="if-analogy-first-order-linear-eqn">
			\frac{dy}{dx} + 6y = -1
		</men>,

		<p>
			resembles a product rule derivative but is missing a key component. Our goal is to find and introduce this missing piece so that the left-hand side becomes a perfect derivative:
		</p>

		<men xml:id="if-analogy-di-eqn">
			\frac{d}{dx}[e^{6x} y] = -e^{6x}
		</men>.

		<p>
			This new form is immediately solvable through direct integration. The function we introduced, <m>e^{6x}</m>, is called the <term>integrating factor</term>, and its role is analogous to the <m>9</m> that we added to complete the square in the quadratic example.
		</p>

		<assemblage><title>Integrating Factor Analogy</title>
			<p>
				The table below summarizes the analogy between completing the square and completing the derivative:
			</p>

			<tabular halign="center">
				<col right="minor"/>
				<col right="minor"/>
				<row bottom="minor">
					<cell/>
					<cell>Completing the Square</cell>
					<cell>Completing the Derivative</cell>
				</row>
				<row>
					<cell>Equation</cell>
					<cell><m>x^2 + 6x = -1</m></cell>
					<cell><m>\ds\frac{dy}{dx} + 6y = -1</m></cell>
				</row>
				<row>
					<cell>
						<line>Missing</line>
						<line>Part</line>
					</cell>
					<cell><m>9\ </m> (add)</cell>
					<cell><m>e^{6x}\ </m> (multiply)</cell>
				</row>
				<row>
					<cell>Result</cell>
					<cell><m>x^2 + 6x + \boxed{9} = -1 + \boxed{9}</m></cell>
					<cell><m>\ds\boxed{e^{6x}}\frac{dy}{dx} + 6\boxed{e^{6x}}y = -1 \boxed{e^{6x}}</m></cell>
				</row>
				<row>
					<cell>Goal</cell>
					<cell><m>(x + 3)^2 = 8</m></cell>
					<cell><m>\ds\frac{d}{dx}[e^{6x} y] = -e^{6x}</m></cell>
				</row>
				<row>
					<cell>
						<line>Solution</line>
						<line>Method</line>
					</cell>
					<cell>
						<line>Solve for <m>x</m> by</line>
						<line>Taking the Square Root</line>
					</cell>
					<cell>
						<line>Solve for <m>y</m> by</line>
						<line>Direct Integration</line>
					</cell>
				</row>
			</tabular>
		</assemblage>

		<p>
			Just as completing the square helps solve quadratic equations by rewriting them in a more convenient form, completing the derivative helps solve first-order linear differential equations by making the left-hand side a perfect derivative. The next step is reviewing the product rule and exploring how to use it in the reverse direction.
		</p>

	</subsection>

	<subsection><title> Reversed Product Rule </title>

		<p>
			At the heart of the integrating factor method lies the product rule, which states that if <m>f(x)</m> and <m>g(x)</m> are two differentiable functions, then
		</p>

		<men xml:id="if-product-rule">
			\left[ f(x) g(x) \right]^{\prime} = f(x) g'(x) + f'(x) g(x).
		</men>

		<p>
			Most calculus problems apply the product rule in the <em>forward direction</em>: given <m>f(x)</m> and <m>g(x)</m>, compute their derivative. However, the integrating factor method requires us to work <em>in reverse</em>: given an expression that resembles the result of a product rule, attempt to undo it. For example, if
		</p>

		<men xml:id="if-reverse-product-rule-before">
			\sin x \cdot \frac{1}{x} + \cos x \cdot \ln x
		</men>,

		<p>
			then we want the product rule it came from. In this case, we want to rewrite it as
		</p>

		<men xml:id="if-reverse-product-rule-after">
			\big[ \sin x \cdot \ln x \big]'
		</men>.

		<p>
			To build confidence in reversing the product rule, let's practice a few examples.
		</p>

		<example><title> Forward Product Rule </title>

			<p>
				<statement>
					<p>
						Compute each of the derivatives below.
					</p>
					<me>
						1. \quad \left[x^6 e^{3x}\right]' \hspace{5em} 2. \quad \frac{d}{dx}\left[e^{x^3} y(x)\right]
					</me>
				</statement>
			</p>

			<solution>
				<p>
					Using the product rule:
					<ol>
						<li>
							<p>
								<m>\ds
									\left( x^6 e^{3x} \right)' =
									x^6 \cdot 3e^{3x} + 6x^5 e^{3x}
								</m>
							</p>
						</li>
						<li>
							<p>
								<m>\ds\frac{d}{dx}
									\left( e^{x^3} y(x) \right) =
									e^{x^3} y'(x) + 3x^2 e^{x^3} y(x)
								</m>
							</p>
						</li>
					</ol>
				</p>
			</solution>

		</example>

		<p>
			Now, let's reverse this process.
		</p>

		<example><title> Reversed Product Rule </title>

			<p>
				<statement>
					<p>
						Rewrite each expression in the form <m>[f(x) g(x)]'</m>.
						<me>
							1. \quad e^{x}\cos x + e^{x}\sin x \hspace{5em} 2. \quad \frac{e^{x^2}}{x} + 2 x \ln(x) e^{x^2}
						</me>
					</p>
				</statement>
			</p>

			<solution>
				<p>
					<solution>

						<p>
							One approach is to use trail-and-error to label <m>f</m> and <m>g</m>, then check that the rest of the product rule is valid.
						</p>

						<p>
							First, try labeling <m>f</m> and <m>g</m> as follows
							<md>
								<mrow>	
										e^x
										\underset{\color{BurntOrange}{f}}{ \underset{\color{BurntOrange}{\uparrow}}{\ul{\cos x}}}\
										+
										\underset{\color{BurntOrange}{g}}{ \underset{\color{BurntOrange}{\uparrow}}{\ul{e^x}}}
										\sin x
										\amp = \big[
										\underset{\color{BurntOrange}{f}}{ \underset{\color{BurntOrange}{\uparrow}}{\ul{\cos x}}}\
										\underset{\color{BurntOrange}{g}}{ \underset{\color{BurntOrange}{\uparrow}}{\ul{e^x}}}
										\big]'
								</mrow>,
							</md>
							but this doesn't work since <m>[\cos x\ e^x]' = \cos x\ e^x + (-\sin x)\ e^x</m>.
						</p>

						<p>
							Next, try the labels
							<md>
								<mrow>	
										\underset{\color{BurntOrange}{f}}{ \underset{\color{BurntOrange}{\uparrow}}{\ul{e^x}}}
										\cos x +
										e^x
										\underset{\color{BurntOrange}{g}}{ \underset{\color{BurntOrange}{\uparrow}}{\ul{\sin x}}}\
										\amp = \big[
										\underset{\color{BurntOrange}{f}}{ \underset{\color{BurntOrange}{\uparrow}}{\ul{e^x}}}\
										\underset{\color{BurntOrange}{g}}{ \underset{\color{BurntOrange}{\uparrow}}{\ul{\sin x}}}
										\big]'
								</mrow>.
							</md>
							A quick check of <m>[e^x \sin x]' = e^x\cos x + e^x \sin x</m>, confirms this works.
						</p>

					</solution>

					<solution>

						<p>
							The labels are easier to determine if we first rewrite the expression
							<me>
								\frac{1}{x} e^{x^2} + \ln(x) (2 x e^{x^2})
							</me>.
						</p>
						
						<p>
							So, as before, we first set <m>f</m> and <m>g</m>
							<md>
								<mrow>	
									\underset{\color{BurntOrange}{\text{verify } g'}}{ \underset{\color{BurntOrange}{\uparrow}}{\ul{\vphantom{\frac11}\frac{1}{x}}}}
									\underset{\color{BurntOrange}{f}}{ \underset{\color{BurntOrange}{\uparrow}}{\ul{\vphantom{\frac11}e^{x^2}}}} +
									\underset{\color{BurntOrange}{g}}{ \underset{\color{BurntOrange}{\uparrow}}{\ul{\vphantom{\frac11}\ln(x)}}}\
									\underset{\color{BurntOrange}{\text{verify } f'}}{ \underset{\color{BurntOrange}{\uparrow}}{\ul{\vphantom{\frac11}(2 x e^{x^2})}}}
									\amp = \big[
										\underset{\color{BurntOrange}{f}}{ \underset{\color{BurntOrange}{\uparrow}}{\ul{\vphantom{\frac11}e^{x^2}}}} \
										\underset{\color{BurntOrange}{g}}{ \underset{\color{BurntOrange}{\uparrow}}{\ul{\vphantom{\frac11}\ln(x)}}}
									\big]'
								</mrow>
							</md>
							then verify the derivatives of <m>f</m> and <m>g</m>
							<me>
								f: \quad [e^{x^2}]' = 2 x e^{x^2} \qquad g:\quad [\ln(x)]' = \frac{1}{x}
							</me>
							we see that <m>[e^{x^2} \ln(x)]'</m> works.
						</p>
					</solution>
				</p>
			</solution>
			
		</example>

		<p>
			Here is an example that includes a variable in the expression. This is more like what you will see in a the integrating factor method.
		</p>

		<example><title> Reversed Product Rule with a Variable </title>

			<p>
				<statement>
					<p>
						Rewrite each expression in the form <m>[f(x) y(x)]'</m>.
						<me>
							1. \quad e^{x^2}\frac{dy}{dx} + 2 xy e^{x^2} \hspace{5em} 2. \quad e^{1/x}y' - \frac{e^{1/x}}{x^2}y
						</me>
					</p>
				</statement>
			</p>

			<solution>
				<p>
					<solution>
						<p>
							The fact that we see <m>dy/dx</m> in the first term makes the labeling even easier since <m>f</m> must be <m>e^{x^2}</m> and <m>g</m> must be <m>y</m>. Confirming that the derivative of this <m>f</m> is <m>2xe^{x^2}</m> justifies the following reversed product rule
							<md>
								<mrow>	
										\underset{\color{BurntOrange}{f}}{ \underset{\color{BurntOrange}{\uparrow}}{\ul{e^{x^2}}}}\
										\frac{dy}{dx} +
										\underset{\color{BurntOrange}{g}}{ \underset{\color{BurntOrange}{\uparrow}}{\ul{y}}}\
										\underset{\color{BurntOrange}{\text{verified } f^{'}}}{ \underset{\color{BurntOrange}{\uparrow}}{\ul{(2xe^{x^2})}}}
										=\amp\ \frac{d}{dx}\Big[
											\underset{\color{BurntOrange}{f}}{ \underset{\color{BurntOrange}{\uparrow}}{\ul{e^{x^2}}}}\
											\underset{\color{BurntOrange}{g}}{ \underset{\color{BurntOrange}{\uparrow}}{\ul{y}}}
											\Big] \quad \leftarrow \text{answer.}
								</mrow>
							</md>	
						</p>
					</solution>

					<solution>
						<p>
							Again, seeing <m>y'</m> in the first term means <m>f</m> must be <m>e^{1/x}</m> and <m>g</m> must be <m>y</m>. So we try the labeling
							<md>
								<mrow>	
										\underset{\color{BurntOrange}{f}}{ \underset{\color{BurntOrange}{\uparrow}}{\ul{e^{1/x}}}}\
										y' +
										\underset{\color{BurntOrange}{g}}{ \underset{\color{BurntOrange}{\uparrow}}{\ul{y}}}\
										\underset{\color{BurntOrange}{\text{verified } f^{'}}}{ \underset{\color{BurntOrange}{\uparrow}}{\left(\ul{-\frac{e^{1/x}}{x^2}}\right)}}
										=\amp\ \big[
											\underset{\color{BurntOrange}{f}}{ \underset{\color{BurntOrange}{\uparrow}}{\ul{e^{1/x}}}}\
											\underset{\color{BurntOrange}{g}}{ \underset{\color{BurntOrange}{\uparrow}}{\ul{y}}}
											\big]' \quad \leftarrow \text{answer.}
								</mrow>
							</md>
							As a review, here are the details of the derivative of <m>f</m>:
							<me>
								f' = \left[e^{1/x}\right]' = e^{1/x}\left[\frac{1}{x}\right]^\prime = e^{1/x}\left(-\frac{1}{x^2}\right) = -\frac{e^{1/x}}{x^2}
							</me>.
						</p>
					</solution>
				</p>
			</solution>
			
		</example>
		
		<p>
			Let's extend this skill to an actual differential equation.
		</p>

		<example xml:id="reversing-the-product-rule-in-a-DE-example"><title> Reversed Product Rule in a Differential Equation </title>

			<p>
				<statement>
					<p>
						Rewrite the left-side of the differential equation
						<men xml:id="reversing-the-product-rule-in-a-DE-example-eqn">
							e^{2x} \frac{dy}{dx} + 2e^{2x} y = 5e^{2x}
						</men>
						as a reversed product rule. Then find the general solution of the equation by <xref ref="direct-integration" text="custom">direct integration</xref>.
					</p>
				</statement>
			</p>

			<p>
				<solution>

					<ol>
						<li>
							<p>
								To reverse the product rule on the left-side, let's label <m>f</m> and <m>g</m> as before. This time, we get
							</p>

							<p>
								<md>
									<mrow>	
										\underset{\color{BurntOrange}{f}}{ \underset{\color{BurntOrange}{\uparrow}}{\ul{e^{2x}}}}\
										\frac{dy}{dx} +
										\underset{\color{BurntOrange}{g}}{ \underset{\color{BurntOrange}{\uparrow}}{\ul{y}}}\
										\underset{\color{BurntOrange}{\text{verify}}}{ \underset{\color{BurntOrange}{\uparrow}}{\ul{(2e^{2x})}}}
										=\amp\ \frac{d}{dx}\big[
										\underset{\color{BurntOrange}{f}}{ \underset{\color{BurntOrange}{\uparrow}}{\ul{e^{2x}}}}\
										\underset{\color{BurntOrange}{g}}{ \underset{\color{BurntOrange}{\uparrow}}{\ul{y}}}
										\big]
									</mrow>
								</md>
								which allows us to rewrite the the equation as
								<me>
									\frac{d}{dx}\left[e^{2x} y \right] = 5e^{2x}
								</me>.
							</p>
						</li>
						<li>
							<p>
								To get the general solution, we directly integrate both sides of the equation with respect to <m>x</m>, like so
								<md>
									<mrow>	\int \frac{d}{dx}\left[e^{2x} \cdot y \right]\ dx	=\amp \int \frac{5}{2} e^{2x}\ dx	</mrow>
									<mrow>	e^{2x} y											=\amp \frac{5}{2} e^{2x} + c		</mrow>
									<mrow>	y													=\amp \frac{5}{2} + c e^{-2x}		</mrow>
								</md>.
							</p>
						</li>
					</ol>
				</solution>
			</p>

		</example>

		<p>
			This example illustrates the power of recognizing when an equation is already in a form that allows us to reverse the product rule. However, most differential equations do not start in this form. In the next section, we discuss how to modify an equation so that it becomes a perfect derivative.
		</p>

		<xi:include href="./c4-exercises/c4-chkpts-1-1-reversed-product-rule.ptx" />
	
	</subsection>

</section>