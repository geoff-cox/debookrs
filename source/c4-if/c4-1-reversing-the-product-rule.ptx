<subsection xmlns:xi="http://www.w3.org/2001/XInclude"><title> Completing the Product Rule </title>

	<introduction>

		<p>
			Solving a differential equation using the integrating factor method is analogous to solving a quadratic equation by completing the square. In both cases, you are including some missing component to get the equation into a form that makes the equation easier to solve. For example, consider the equation
			<men xml:id="first-order-std-analogy-eqn">
				x^2 + 6x = -1
			</men>.
		</p>

		<p>
			We could solve this equation by moving <m>-1</m> to the left and applying the quadratic formula. However, another approach is to <xref ref="completing-the-square" text="custom">complete the square</xref>. If you recall, the trick is to add <m>9</m> to both sides of the equation giving you
			<aside>
				<p>
					To complete the square of <me>x^2 + bx + c = 0</me>, you add and subtract <m>(\frac12b)^2</m> to get <me>x^2 + bx + (\frac12b)^2 = -c + (\frac12b)^2</me>. This simplifies to <me>(x + \frac12b)^2 = -c + (\frac12b)^2</me>.
				</p>
			</aside>
			<me>
				x^2 + 6x + 9 = -1 + 9
			</me>.
			By artificially adding 9 to both sides, we can rewrite the equation as
			<men xml:id="di-analogy-eqn">
				(x + 3)^2 = 8
			</men>
			and solve it by taking the square root of both sides. In this analogy, <xref ref="first-order-std-analogy-eqn"/> corresponds to the differential equation <xref ref="first-order-std-eqn"/> and <xref ref="di-analogy-eqn"/> to the direct integration equation <xref ref="di-eqn"/>.
		</p>

		<p>
			In contrast, consider the differential equation
			<me>
				\frac{dy}{dx} + 6y = -1
			</me>.
		</p>

		<p>
			In this case, we are going to artifically multiply both sides of the equation by the function <m>e^{6x}</m> to get
			<me>
				e^{6x} \frac{dy}{dx} + 6e^{6x} y = -e^{6x}
			</me>.
			By doing this, we essentially <q>completed a product rule</q> since the left-side now looks like the result of a product rule! Reversing this product rule gives us
			<me>
				\frac{d}{dx}[e^{6x} y] = -e^{6x}
			</me>.
			and solve it by integrating both sides. This is the essence of the integrating factor method.
		</p>

	<p>
		Recall, <xref ref="direct-integration" text="custom">direct integration</xref> provides a straightforward way to solve differential equations when the equation can be written in the form:
	</p>

	<p>
		<me> \frac{d}{dx}[g(x,y)] = f(x) </me>.
	</p>

	<p>
		In such cases, solving the equation is as simple as integrating both sides with respect to <m>x</m>. As you will see in the discussion that follow, the integrating factor method is essentially a direct integration problem in disguise. The difference here is that you must perform an initial step to rewrite the differential equation into a form for which direct integration applies.
	</p>

	<p>
		The integrating factor method relies on an essential calculus concept: the product rule for derivatives. 
	</p>

	<p>
		The key idea is to multiply the differential equation by an integrating factor that simplifies it into a form that can be solved by direct integration. In the next sections, we will explore how this is done, step by step.
	</p>

		<p> 
			We begin our discussion with a familiar concept that lies at the heart of the integrating factor (IF) methodâ€”the product rule. Recall that the product rule helps you differentiate the product of two functions. The IF method, however, does the reverse: it <q>undoes</q> the product rule to rewrite one side of the equation as a single derivative.
		</p>

		<p>
			This reversal is central to this method and can be challenging to grasp in the context of solving differential equations. In this section, we will first revisit the product rule, then practice reversing it in simple expressions, and finally, apply it in the context of differential equations.
		</p>

	</introduction>

	<subsubsection><title> Product Rule Review </title>

		<p>
			To ensure we're on the same page, let's quickly review the product rule from calculus. In calculus, you expand the derivative of <m>f(x) \cdot g(x)</m> as
			<men xml:id="if-product-rule-calculus-direction">
				\text{(Calculus)}\quad 
				\ub{[f(x) g(x)]'}_{\text{start here}} 
					= \ub{f(x) g'(x) + f'(x) g(x)}_{\text{goal}}
			</men>
		</p>

		<p>
			In the IF method, we reverse this process, starting with the expanded form and recombining it into a single derivative:
			<men xml:id="if-product-rule-if-direction">
				\text{(IF Method)}\quad
				\ub{f(x) g'(x) + f'(x) g(x)}_{\text{start here}} = \ub{[f(x) g(x)]'}_{\text{goal}}
			</men>
		</p>

		<p>
			To build intuition, we'll begin with examples of the product rule in its usual forward direction.
		</p>

		<example><title> Forward Product Rule </title>
			<p>
				<statement>
					<p>
						Compute each of the derivatives below.
						<me>
							1. \quad \left[x^6 e^{3x}\right]' \hspace{5em} 2. \quad \frac{d}{dx}\left[e^{x^3} y(x)\right]
						</me>
					</p>
				</statement>
			</p>

			<p>
				<solution>
					<p>
						Using the <xref ref="if-product-rule-calculus-direction" text="custom"> forward product rule </xref> and simplifying, we have
						<ol>
							<li>
								<p>
									<m>\ds
										\big[ 
											\overset{\color{BurntOrange}{f}}{\ln x \vphantom{\frac11}}\ 
											\overset{\color{BurntOrange}{g}}{\tan x \vphantom{\frac11}} 
										\big]' = 
											\overset{\color{BurntOrange}{f}}{\ln x \vphantom{\frac11}}\  
											\overset{\color{BurntOrange}{g'}}{\left(\sec^2 x\right) \vphantom{\frac11}} + 
											\overset{\color{BurntOrange}{f'}}{\left(\frac{1}{x}\right)}
											\overset{\color{BurntOrange}{g}}{\tan x \vphantom{\frac11}}
									</m>
								</p>
							</li>
							<li>
								<p>
									<m>\ds\frac{d}{dx}
										\big[ 
											\overset{\color{BurntOrange}{f}}{e^{x^3} \vphantom{\frac11}}\ 
											\overset{\color{BurntOrange}{g}}{y(x) \vphantom{\frac11}} 
										\big] = 
											\overset{\color{BurntOrange}{f}}{e^{x^3} \vphantom{\frac11}}\  
											\overset{\color{BurntOrange}{g'}}{y'(x) \vphantom{\frac11}} + 
											\overset{\color{BurntOrange}{f'}}{\left(3x^2\right)e^{x^3} \vphantom{\frac11}}
											\overset{\color{BurntOrange}{g}}{y(x) \vphantom{\frac11}}	
									</m>
								</p>
							</li>
						</ol>
					</p>
				</solution>
			</p>
		</example>

		<p>
			Now that we've discussed the standard product rule, let's practice reversing it.
		</p>

		<example><title> Reversed Product Rule </title>

			<p>
				<statement>
					<p>
						Rewrite each expression in the form <m>[f(x) \cdot g(x)]'</m>.
						<me>
							1. \quad e^{x}\cos x + e^{x}\sin x \hspace{5em} 2. \quad \frac{e^{x^2}}{x} + 2 x \ln(x) e^{x^2}
						</me>
					</p>
				</statement>
			</p>

			<solution>
				<p>
					<solution>
						<p>
							We want to apply the <xref ref="if-product-rule-if-direction" text="custom">reversed product rule</xref>. One approach is to use trail-and-error to label <m>f</m> and <m>g</m>. Then double-check that <m>f'</m> and <m>g'</m> are the other terms in the product rule.
						</p>

						<p>
							First, try labeling <m>f</m> and <m>g</m> as follows
							<md>
								<mrow>	
										e^x
										\underset{\color{BurntOrange}{f}}{ \underset{\color{BurntOrange}{\uparrow}}{\ul{\cos x}}}\  
										+ 
										\underset{\color{BurntOrange}{g}}{ \underset{\color{BurntOrange}{\uparrow}}{\ul{e^x}}}
										\sin x
										\amp = \big[ 
										\underset{\color{BurntOrange}{f}}{ \underset{\color{BurntOrange}{\uparrow}}{\ul{\cos x}}}\  
										\underset{\color{BurntOrange}{g}}{ \underset{\color{BurntOrange}{\uparrow}}{\ul{e^x}}}
										\big]'  \quad \leftarrow \text{doesn't work,}
								</mrow>
							</md>
							but this doesn't work since <m>[\cos x\ e^x]' = \cos x\ e^x + (-\sin x)\ e^x</m>.
						</p>
						<p>
							Next, try the labels
							<md>
								<mrow>	
										\underset{\color{BurntOrange}{f}}{ \underset{\color{BurntOrange}{\uparrow}}{\ul{e^x}}}
										\cos x + 
										e^x
										\underset{\color{BurntOrange}{g}}{ \underset{\color{BurntOrange}{\uparrow}}{\ul{\sin x}}}\
										\amp = \big[ 
										\underset{\color{BurntOrange}{f}}{ \underset{\color{BurntOrange}{\uparrow}}{\ul{e^x}}}\
										\underset{\color{BurntOrange}{g}}{ \underset{\color{BurntOrange}{\uparrow}}{\ul{\sin x}}}
										\big]'  \quad \leftarrow \text{works.}
								</mrow>
							</md>
							A quick check of <m>[e^x \sin x]' = e^x\cos x + e^x \sin x</m>, confirms this works.
						</p>

					</solution>

					<solution>
						<p>
							The labels are easier to determine if we first rewrite the expression as
							<me>
								\frac{1}{x} e^{x^2} + \ln(x) (2 x e^{x^2})
							</me>.
						</p>
						
						<p>
							So, as before, we first set <m>f</m> and <m>g</m>
							<md>
								<mrow>	
									\underset{\color{BurntOrange}{\text{verify } g'}}{ \underset{\color{BurntOrange}{\uparrow}}{\ul{\vphantom{\frac11}\frac{1}{x}}}}
									\underset{\color{BurntOrange}{f}}{ \underset{\color{BurntOrange}{\uparrow}}{\ul{\vphantom{\frac11}e^{x^2}}}} +
									\underset{\color{BurntOrange}{g}}{ \underset{\color{BurntOrange}{\uparrow}}{\ul{\ln(x)}}}\
									\underset{\color{BurntOrange}{\text{verify } f'}}{ \underset{\color{BurntOrange}{\uparrow}}{\ul{(2 x e^{x^2})}}}
									\amp = \big[ 
										\underset{\color{BurntOrange}{f}}{ \underset{\color{BurntOrange}{\uparrow}}{\ul{e^{x^2}}}} \
										\underset{\color{BurntOrange}{g}}{ \underset{\color{BurntOrange}{\uparrow}}{\ul{\ln(x)}}} 
									\big]'
								</mrow>
							</md>
							then verify the derivatives of <m>f</m> and <m>g</m>
							<me>
								f: \quad [e^{x^2}]' = 2 x e^{x^2} \qquad g:\quad [\ln(x)]' = \frac{1}{x} 
							</me>
							we see that <m>[e^{x^2} \ln(x)]'</m> works.
						</p>
					</solution>
				</p>
			</solution>
			
		</example>

		<p>
			Here is an example that includes a variable in the expression. This is more like what you will see in a the integrating factor method.
		</p>

		<example><title> Reversed Product Rule with a Variable </title>

			<p>
				<statement>
					<p>
						Rewrite each expression in the form <m>[f(x) \cdot y(x)]'</m>.
						<me>
							1. \quad e^{x^2}\frac{dy}{dx} + 2 xy e^{x^2} \hspace{5em} 2. \quad e^{1/x}y' - \frac{e^{1/x}}{x^2}y
						</me>
					</p>
				</statement>
			</p>

			<solution>
				<p>
					<solution>
						<p>
							The fact that we see <m>dy/dx</m> in the first term makes the labeling even easier since <m>f</m> must be <m>e^{x^2}</m> and <m>g</m> must be <m>y</m>. Confirming that the derivative of this <m>f</m> is <m>2xe^{x^2}</m> justifies the following reversed product rule
							<md>
								<mrow>	
										\underset{\color{BurntOrange}{f}}{ \underset{\color{BurntOrange}{\uparrow}}{\ul{e^{x^2}}}}\
										\frac{dy}{dx} + 
										\underset{\color{BurntOrange}{g}}{ \underset{\color{BurntOrange}{\uparrow}}{\ul{y}}}\
										\underset{\color{BurntOrange}{\text{verified } f^{'}}}{ \underset{\color{BurntOrange}{\uparrow}}{\ul{(2xe^{x^2})}}}
										=\amp\ \frac{d}{dx}\Big[ 
											\underset{\color{BurntOrange}{f}}{ \underset{\color{BurntOrange}{\uparrow}}{\ul{e^{x^2}}}}\
											\underset{\color{BurntOrange}{g}}{ \underset{\color{BurntOrange}{\uparrow}}{\ul{y}}}
											\Big] \quad \leftarrow \text{answer.}
								</mrow>
							</md>	
						</p>
					</solution>

					<solution>
						<p>
							Again, seeing <m>y'</m> in the first term means <m>f</m> must be <m>e^{1/x}</m> and <m>g</m> must be <m>y</m>. So we try the labeling
							<md>
								<mrow>	
										\underset{\color{BurntOrange}{f}}{ \underset{\color{BurntOrange}{\uparrow}}{\ul{e^{1/x}}}}\
										y' + 
										\underset{\color{BurntOrange}{g}}{ \underset{\color{BurntOrange}{\uparrow}}{\ul{y}}}\
										\underset{\color{BurntOrange}{\text{verified } f^{'}}}{ \underset{\color{BurntOrange}{\uparrow}}{\left(\ul{-\frac{e^{1/x}}{x^2}}\right)}}
										=\amp\ \big[ 
											\underset{\color{BurntOrange}{f}}{ \underset{\color{BurntOrange}{\uparrow}}{\ul{e^{1/x}}}}\
											\underset{\color{BurntOrange}{g}}{ \underset{\color{BurntOrange}{\uparrow}}{\ul{y}}}
											\big]' \quad \leftarrow \text{answer.}
								</mrow>
							</md>
							As a review, here are the details of the derivative of <m>f</m>:
							<me>
								f' = \left[e^{1/x}\right]' = e^{1/x}\left[\frac{1}{x}\right]^\prime = e^{1/x}\left(-\frac{1}{x^2}\right) = -\frac{e^{1/x}}{x^2}
							</me>.
						</p>
					</solution>
				</p>
			</solution>
			
		</example>
		
		<xi:include href="./c4-exercises/c4-chkpts-1-1-product-rule-review.ptx" />
		  
	</subsubsection>

	<subsubsection><title> Reversing the Product Rule in a Differential Equation </title>

		<p>
			Let's now extend this skill to include an actual differential equation.
		</p>

		<example xml:id="reversing-the-product-rule-in-a-DE-example"><title> Reversed Product Rule in a Differential Equation </title>

			<p>
				<statement>
					<p>
						Rewrite the left-side of the differential equation
						<men xml:id="reversing-the-product-rule-in-a-DE-example-eqn">
							e^{2x} \frac{dy}{dx} + 2e^{2x} y = 5e^{2x}
						</men>
						as a reversed product rule. Then find the general solution of the equation by <xref ref="direct-integration" text="custom">direct integration</xref>.
					</p>
				</statement>
			</p>

			<p>
				<solution>

					<ol>
						<li>
							<p>
								To reverse the product rule on the left-side, let's label <m>f</m> and <m>g</m> as before. This time, we get
							</p>

							<p>
								<md>
									<mrow>	
										\underset{\color{BurntOrange}{f}}{ \underset{\color{BurntOrange}{\uparrow}}{\ul{e^{2x}}}}\
										\frac{dy}{dx} + 
										\underset{\color{BurntOrange}{g}}{ \underset{\color{BurntOrange}{\uparrow}}{\ul{y}}}\
										\underset{\color{BurntOrange}{\text{verify}}}{ \underset{\color{BurntOrange}{\uparrow}}{\ul{(2e^{2x})}}}
										=\amp\ \frac{d}{dx}\big[ 
										\underset{\color{BurntOrange}{f}}{ \underset{\color{BurntOrange}{\uparrow}}{\ul{e^{2x}}}}\
										\underset{\color{BurntOrange}{g}}{ \underset{\color{BurntOrange}{\uparrow}}{\ul{y}}}
										\big]
									</mrow>
								</md>
								which allows us to rewrite the the equation as
								<me>
									\frac{d}{dx}\left[e^{2x} y \right] = 5e^{2x}
								</me>.
							</p>
						</li>
						<li>
							<p>
								To get the general solution, we directly integrate both sides of the equation with respect to <m>x</m>, like so 
								<md>
									<mrow>	\int \frac{d}{dx}\left[e^{2x} \cdot y \right]\ dx	=\amp \int \frac{5}{2} e^{2x}\ dx	</mrow>
									<mrow>	e^{2x} y											=\amp \frac{5}{2} e^{2x} + c		</mrow>
									<mrow>	y													=\amp \frac{5}{2} + c e^{-2x}		</mrow>
								</md>.
							</p>
						</li>
					</ol>
				</solution>
			</p>

		</example>

		<p>
			This example demonstrates how reversing the product rule on one side of a differential equation opens a path to finding its solution. As we will see in the next section, all first order and linear equations can be solved in this way, but they are missing a piece that must be found before the product rule can be reversed.
		</p>

		<xi:include href="./c4-exercises/c4-chkpts-1-2-reversing-the-product-rule-in-a-DE.ptx" />  

	</subsubsection>

</subsection>