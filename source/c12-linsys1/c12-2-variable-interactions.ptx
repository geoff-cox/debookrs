<!-- LICENSING
  This file is part of the textbook "Exploring Differential Equations, An Interactive, Student-Centered Approach" by Geoffrey Cox.
  License: Creative Commons Attribution-ShareAlike 4.0 International (CC BY-SA 4.0)
  You are free to:
    ‚Ä¢ Share ‚Äî copy and redistribute the material in any medium or format.
    ‚Ä¢ Adapt ‚Äî remix, transform, and build upon the material for any purpose, even commercially.
  Under the following terms:
    ‚Ä¢ Attribution ‚Äî You must give appropriate credit, provide a link to the license, and indicate if changes were made.
    ‚Ä¢ ShareAlike ‚Äî If you remix, transform, or build upon the material, you must distribute your contributions under the same license.
  Full license text: https://creativecommons.org/licenses/by-sa/4.0/legalcode
  Recommended attribution: "Exploring Differential Equations" by Geoffrey Cox, licensed CC BY-SA 4.0"
-->
<section xml:id="variable-interactions">
	<title>Interactions Between Variables</title>

	<introduction>
		<p>
			In the last section, we saw <em>uncoupled systems</em>, where each equation evolved completely on its own. 
			But many real-world systems aren't so tidy. Often one quantity affects another ‚Äî or they push on each other in both directions. 
		</p>
		<p>
			In this section, we'll step up the complexity: first looking at systems where one variable drives another, and then meeting the case where both variables interact fully.
		</p>
	</introduction>

	<!-- ======================================== -->
	<!-- SUBSECTION: Partially Coupled Systems    -->
	<!-- ======================================== -->
	<subsection xml:id="partially-coupled-systems">
		<title>Partially Coupled Systems</title>

		<p>
			Suppose we have two variables, <m>x(t)</m> and <m>y(t)</m>, but this time <m>y</m> depends on <m>x</m>. 
			In other words, <m>x</m> evolves independently, while <m>y</m> <q>listens</q> to <m>x</m>.
		</p>

		<p>
			Here's an example:
		</p>

		<md>
			<mrow>\frac{dx}{dt} \amp = -x \qquad x(0) = 1</mrow>
			<mrow>\frac{dy}{dt} \amp = -2y + x \qquad y(0) = 0</mrow>
		</md>

		<p>
			Notice what's happening: <m>x</m> follows a simple exponential decay. 
			Meanwhile, <m>y</m> is influenced by two things ‚Äî its own decay and whatever value <m>x</m> has at the time. 
			This is called a <em>partially coupled</em> system: one-way interaction.
		</p>

		<example xml:id="ex-partially-coupled">
			<title>Solving a Partially Coupled System</title>
			<statement>
				<p>
					Solve the system:
				</p>
				<md>
					<mrow>\frac{dx}{dt} \amp = -x \qquad x(0) = 1</mrow>
					<mrow>\frac{dy}{dt} \amp = -2y + x \qquad y(0) = 0</mrow>
				</md>
			</statement>

			<solution>
				<p>
					<term>Step 1:</term> Solve the independent equation for <m>x</m>.  
					This is a familiar exponential decay:
				</p>

				<me>
					\frac{dx}{dt} = -x \quad \Rightarrow \quad x(t) = e^{-t}.
				</me>

				<p>
					<term>Step 2:</term> Substitute <m>x(t) = e^{-t}</m> into the <m>y</m>-equation:
				</p>

				<me>
					\frac{dy}{dt} = -2y + e^{-t}.
				</me>

				<p>
					This is a linear first-order equation. Use an integrating factor to solve:
				</p>

				<me>
					y' + 2y = e^{-t}, \qquad \mu(t) = e^{2t}.
				</me>

				<p>
					Multiply by <m>e^{2t}</m> and rewrite the left side as a derivative:
				</p>

				<me>
					\frac{d}{dt}\left(e^{2t} y \right) = e^{t}.
				</me>

				<p>
					Integrate:
				</p>

				<me>
					e^{2t} y = \int e^{t} dt = e^{t} + C.
				</me>

				<p>
					Solve for <m>y(t)</m>:
				</p>

				<me>
					y(t) = e^{-t} + C e^{-2t}.
				</me>

				<p>
					Use the initial condition <m>y(0) = 0</m>:
				</p>

				<me>
					0 = 1 + C \quad \Rightarrow \quad C = -1.
				</me>

				<p>
					So the solution is:
				</p>

				<me>
					x(t) = e^{-t}, \qquad y(t) = e^{-t} - e^{-2t}.
				</me>

				<p>
					<m>x(t)</m> decays smoothly, while <m>y(t)</m> rises briefly (pulled by <m>x</m>) before eventually decaying as well.  
					This <q>one-way influence</q> is the hallmark of a partially coupled system.
				</p>
			</solution>
		</example>

		<exercise label="variable-interactions-partially-coupled-chkpt-bundle">
			<title><e component="emoji">üìñ‚ùì</e>  Partially Coupled Equations</title>
			<task label="variable-interactions-chkpt-1">
				<title><e component="emoji">üìñ‚ùì</e>  Partial Coupling is One-Way</title>
				<statement correct="yes">
					<p>
						In a partially coupled system, one variable affects the other, but not vice versa.
					</p>
				</statement>
				<feedback>
					<p>
						Exactly. In these systems, one equation is independent and can be solved first. The second equation depends on the first.
					</p>
				</feedback>
			</task>

			<task label="variable-interactions-chkpt-2">
				<title><e component="emoji">üìñ‚ùì</e>  Which Should You Solve First?</title>
				<statement>
					<p>
						You are given the system:
						<md>
							<mrow> \frac{dx}{dt} \amp = -x </mrow>
							<mrow> \frac{dy}{dt} \amp = -2y + x </mrow>
						</md>
						Which equation should you solve first?
					</p>
				</statement>
				<choices randomize="yes">
					<choice>
						<statement><p><m>dy/dt</m>, because it depends on both variables.</p></statement>
						<feedback><p>Not quite. You need to know <m>x(t)</m> before you can solve for <m>y(t)</m>.</p></feedback>
					</choice>
					<choice>
						<statement><p>It doesn't matter, either can be solved independently.</p></statement>
						<feedback><p>Actually, only <m>x</m> evolves independently. <m>y</m> depends on it.</p></feedback>
					</choice>
					<choice correct="yes">
						<statement><p><m>dx/dt</m>, because it is independent of <m>y</m>.</p></statement>
						<feedback><p>Correct. Solve the independent equation for <m>x</m> first, then use that in the equation for <m>y</m>.</p></feedback>
					</choice>
					<choice>
						<statement><p>Neither equation can be solved until both are known.</p></statement>
						<feedback><p>Actually, this is a one-way system, <m>x</m> drives <m>y</m>, not the other way around.</p></feedback>
					</choice>
				</choices>
			</task>
		</exercise>
	</subsection>

	<!-- ======================================== -->
	<!-- SUBSECTION: Fully Coupled Systems        -->
	<!-- ======================================== -->
	<subsection xml:id="fully-coupled-conceptual">
		<title>Fully Coupled Systems (Conceptual)</title>

		<p>
			We've seen systems where nothing interacts (uncoupled) and where one quantity drives another (partially coupled). 
			Now we reach the most intricate case: <em>fully coupled systems</em>.
		</p>

		<p>
			In a fully coupled system, <term>both</term> variables affect each other. 
			Neither equation stands alone ‚Äî any change in <m>x</m> alters <m>y</m>'s future, and <m>y</m> feeds back into <m>x</m>.
		</p>

		<p>
			Consider:
		</p>

		<md>
			<mrow>\frac{dx}{dt} \amp = x + y \qquad x(0) = 2</mrow>
			<mrow>\frac{dy}{dt} \amp = x - y \qquad y(0) = 0</mrow>
		</md>

		<p>
			Here, <m>x</m> and <m>y</m> are fully entangled ‚Äî you can't solve one without the other. 
			Instead of peeling off one equation at a time, we'll eventually treat the system as a single object.
		</p>

		<exercise label="variable-interactions-chkpt-3">
			<title><e component="emoji">üìñ‚ùì</e>  What Makes It <q>Fully Coupled</q>?</title>
			<statement>
				<p>
					What must be true for a system to be fully coupled?
				</p>
			</statement>
			<choices randomize="yes">
				<choice correct="yes">
					<statement><p>Both equations involve both variables.</p></statement>
				</choice>
				<choice correct="no">
					<statement><p>Each equation has only one variable.</p></statement>
					<feedback><p>That would actually make the system uncoupled.</p></feedback>
				</choice>
				<choice correct="no">
					<statement><p>One equation is independent, and the other depends on it.</p></statement>
					<feedback><p>That's partially coupled, not fully coupled.</p></feedback>
				</choice>
			</choices>
		</exercise>
	</subsection>

	<assemblage label="variable-interactions-wrap-up">
		<title>üì§ Wrap-Up</title>
		<p>
			<paragraphs label="variable-interactions-takeaways">
				<title>üóùÔ∏è Key Takeaways..</title>
				<ul marker="square">
					<li>In a partially coupled system, one equation is independent and the other depends on it.</li>
					<li>You can solve these without any new ideas by solving independent equation first, then substitute its solution into the dependent equation.</li>
					<li>These systems model one-way influences, like a light level driving plant growth.</li>
					<li>In fully coupled systems, both variables influence each other. Neither equation can be solved in isolation. That is, the system must be treated as a whole.</li>
				</ul>
			</paragraphs>

			<paragraphs label="variable-interactions-cyu">
				<title>Check Your Understanding</title>
				<exercise xml:id="variable-interactions-cyu-bundle">
					<title><e component="emoji">üìñ‚ùì</e>  Understanding Partially Coupled Systems</title>

					<task label="variable-interactions-cyu-1">
						<title><e component="emoji">üìñ‚ùì</e>  Identify the Coupling</title>
						<statement>
							<p>
								Consider the system:
								<md>
									<mrow> \frac{dx}{dt} \amp = -x </mrow>
									<mrow> \frac{dy}{dt} \amp = -3y + x </mrow>
								</md>
								Which of the following statements are true?
							</p>
						</statement>
						<choices randomize="yes">
							<choice correct="yes">
								<statement><m>x</m> evolves independently of <m>y</m>.</statement>
							</choice>
							<choice correct="yes">
								<statement><m>y</m> is influenced by <m>x</m>.</statement>
							</choice>
							<choice correct="no">
								<statement>Both variables depend on each other equally.</statement>
							</choice>
							<choice correct="yes">
								<statement>This is a partially coupled system.</statement>
							</choice>
							<choice correct="no">
								<statement>You must solve the <m>dy/dt</m> equation first.</statement>
							</choice>
						</choices>
					</task>

					<task label="variable-interactions-cyu-2">
						<title><e component="emoji">üìñ‚ùì</e>  Solving Strategy</title>
						<statement>
							<p>
								What is the best way to solve a partially coupled system?
							</p>
						</statement>
						<choices randomize="yes">
							<choice correct="yes">
								<statement><p>Solve the independent equation first, then substitute into the other equation.</p></statement>
							</choice>
							<choice correct="no">
								<statement><p>Solve both equations at the same time using elimination.</p></statement>
								<feedback><p>You <em>could</em> do that, but it's much simpler to solve the independent one first.</p></feedback>
							</choice>
							<choice correct="no">
								<statement><p>Write the system as one second-order DE before solving.</p></statement>
								<feedback><p>That's unnecessary for partially coupled systems ‚Äî keep it simple.</p></feedback>
							</choice>
						</choices>
					</task>

					<task label="variable-interactions-cyu-3">
						<title><e component="emoji">üìñ‚ùì</e>  Spot the Coupling</title>
						<statement>
							<p>
								Consider the system:
							</p>
							<md>
								<mrow>\frac{dx}{dt} \amp = 3x + y</mrow>
								<mrow>\frac{dy}{dt} \amp = 4x - 2y</mrow>
							</md>
							<p>
								Which of these statements are true?
							</p>
						</statement>
						<choices randomize="yes">
							<choice correct="yes">
								<statement><p><m>x</m> depends on <m>y</m>.</p></statement>
							</choice>
							<choice correct="yes">
								<statement><p><m>y</m> depends on <m>x</m>.</p></statement>
							</choice>
							<choice correct="no">
								<statement><p>This is a partially coupled system.</p></statement>
								<feedback><p>Not quite ‚Äî both equations are entangled, which makes it fully coupled.</p></feedback>
							</choice>
							<choice correct="no">
								<statement><p>You can solve for <m>x</m> first, then plug into <m>y</m>.</p></statement>
								<feedback><p>Because <m>x</m> depends on <m>y</m> as well, you can't isolate them that easily.</p></feedback>
							</choice>
						</choices>
					</task>
				</exercise>
			</paragraphs>
		</p>
	</assemblage>

	<!-- ================================================================ -->
	<!-- WRAP-UP + READING QUESTIONS                                      -->
	<!-- ================================================================ -->
	<subsection label="variable-interactions-wrap-up">
		<title>üì§ Wrap-Up</title>

		<assemblage label="variable-interactions-wrap-up-takeaways">
			<p>
				üóùÔ∏è <m>\textbf{Key Takeaways...}</m>
				<ul marker="square">
					<li></li>
				</ul>
			</p>
		</assemblage>
		<paragraphs label="variable-interactions-cyu">
			<title>Check Your Understanding</title>

			<exercise label="variable-interactions-cyu-bundle">
				<title><e component="emoji">ü§îüí≠</e> Separation of Variables Reading Questions</title>

				<task label="variable-interactions-cyu-1">
					<title><e component="emoji">ü§îüí≠</e> SOV and Nonlinear Equations</title>
					<statement correct="no">
						<p>
							The separation of variables method cannot be applied to non-linear differential equations.
						</p>
					</statement>
					<feedback>
						<p>
							Being able to solve non-linear differential equations is one of the strengths of the separation of variables method.
						</p>
					</feedback>
				</task>
				<task label="variable-interactions-cyu-2">
					<title><e component="emoji">ü§îüí≠</e> Sort the Steps in Order</title>

					<statement>
						<p>
							CONVERT TO PARSONS.. Suppose you want to use separation of variables method to determine the general solution of the differential equation
							<men xml:id="chkpt-variable-interactions-examples-1-eqn">
								\ds \frac{dq}{dt} - 3qt^2 = 2q
							</men>.
						</p>
						<p>
							Match the scrambled tasks (on the left) to the task order (on the right) that it should be performed to use this method.
						</p>
					</statement>
					<feedback>
						<p>
							Review the <xref ref="variable-interactions" text="custom">SOV Method</xref>.
						</p>
					</feedback>
					<cardsort>
						<match>
							<premise>
								<p>
									Equation is 1st-order ‚úÖ
								</p>
							</premise>
							
							<response>
								<p>
									<m>\text{Task 1}</m>
								</p>
							</response>
						</match>
						<match>
							<premise>
								<p>
									<m>\ds \frac{dq}{dt} = q(2 + 3t^2)</m>
								</p>
							</premise>
							<response>
								<p>
									<m>\text{Task 2}</m>
								</p>
							</response>
						</match>
						<match>
							<premise>
								<p>
									<m>\ds \frac{1}{q}\ dq = (2 + 3t^2)\ dt</m>
								</p>
							</premise>
							<response>
								<p>
									<m>\text{Task 3}</m>
								</p>
							</response>
						</match>
						<match>
							<premise>
								<p>
									<m>\ds \int \frac{1}{q} dq = \int (2 + 3t^2) dt</m>
								</p>
							</premise>
							
							<response>
								<p>
									<m>\text{Task 4}</m>
								</p>
							</response>
						</match>
						<match>
							<premise>
								<p>
									<line><m>\ds \ln|q| = 2t^2 + t^3 + c</m></line>
								</p>
							</premise>
							<response>
								<p>
									<m>\text{Task 5}</m>
								</p>	
							</response>
						</match>
						<match>
							<premise>
								<p>
									<line><m>\ds q = c e\vphantom{|}^{\large 2t^2 + t^3}</m></line>
								</p>
							</premise>
							<response>
								<p>
									<m>\text{Task 6}</m>
								</p>
							</response>
						</match>
					</cardsort>
				</task>
				<task label="variable-interactions-cyu-3">
					<title><e component="emoji">ü§îüí≠</e> Combining Constants</title>

					<statement>
						<p>
							Which of the following are valid ways to combine constants when finalizing your solution? Select ALL that apply.
						</p>
					</statement>
					<choices randomize="yes">
						<choice correct="yes">
							<statement>
								<m>
									\quad \left\{
									\begin{align}
										|y|	\amp = e^{2x + c_1}\\ 
										y	\amp = c_2 e^{2x} 
									\end{align}
									\right.\qquad
								</m> 
								where <m>c_2=\pm e^{c_1}</m>.
							</statement>
							<feedback>
								<p>
									Correct, since
									<md>
										<mrow>	|y|	\amp =,	e^{2x + c_1}										</mrow>
										<mrow>	y	\amp =,	\pm e^{2x + c_1}									</mrow>
										<mrow>	y	\amp =,	\pm e^{2x} \cdot e^{c_1}							</mrow>
										<mrow>	y	\amp =,	c_2 e^{2x}	\quad \text{where } c_2 = \pm e^{c_1}	</mrow>
									</md>
								</p>
							</feedback>
						</choice>
						<choice correct="yes">
							<statement>
								<m>
									\quad \left\{
									\begin{align}
										\frac{y^2}{2} \amp = \sin(x) + c_1\\ 
										y^2 \amp = 2\sin(x) + c_2 
									\end{align}
									\right.\qquad
								</m> 
								where <m>c_2 = 2c_1</m>.
							</statement>
							<feedback>
								<p>
									Correct, since
									<md>
										<mrow>	\frac{y^2}{2}	\amp =,	\sin(x) + c_1									</mrow>
										<mrow>	y^2				\amp =,	\sin(x) + 2c_1									</mrow>
										<mrow>	y^2				\amp =,	2\sin(x) + c_2	\quad \text{where } c_2 = 2c_1	</mrow>
									</md>
								</p>
							</feedback>
						</choice>
						<choice>
							<statement>
								<m>
									\quad \left\{
									\begin{align}
										y^2	\amp = 2\sin(x) + c_2\\ 
										y	\amp = \pm\sqrt{2\sin(x)} + c_3 
									\end{align}
									\right.\qquad
								</m> 
								where <m>c_3=\pm \sqrt{c_2}</m>.
							</statement>
							<feedback>
								<p>
									Incorrect, you should not combine constants here since <m>\quad\sqrt{A + B} \neq \sqrt{A} + \sqrt{B}</m>.
								</p>

								<p>
									Your solution should be written as
									<md>
										<mrow>	y^2	\amp =,	2\sin(x) + c_2											</mrow>
										<mrow>	y	\amp =,	\pm\sqrt{2\sin(x) + c_2}\quad \leftarrow\text{ done}	</mrow>
									</md>
								</p>
							</feedback>
						</choice>
						<choice>
							<statement>
								<m>
									\quad \left\{
									\begin{align}
										e^y	\amp =	3y + c_1\\ 
										y	\amp =	\ln(3y) + c_2 
									\end{align}
									\right.\qquad
								</m> 
								where <m>c_2= \ln(c_1)</m>.
							</statement>
							<feedback>
								
								<p>
									Incorrect, you should not combine constants here since <m>\ln(A + B) \neq \ln(A) + \ln(B)</m>.
								</p>

								<p>
									Your solution should be
									<md>
										<mrow>	e^y	\amp =,	3y + c_1									</mrow>
										<mrow>	y	\amp =,	\ln(3y + c_1)\quad \leftarrow\text{ done}	</mrow>
									</md>
								</p>
							</feedback>
						</choice>
						<choice>
							<statement>
								<m>
									\quad \left\{
									\begin{align}
										xy	\amp =	e^x + c_1\\ 
										y	\amp =	\frac{e^x}{x} + c_2 
									\end{align}
									\right.\qquad
								</m> 
								where <m>\ds c_2=\frac{c_1}{x}</m>.
							</statement>
							<feedback>
								<p>
									Incorrect, you should not combine constants here since <m>\frac{c_1}{x}</m> is not constant. Instead your solution should be left as
									<md>
										<mrow>	xy	\amp =,	e^x + c_1													</mrow>
										<mrow>	y	\amp =,	\frac{e^x + c_1}{x}											</mrow>
										<mrow>	y	\amp =,	\frac{e^x}{x} + \frac{c_1}{x}\quad \leftarrow\text{ done}	</mrow>
									</md>
								</p>
							</feedback>
						</choice>
						<choice correct="yes">
							<statement>
								<m>
									\quad \left\{
									\begin{align}
										\sqrt{y}	\amp =	c_1e^{3x}\\ 
										y			\amp =	c_2\, e^{6x} 
									\end{align}
									\right.\qquad
								</m> 
								where <m>c_2= c_1^2</m>.
							</statement>
							<feedback>
								<p>
									Correct, since
									<md>
										<mrow>	\sqrt{y}	\amp =,	c_1e^{3x}									</mrow>
										<mrow>	y			\amp =,	(c_1e^{3x})^2								</mrow>
										<mrow>	y			\amp =,	c_1^2(e^{3x})^2								</mrow>
										<mrow>	y			\amp =,	c_2\, e^{6x}\quad \text{where } c_2 = c_1^2	</mrow>
									</md>
								</p>
							</feedback>
						</choice>
					</choices>
				</task>
			</exercise>
		</paragraphs>
	</subsection>
</section>