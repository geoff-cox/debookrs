<section label="laplace-piecewise-method">
	<title> Laplace Method with Piecewise Forcing Functions </title>
	<introduction>
		<p>
			Here we bring it all together and apply the Laplace method step-by-step to differential equations with piecewise forcing.
		</p>

		<p>
			Our current goal is to be able to compute the Laplace transform of both sides of the differential equation, 
			<me>
				y'' + y = 
				\left\{
				\begin{array}{ll}
					2t, \amp 0 \le t \lt 1 \\
					3,  \amp 1 \le t \lt 4 \\
					0,  \amp t \ge 4
				\end{array}
				\right.
			</me>
		</p>

		<p>
			In general, we'll first need to convert the piecewise function into its unit-step form. We did this in <xref provisional="NEED REF?"/>, which shows that the equation can be written as
			<me>
				y'' + y = 
				2t\, u_0(t) + (3 - 2t)\, u_1(t) - 3\, u_4(t)
			</me> 
		</p>

		<p>
			Taking the Laplace transform of both sides, we get
			<me>
				\lap{y''} + \lap{y} = 
				2\lap{t\, u_0(t)} + \lap{(3 - 2t)\, u_1(t)} - 3\lap{u_4(t)}
			</me>.
		</p>

		<p>
			You have seen the transforms on the left before, but the right side is new. In general, a piecewise function will contain terms of one of the following forms:
			<me>
				\lap{u_c(t)} \quad\text{and}\quad \lap{f(t)\, u_c(t)} 
			</me>.
			Therefore, we need to derive transform rules for these types of terms.
		</p>
	</introduction>

	<subsection label="piecewise-strategy">
		<title> Strategy for Solving with Piecewise Forcing </title>
	</subsection>

	<subsection label="piecewise-forward">
		<title> Forward Transform with Step Functions </title>

	<paragraphs><title> Forward Transform into the Laplace Domain (Step 1) </title>
		<p>
			When the forcing function <m>g(t)</m> is piecewise-defined, our first task is to rewrite it using unit step functions. This step is crucial, without it, the Laplace transform can't "see" the function properly across its intervals. Once rewritten, we apply the Laplace transform using the rules:
			<men>
				\lap{u_c(t)} = \frac{e^{-cs}}{s}
				\qquad\text{and}\qquad
				\lap{f(t)\cdot u_c(t)} = e^{-cs} \lap{f(t + c)}.
			</men>
		</p>

		<p>
			These rules make it possible to transform any function written in unit step form. If your piecewise function is expressed as a sum of terms like <m>f(t)\, u_c(t)</m>, then each one transforms into <m>e^{-cs} \lap{f(t + c)}</m>. This shift is the key move in Step 1 when dealing with piecewise inputs.
		</p>

		<example><title> Forward Transform with Step Functions </title>
			<statement>
				<p>
					Apply the Laplace transform to both sides of the differential equation:
					<me>
						y'' + y = \left\{
						\begin{array}{ll}
							0,       \amp t \lt 1 \\
							3t,      \amp 1 \le t \lt 2 \\
							0,       \amp t \ge 2
						\end{array}
						\right., 
						\qquad
						y(0) = 0,\quad y'(0) = 0
					</me>
				</p>
			</statement>

			<solution><title> <m>\rightarrow</m> Laplace equation (Step 1) </title>
				<p>
					The forcing function is active only from <m>t = 1</m> to <m>t = 2</m>, so we rewrite it using a unit step window:
					<me>
						g(t) = 3t \cdot \left(u_1(t) - u_2(t)\right).
					</me>
				</p>

				<p>
					Apply the Laplace transform to both sides of the DE:
					<me>
						\lap{y'' + y} = \lap{3t \cdot (u_1(t) - u_2(t))}.
					</me>
					On the left-hand side, using <m>y(0) = y'(0) = 0</m>, we have:
					<me>
						s^2 Y(s) + Y(s).
					</me>
				</p>

				<p>
					On the right-hand side, distribute the Laplace transform:
					<me>
						\lap{3t \cdot (u_1(t) - u_2(t))} = 3\lap{t \cdot u_1(t)} - 3\lap{t \cdot u_2(t)}.
					</me>

					Use the shift rule for each term:
					<md>
						<mrow> \lap{t \cdot u_1(t)} = e^{-s} \lap{t + 1} = e^{-s} \cdot \lap{t + 1} </mrow>
						<mrow> \lap{t \cdot u_2(t)} = e^{-2s} \lap{t + 2} = e^{-2s} \cdot \lap{t + 2} </mrow>
					</md>

					Now apply linearity and known transforms:
					<md>
						<mrow> \lap{t + c} = \lap{t} + c\lap{1} = \frac{1}{s^2} + \frac{c}{s} </mrow>
					</md>

					So:
					<md>
						<mrow>
							\lap{3t \cdot (u_1 - u_2)} 
							\amp = 3e^{-s}\left(\frac{1}{s^2} + \frac{1}{s}\right) 
							- 3e^{-2s}\left(\frac{1}{s^2} + \frac{2}{s}\right)
						</mrow>
					</md>
				</p>

				<p>
					Combining both sides, we arrive at the Laplace equation:
					<me>
						(s^2 + 1)Y(s) = 3e^{-s}\left(\frac{1}{s^2} + \frac{1}{s}\right) 
						- 3e^{-2s}\left(\frac{1}{s^2} + \frac{2}{s}\right).
					</me>
					This completes Step 1.
				</p>
			</solution>
		</example>

		<p>
			Now that we've built the Laplace equation, the remaining steps are familiar. We'll solve for <m>Y(s)</m>, simplify, and invert. But there's one twist: the presence of <m>e^{-cs}</m> terms means we'll need special care when taking the inverse Laplace transform. Let's explore that next.
		</p>
	</paragraphs>


	</subsection>

	<subsection label="piecewise-inverse">
		<title> Inverse Transform with Exponential Shifts </title>

	<paragraphs><title> Backward Transform Out of the Laplace Domain (Step 4) </title>
		<p>
			Once we've solved for <m>Y(s)</m> in the Laplace domain, the final challenge is to take the inverse Laplace transform. When the forcing function was continuous, this step relied on partial fractions and matching terms from the Laplace table. That still works here, but now we'll also see terms involving exponentials like <m>e^{-cs}F(s)</m>.
		</p>

		<p>
			These exponentials come directly from transforming unit step expressions. To move back to the <m>t</m>-domain, we need a new tool: a rule that undoes the exponential shift.
		</p>

		<assemblage xml:id="inverse-exp-shift"><title> Inverse Laplace of an Exponential Shift </title>
			<p>
				If a Laplace-domain expression contains an exponential factor <m>e^{-cs}</m>, it corresponds to a  in the time domain:
				<me>
					\ilap{e^{-cs}F(s)} = u_c(t)\cdot f(t - c)
				</me>
				where <m>f(t)</m> is the inverse transform of <m>F(s)</m>.
			</p>

			<p>
				This means you take the inverse of the non-exponential part as usual, and then:
				<ul marker="square">
					<li>multiply by <m>u_c(t)</m></li>
					<li>replace <m>t</m> with <m>t - c</m></li>
				</ul>
				This shift reflects the fact that the original piece only became active at <m>t = c</m>.
			</p>

			<aside><title> Where this rule comes from </title>
				<p>
					This is the inverse version of the rule:
					<me>\lap{f(t)\, u_c(t)} = e^{-cs} \lap{f(t + c)}.</me>
					What's happening is that multiplying by <m>e^{-cs}</m> delays a signal in the time domain by <m>c</m> units, and multiplies it by a step function to ensure it's zero before <m>t = c</m>.
				</p>
			</aside>
		</assemblage>

		<example><title> Inverse Transform of an Exponential Shift </title>
			<statement>
				<p>
					Find <m>y(t)</m> if:
					<me>
						Y(s) = e^{-3s} \cdot \frac{2}{s^2 + 9}
					</me>
				</p>
			</statement>

			<solution><title> <m>\rightarrow</m> Inverse Laplace Transform </title>
				<p>
					This is already in the form <m>e^{-cs}F(s)</m> with <m>c = 3</m> and <m>F(s) = \frac{2}{s^2 + 9}</m>.
				</p>

				<p>
					The inverse transform of <m>\frac{2}{s^2 + 9}</m> is <m>\sin(3t)</m>, since this matches the standard form:
					<me>\ilap{ \frac{b}{s^2 + b^2} } = \sin(bt)</me>.
				</p>

				<p>
					Applying the shift rule:
					<me>
						y(t) = u_3(t) \cdot \sin(3(t - 3)) = u_3(t)\cdot \sin(3t - 9)
					</me>
				</p>
			</solution>
		</example>

		<p>
			This simple rule allows us to invert even complicated-looking expressions like <m>e^{-2s}(s + 1)/(s^2 + 4)</m>. First invert the expression without the exponential, then shift and multiply by <m>u_2(t)</m>.
		</p>

		<example><title> Inverse Transform with Shifting and Sinusoids </title>
			<statement>
				<p>
					Find <m>f(t)</m> if:
					<me>
						F(s) = e^{-2s} \cdot \frac{s}{s^2 + 4}
					</me>
				</p>
			</statement>

			<solution><title> <m>\rightarrow</m> Inverse Laplace Transform </title>
				<p>
					We identify this as <m>e^{-2s} \cdot F(s)</m>, where
					<me>
						F(s) = \frac{s}{s^2 + 4}.
					</me>

					This matches the form for <m>\cos(2t)</m>:
					<me>\ilap{ \frac{s}{s^2 + b^2} } = \cos(bt).</me>
				</p>

				<p>
					So the inverse is:
					<me>
						f(t) = u_2(t) \cdot \cos(2(t - 2)) = u_2(t)\cdot \cos(2t - 4)
					</me>
				</p>
			</solution>
		</example>

		<p>
			As these examples show, returning to the time domain with step functions is just a matter of shifting. In each case:
			<ol>
				<li>Ignore the exponential and find the inverse as usual.</li>
				<li>Replace <m>t</m> with <m>t - c</m>.</li>
				<li>Multiply by <m>u_c(t)</m>.</li>
			</ol>
			This rule works for every exponential shift that came from a <m>u_c(t)</m> factor in the original problem.
		</p>

		<p>
			Next, we'll put everything together and solve full differential equations that involve piecewise forcing functions, from beginning to end.
		</p>
	</paragraphs>
	</subsection>
</section>