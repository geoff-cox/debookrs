<!-- LICENSING
  This file is part of the textbook "Exploring Differential Equations, An Interactive, Student-Centered Approach" by Geoffrey Cox.
  License: Creative Commons Attribution-ShareAlike 4.0 International (CC BY-SA 4.0)
  You are free to:
    ‚Ä¢ Share ‚Äî copy and redistribute the material in any medium or format.
    ‚Ä¢ Adapt ‚Äî remix, transform, and build upon the material for any purpose, even commercially.
  Under the following terms:
    ‚Ä¢ Attribution ‚Äî You must give appropriate credit, provide a link to the license, and indicate if changes were made.
    ‚Ä¢ ShareAlike ‚Äî If you remix, transform, or build upon the material, you must distribute your contributions under the same license.
  Full license text: https://creativecommons.org/licenses/by-sa/4.0/legalcode
  Recommended attribution: "Exploring Differential Equations" by Geoffrey Cox, licensed CC BY-SA 4.0"
-->
<section label="solving-high-order-lhccs" xmlns:xi="http://www.w3.org/2001/XInclude" >
	<title>Solving High-Order LHCC Equations</title>

	<introduction>
		<p>
			As the previous section demonstrated, constructing the general solution of a LHCC equation is fairly straightforward given the roots of the characteristic equation. However, solving <em>high-degree polynomial equations</em> can be quite challenging. While there are strategies to tackle this by hand, sometimes computational tools are necessary to obtain the solutions. Below, we will outline some common approaches
		</p>


	</introduction>

	<paragraphs label="factoring">
		<title>Factoring</title>

		<p>
			Some high-degree characteristic polynomials can be factored by hand using classic algebraic techniques. Factoring is the fastest way to solve these problems when it works. We'll start by reviewing common methods of factoring and apply them to characteristic equations that appear in LHCC differential equations.
		</p>

		<p>
			Here are a few algebraic strategies you may find helpful:
		</p>

		<assemblage xml:id="factoring-technique0"><title>üßÆ Factoring Techniques</title>
			<p>
				<dl>
					<li><title><m>\textbf{Common Factor}</m></title>
						<p>
							<md>
								<mrow> ab + ac + ad = a(b+c+d)	</mrow>
							</md>
						</p>
					</li>
					<li><title><m>\textbf{Grouping}</m></title>
						<p>
							<md>
								<mrow> ab + ac + bd + cd	\amp = a(b+c) + d(b+c)	</mrow>
								<mrow>						\amp = (a+d)(b+c)		</mrow>
							</md>
						</p>
					</li>
					<li><title><m>\textbf{Difference of Squares}</m></title>
						<p>
							<me> a^2 - b^2 = (a+b)(a-b) </me>
						</p>
					</li>
					<li><title><m>\textbf{Difference of Cubes}</m></title>
						<p>
							<me> a^3 - b^3 = (a-b)(a^2+ab+b^2)</me>
						</p>
					</li>
					<li><title><m>\textbf{Sum of Cubes}</m></title>
						<p>
							<me> a^3 + b^3 = (a+b)(a^2-ab+b^2)</me>
						</p>
					</li>
				</dl>
			</p>
		</assemblage>

		<p>
			Let's now apply these tools to solve higher-order LHCC equations by factoring their characteristic equations.
		</p>

		<example>
			<title>Solving LHCC Equations by Factoring the Characteristic Equation</title>

			<statement>
				<p>
					These examples show how to find the general solution to higher-order LHCC equations using a variety of factoring techniques to find the roots of the characteristic equation.
				</p>

				<sidebyside widths="37% 63%" valign="top">
					<p>1. <m>\ 4 y'' - 9 = 0</m> </p>
					<p>
						<solution>
							<p>The characteristic equation is:</p>
							<me>4 r^2 - 9 = 0</me>
							<p>
								Applying the difference of squares:
							</p>
							<md>
								<mrow> \amp (2 r + 3)(2 r - 3) = 0  </mrow>
								<mrow> \amp r = -\sfrac{3}{2},\ \sfrac{3}{2}  </mrow>
								<mrow> \amp \Rightarrow\quad y = c_1 e^{-\frac{3}{2}x} + c_2 e^{\frac{3}{2}x}  </mrow>
							</md>
						</solution>
					</p>
				</sidebyside>

				<sidebyside widths="37% 63%" valign="top">
					<p>2. <m>\ y^{(5)} - 4 y''' = 0</m></p>
					<p>
						<solution>
							<p>The characteristic equation is:</p>
							<me>r^5 - 4 r^3 = 0</me>
							<p>Factoring out the common term <m>r^3</m>, followed by a differences of squares gives:</p>
							<md>
								<mrow> r^3(r^2 - 4)			\amp = 0</mrow>
								<mrow> r^3(r + 2)(r - 2)	\amp = 0</mrow>
							</md>
							<me>r = 0\ (\text{triple}),\ -2,\ 2</me>
							<me>
								\Rightarrow\quad y = c_1 + c_2 x + c_3 x^2 + c_4 e^{-2x} + c_5 e^{2x}
							</me>
						</solution>
					</p>
				</sidebyside>

				<sidebyside widths="37% 63%" valign="top">
					<p>3. <m>\ y^{(4)} - 25 = 0</m></p>
					<p>
						<solution>
							<p><me>r^4 - 25 = 0</me></p>
							<p>This factors as a difference of squares twice:</p>
							<md>
								<mrow> (r^2 + 5)(r^2 - 5) \amp = 0</mrow>
								<mrow> (r^2 + 5)(r + \sqrt{5})(r - \sqrt{5}) \amp = 0</mrow>
							</md>
							<me>r = \pm i\sqrt{5},\ -\sqrt{5},\ \sqrt{5}</me>
							<md>
								<mrow>\Rightarrow\quad y = c_1 \cos(\sqrt{5}x) \amp + c_2 \sin(\sqrt{5}x) </mrow>
								<mrow> \amp + c_3 e^{\sqrt{5}x} + c_4 e^{-\sqrt{5}x}</mrow>
							</md>
						</solution>
					</p>
				</sidebyside>

				<sidebyside widths="37% 63%" valign="top">
					<p>4. <m>\ y^{(4)} - 5y'' + 4 = 0</m></p>
					<p>
						<solution>
							<p>The characteristic equation is:</p>
							<p><me>r^4 - 5r^2 + 4 = 0</me></p>
							<p>Use the substitution, <m>u = r^2</m>, to reveal a quadratic in disguise:</p>
							<md>
								<mrow> u^2 - 5u + 4		\amp = 0</mrow>
								<mrow> (u - 4)(u - 1)	\amp = 0</mrow>
							</md>
							<p>Reverse the substitution, <m>u = r^2</m>, back into <m>r</m>:</p>
							<md>
								<mrow> (r^2 - 4)(r^2 - 1)			\amp = 0</mrow>
								<mrow> (r - 2)(r + 2)(r - 1)(r + 1)	\amp = 0</mrow>
							</md>
							<me>r = -2,\ 2,\ -1,\ 1</me>
							<me>
								\Rightarrow\quad y = c_1 e^{x} + c_2 e^{-x} + c_3 e^{2x} + c_4 e^{-2x}
							</me>
						</solution>
					</p>
				</sidebyside>

				<sidebyside widths="37% 63%" valign="top">
					<p>5. <m>\ y^{(4)} - 6y''' + 9y'' = 0</m></p>
					<p>
						<solution>
							<p>The characteristic equation is:</p>
							<p><me>r^4 - 6r^3 + 9r^2 = 0</me></p>
							<p>Take out <m>r^2</m> and use standard factoring:</p>
							<md>
								<mrow> r^4 - 6r^3 + 9r^2	\amp = 0</mrow>
								<mrow> r^2(r^2 - 6r + 9)	\amp = 0</mrow>
								<mrow> r^2(r - 3)^2			\amp = 0</mrow>
							</md>
							<me> r = 0\ (\text{double}),\ 3\ (\text{double})</me>
							<me>
								\Rightarrow\quad y = c_1 + c_2 x + c_3 e^{3x} + c_4 x e^{3x}
							</me>
						</solution>
					</p>
				</sidebyside>

				<sidebyside widths="37% 63%" valign="top">
					<p>6. <m>\ y^{(5)} - 4 y''' + 8 y'' + 48 = 0</m></p>
					<p>
						<solution>
							<p>The characteristic equation is:</p>
							<p><me>r^5 - 4 r^3 + 8 r^2 + 48 = 0</me></p>
							<p>We can factor this by grouping and recognizing a sum of cubes:</p>
							<md>
								<mrow> r^5 - 4 r^3 + 8 r^2 + 48 \amp = 0</mrow>
								<mrow> r^3(r^2 - 4) + 8(r^2 - 4) \amp = 0</mrow>
								<mrow> (r^3 + 8)(r^2 - 4) \amp = 0</mrow>
								<mrow> (r + 2)(r^2 - 2r + 4)(r + 2)(r - 2) \amp = 0</mrow>
							</md>
							<me>r = -2\ (\text{double}),\ 2,\ 1 \pm i\sqrt{3}</me>
							<md>
								<mrow>\Rightarrow\quad y = c_1 e^{-2x} 	\amp + c_2 x e^{-2x} + c_3 e^{2x} </mrow>
								<mrow>								+	\amp\ e^{x}(c_4 \cos(\sqrt{3}x) + c_5 \sin(\sqrt{3}x))</mrow>
							</md>
						</solution>
					</p>
				</sidebyside>
			</statement>
		</example>

	</paragraphs>

	<paragraphs label="rational-root-theorem">
		<title>Rational Root Theorem</title>
		<p>
			When the characteristic polynomial is hard to factor by inspection, the <em>Rational Root Theorem</em> provides a systematic way to search for rational (fractional) solutions. Once you find a root, you can use polynomial division to reduce the polynomial to a lower degree. From there, you can repeat the process or apply other factoring techniques.
		</p>

		<p>
			While this method is reliable, it can be tedious by hand and prone to errors. That's why technology often comes in handy.
		</p>
	</paragraphs>

	<paragraphs label="technology-factoring">
		<title>Using Technology: Factoring High-Degree Polynomials</title>
		<p>
			Not all characteristic polynomials can be factored easily ‚Äî and some can't be factored at all using simple algebra. In these cases, it's perfectly reasonable to turn to technology.
		</p>

		<p>
			Computer algebra systems (CAS), online factoring tools, and symbolic solvers can quickly find the roots of even complicated polynomials. Once you have the roots, you can build the general solution using the framework you learned earlier.
		</p>

		<p>
			For example, suppose you want to solve the following LHCC equation:
		</p>

		<me>
			2 y^{(4)} + 9 y''' + y'' - 21 y' + 9 y = 0
		</me>.

		<p>
			The first step is to write down the characteristic equation:
			<me>
				2r^4 + 9r^3 + r^2 - 21r + 9 = 0
			</me>
		</p>

		<p>
			This is challenging to solve by hand, but we can use the tool below to factor it. 
		</p>

		<p>
			Type <c>2*r^4 + 9*r^3 + r^2 - 21*r + 9</c> into the text box and press enter.
		</p>

		<corollary xml:id="factoring-tool">
			<title>Polynomial Factoring Calculator Directions</title>
			<introduction>
				<p>
					Directions:
					<ul>
						<li>Enter a polynomial in the box below.</li>
						<li>Use <c>r</c> for the variable, <c>*</c> for multiplication, and <c>^</c> for exponents.</li>
						<li>Press enter to see the factored form and approximate values.</li>
						<li>Note: It only factors polynomials with fractional (rational) roots.</li>
					</ul>
				</p>
			</introduction>
		</corollary>

		<interactive xml:id="poly-factor" platform="sage" width="100%" aspect="3:1">
			<slate surface="sage">
				<xi:include href="sage-factoring-tool.txt" parse="text" />
			</slate>
		</interactive>

		<p>
			After entering the polynomial, you should see the factored form:
			<me>
				2\left(r - 1\right)\left(r - \frac12\right)\left(r + 3\right)^2
			</me>
		</p>

		<p>
			From here the roots are easily identified as:
			<me>
			r = 1,\quad r = -3\ (\text{double root}),\quad r = \frac{1}{2}
			</me>
		</p>

		<p>
			Therefore, the general solution is:
		</p>

		<me>
			y = c_1 e^{x} + c_2 e^{-3x} + c_3 x e^{-3x} + c_4 e^{\frac{1}{2}x}
		</me>

		<exercise label="chkpt-solving-high-order-lhccs-1">
			<title><e component="emoji">üìñ‚ùì</e>  Solving a High-Order LHCC Equation With a Factoring Tool</title>

			<introduction>
				<p>
					Find the general solution to the LHCC equation
					<me> y''' - 6y'' + 11y' - 6y = 0 </me>
					by using the factoring tool to find the characteristic roots.
				</p>
			</introduction>
			
			<p>
				<webwork xml:id="hgh">
					<pg-code>
						Context("ImplicitEquation");
						Context()->variables->{namePattern} = qr/[a-z][a-z0-9_]*'*/i;
						Context()->variables->add( t=>'Real', c1=>'Real', c2=>'Real', c3=>'Real');

						$roots = List("1, 2, 3");
						$genSoln = Formula("c1*e^(t) + c2*e^(2*t) + c3*e^(3*t)")->reduce();
					</pg-code>

					<statement>
						<p>
							Characteristic Roots: <m>r = </m> <var name="$roots" width="25" />
						</p>
						<p>
							General Solution: <m>y(t) = </m> <var name="$genSoln" width="25" />
						</p>
						<p>
							<em>Use <c>c1</c>, <c>c2</c>, <c>c3</c> as the arbitrary constants of integration.</em>
						</p>
					</statement>
				</webwork>

				<solution>
					<p>
						First, write down the characteristic equation:
						<md>
							<mrow> r^3 - 6r^2 + 11r - 6 = 0 </mrow>
						</md>.
						Plugging this into to the factoring tool shows that it factors as <m> (r-3)(r-2)(r-1) </m>.	Solving for <m>r</m>, we get
						<md>
							<mrow> r = 1, \quad r = 2, \quad r = 3 </mrow>
						</md>.
						Therefore, the general solution is:
						<me> y = c_1 e^{x} + c_2 e^{2x} + c_3 e^{3x} </me>.
					</p>
				</solution>
			</p>
		</exercise>
	</paragraphs>

	<paragraphs label="technology-approximating">
		<title>Using Technology: Approximating Roots</title>
		<p>
			Some characteristic equations are too messy to factor, even with software. When this happens, a numerical root finder can provide decimal approximations of the roots, allowing us to write down the structure of the general solution.
		</p>

		<p>
			Consider the fifth-order LHCC equation:
			<me>
				y^{(5)} - 4y''' + 3y'' - y = 0
			</me>
		</p>

		<p>
			The characteristic equation is:
			<me>
				r^5 - 4r^3 + 3r^2 - 1 = 0
			</me>
			This polynomial has no obvious factoring pattern, and standard techniques fail. Fortunately, numerical approximation tools can help.
		</p>

		<p>
			Try entering <c>r^5 - 4*r^3 + 3*r^2 - 1</c> into the same factoring tool above. You should get the following approximations for three real roots:
		</p>

		<me>
			r_1 \approx -2.29, \quad r_2 \approx -0.46, \quad r_3 \approx 1.52
		</me>

		<p>
			and the complex pair:
		</p>

		<me>
			r_4 \approx 0.61 + 0.5i, \quad r_5 \approx 0.61 - 0.5i
		</me>

		<p>
			using the standard root-to-solution rules, the general solution is: 
		</p>

		<me>
			y = c_1 e^{-2.29x} + c_2 e^{-0.46x} + c_3 e^{1.52x} + e^{0.61x} \left(c_4 \cos(0.5x) + c_5 \sin(0.5x)\right)
		</me>

		<exercise label="rq-solving-high-order-lhccs-5">
			<title><e component="emoji">üìñ‚ùì</e>  Decimal Roots in the General Solution</title>
			<statement>
				<p>
				Suppose you find the characteristic roots are approximately
				<me>r \approx -2.7,\quad 0.8,\quad 0.8 + 2i,\quad 0.8 - 2i</me>.
				</p>
				<p>
				Which of the following best describes the general solution?
				</p>
			</statement>
			<choices randomize="yes">
				<choice correct="yes">
				<statement>
					<m>\quad y = c_1 e^{-2.7x} + c_2 e^{0.8x} + e^{0.8x}(c_3 \cos(2x) + c_4 \sin(2x))</m>
				</statement>
				<feedback>
					Correct! The real root gives a standalone exponential, and the complex pair contributes an oscillatory term with the same <m>\alpha</m>.
				</feedback>
				</choice>
				<choice>
				<statement>
					<m>\quad y = c_1 e^{-2.7x} + c_2 e^{0.8x} + c_3 \cos(2x) + c_4 \sin(2x)</m>
				</statement>
				<feedback>
					Incorrect. The sine and cosine must be multiplied by <m>e^{0.8x}</m>.
				</feedback>
				</choice>
				<choice>
				<statement>
					<m>\quad y = c_1 e^{-2.7x} + c_2 x e^{0.8x} + c_3 x^2 e^{0.8x}</m>
				</statement>
				<feedback>
					Incorrect. This would be appropriate if <m>r = 0.8</m> were a triple root.
				</feedback>
				</choice>
				<choice>
				<statement>
					<m>\quad y = c_1 e^{-2.7x} + c_2 e^{0.8x} + c_3 e^{-0.8x} + c_4 e^{2ix}</m>
				</statement>
				<feedback>
					This mixes formats and includes a non-real exponential.
				</feedback>
				</choice>
			</choices>
		</exercise>

		<p>
			Regardless of the method you choose to find the roots, the general solution is relatively easy to construct once you have them.
		</p>
	</paragraphs>

</section>