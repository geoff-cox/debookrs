<section><title> Slope Fields </title>
    <introduction>
		<p>
            Very few differential equations come with neat, closed-form solutions. Fortunately, we can still understand what those solutions look like by focusing on <em>how</em> they change instead of <em>what</em> they equal. A <term>slope field</term> turns the right-hand side of a first-order equation into a picture that every solution curve must follow.
        </p>

		<p>
        	A slope field is a visual representation of the slopes that a solution curve must follow at each point in the plane. It's like a map of tiny arrows (or line segments) that show the direction a solution would travel through each point. The pattern formed by these segments gives us a picture of the <em>family of solutions</em> to the differential equation.
        </p>
    </introduction>

	<paragraphs><title> From Equation to Slope </title>
		<p>
			Since every first order differential equation consists of some arrangement of <m>t</m>, <m>y</m>, or <m>y'</m>, we can move everything to one side of the equation and represent the equation as:
			<me>
				f(t, y, y') = 0,
			</me>
			where <m>f</m> is a single function containing everything we moved over. Here is an example of such a rearrangement:
			<me>
				y' - ty = 2 - t^2 \quad \Rightarrow \quad
				\ub{y' - ty - 2 + t^2}_{\large f(t, y, y')} = 0.
			</me>
		</p>

		<p>
			When it is possible to put just <m>y'</m> on one side and everything else on the other, we write:
			<men xml:id="slope-machine-eqn1">
				y' = f(t, y).
			</men>
		</p>

		<p>
			Equations of this form have a very special property since we can think of the function <m>f(t,y)</m> as a function that takes two variables, <m>t</m> and <m>y</m>, and returns a single number. For example, when <m> t = 3 </m> and <m> y = 5 </m>,
			<me>
				y'(3) = f(3, 5) = \text{some number}.
			</me>
		</p>

		<p>
			Calculus teaches you that <m>y'(3)</m> is the slope of the tangent line of <m>y</m> at <m>t=3</m>. So this number gives the exact direction the graph of <m>y</m> is moving when it passes through <m>(3,5)</m>.
		</p>

		<example><title> Quick Slope Check </title>
            <statement>
                <p>
                    For
                    <me>
                        y' - ty = 2 - t^2,
                    </me>
                    find the slope at <m>(t,y)=(-1,6)</m>.
                </p>
            </statement>
            <solution>
                <p>
                    Rearranging gives <me>y' = ty + 2 - t^2</me>, so <m>f(t,y)=ty+2-t^2</m>.  Substitute:
                </p>
                <me>
                    f(-1,6) = (-1)(6)+2-(-1)^2 = -5.
                </me>
                <p>
                    Any solution that passes through <m>(-1,6)</m> leaves that point with slope <m>-5</m>.
                </p>
            </solution>
        </example>

		<p>
			Here, <m>f(t,y)</m> acts as a <em>slope generator</em> that takes in a <m>(t, y)</m> point in the <m>ty</m>-plane and outputs the slope of the solution, <m>y(t)</m>, as it passes through this point.
		</p>
	</paragraphs>

	<paragraphs><title> Sketching a Slope Field  </title>
		<p>
			Thinking of a first-order differential equation as a slope generator gives us a powerful way to visualize its solutions. Consider the general form:
		</p>

		        <p>
            To draw a slope field by hand:
        </p>
        <ol>
            <li>Choose a small grid of points in the <m>(t,y)</m>-plane.</li>
            <li>Compute <m>f(t,y)</m> at each point.</li>
            <li>Draw a short line segment centered at the point with that slope.</li>
        </ol>

		        <p>
            Take the equation
        </p>

		<me>
			\frac{dy}{dt} = f(t, y).
		</me>

		        <me>
            \frac{dy}{dt} = y - t.
        </me>

		<p>
			Using the function <m>f(t, y)</m>, we can construct a slope field. This involves selecting various points in the <m>(t, y)</m>-plane and computing the value of <m>f(t, y)</m> at each one. At each point, we draw a short line segment (a "tangent segment") with that slope. These tangential segment collectively form a picture that reveals the behavior of the solution curves (see Figure ?).
		</p>

		        <p>
            Computing nine slopes on a <m>3\times3</m> grid yields:
        </p>

		<p>
			For example, consider the differential equation
		</p>

		        <table>
            <tabular>
                <row><cell>(t,y)</cell><cell>f(t,y)</cell></row>
                <row><cell>(−1, −1)</cell><cell>0</cell></row>
                <row><cell>(−1, 0)</cell><cell>1</cell></row>
                <row><cell>(−1, 1)</cell><cell>2</cell></row>
                <row><cell>(0, −1)</cell><cell>1</cell></row>
                <row><cell>(0, 0)</cell><cell>0</cell></row>
                <row><cell>(0, 1)</cell><cell>−1</cell></row>
                <row><cell>(1, −1)</cell><cell>−2</cell></row>
                <row><cell>(1, 0)</cell><cell>−1</cell></row>
                <row><cell>(1, 1)</cell><cell>0</cell></row>
            </tabular>
        </table>

		<me>
			\frac{dy}{dt} = y - t.
		</me>

		        <p>
            Connecting the arrows mentally (or letting a computer do it) reveals that every solution bends up-and-to-the-right for large <m>t</m> and down-and-to-the-left for small <m>t</m>.  No explicit formula was needed.
        </p>

		<p>
			Here, the slope generator is the function:
		</p>

		<me>
			f(t, y) = y - t.
		</me>

		<p>
			To practice constructing a slope field, we begin by computing <m>f(t, y)</m> at nine selected points in the <m>(t, y)</m>-plane. For instance, at the point <m>(1, -1)</m>, we find:
		</p>

		<me>
			f(1, -1) = -1 - 1 = -2.
		</me>

		<p>
			So we draw a short segment with slope <m>-2</m> centered at <m>(1, -1)</m>. The table below shows the slope values at the selected points:
		</p>

		<table>
			<tabular>
			<row><cell>Point (t, y)</cell> <cell>Slope f(t, y)</cell></row>
			<row><cell>(−1, −1)</cell> <cell>0</cell></row>
			<row><cell>(−1, 0)</cell>  <cell>1</cell></row>
			<row><cell>(−1, 1)</cell>  <cell>2</cell></row>
			<row><cell>(0, −1)</cell>  <cell>1</cell></row>
			<row><cell>(0, 0)</cell>   <cell>0</cell></row>
			<row><cell>(0, 1)</cell>   <cell>−1</cell></row>
			<row><cell>(1, −1)</cell>  <cell>−2</cell></row>
			<row><cell>(1, 0)</cell>   <cell>−1</cell></row>
			<row><cell>(1, 1)</cell>   <cell>0</cell></row>
			</tabular>
		</table>

		<p>
			Once we've calculated these slopes, we sketch short line segments with those slopes at each point. These segments should be short enough not to overlap but long enough to be clearly visible.
		</p>

		<p>
			While hand-sketching slope fields helps build intuition, it becomes tedious with more points. A computer-generated slope field provides a more complete picture. For instance, a computer can generate the slope field for <m>f(t, y) = y - t</m> by calculating slopes on a grid and drawing corresponding tangent segments.
		</p>
	</paragraphs>

	<figure>

		<image width="60%">
			<description>a direction field of slope arrows and three curves following the arrows</description>
			<sageplot>
				from sage.calculus.desolvers import desolve_rk4
				t, y = var('t, y')
				f(t, y) = y^2/2 - t
				p = plot_slope_field(f, (t,-1,5), (y,-5,10), headaxislength=3, headlength=3, axes_labels=['$t$','$y(t)$'])
				p += desolve_rk4(f,y,ics=[-1,0],ivar=t,output='plot',end_points=[-1,5],thickness=3)
				p += desolve_rk4(f,y,ics=[-1,-1],ivar=t,output='plot',end_points=[-1,5],thickness=3, color = "red")
				p += desolve_rk4(f,y,ics=[-1,0.3292],ivar=t,output='plot',end_points=[-1,5],thickness=3, color = "green")
				p
			</sageplot>
		</image>

		<caption>The direction field for <m>y' = y^2/2 - t</m></caption>

	</figure>

	<figure>
		<image width="40%">
			<latex-image>
				\begin{tikzpicture}[declare function={f(\x,\y)=\x+\y;}, scale=0.8]
					\def\xmax{3} \def\xmin{-3}
					\def\ymax{3} \def\ymin{-3}
					\def\nx{10}  \def\ny{10}
					\def\arrowscale{0.4} % length of slope arrows

					% stepsize along x-axis and y-axis
					\pgfmathsetmacro{\hx}{(\xmax-\xmin)/\nx}
					\pgfmathsetmacro{\hy}{(\ymax-\ymin)/\ny}

					% Draw grid lines
					\foreach \i in {0,...,\nx} {
						\pgfmathsetmacro{\xgrid}{\xmin + \i * \hx}
						\draw[thin, gray!50] (\xgrid, \ymin) -- (\xgrid, \ymax);
					}
					\foreach \j in {0,...,\ny} {
						\pgfmathsetmacro{\ygrid}{\ymin + \j * \hy}
						\draw[thin, gray!50] (\xmin, \ygrid) -- (\xmax, \ygrid);
					}

					% slope field: just draw a vector at each point
					\foreach \i in {0,...,\nx}
					\foreach \j in {0,...,\ny}{

						\pgfmathsetmacro{\xpt}{\xmin + \i*\hx}
						\pgfmathsetmacro{\ypt}{\ymin + \j*\hy}
						\pgfmathsetmacro{\slope}{f(\xpt,\ypt)}

						% Normalize direction vector (1, slope) to fixed length
						\pgfmathsetmacro{\len}{sqrt(1 + (\slope)^2)}
						\pgfmathsetmacro{\dx}{\arrowscale / \len}
						\pgfmathsetmacro{\dy}{\arrowscale * \slope / \len}

						\draw[teal!90, -stealth, line width=1.1pt, shift={(\xpt,\ypt)}] (0,0) -- (\dx,\dy);
					}

					% Optional solution curve
					\def\yo{1}
					\draw[magenta, thick, samples=100] 
						plot[domain=\xmin:1] (\x, {(\yo + 1)*exp(\x) - \x - 1});

					% Axes
					\draw[->, thick] (\xmin - 0.5, 0) -- (\xmax + 0.5, 0) node[right] {$t$};
					\draw[->, thick] (0, \ymin - 0.5) -- (0, \ymax + 0.5) node[above] {$y$};

					% Title
					%\node[above, font=\small\bfseries] at (current bounding box.north) 
					%	{Slope field for \quad $y' = x + y$};

				\end{tikzpicture}
			</latex-image>
		</image>
		<caption>The direction field for <m>y' = y^2/2 - t</m></caption>
	</figure>

	    <paragraphs><title> What the Picture Tells You </title>
        <p>
            A slope field carries the same information as the original equation, but in geometric form:
        </p>
        <ul>
            <li>Starting at an initial condition <m>(t_0,y_0)</m>, follow the arrows to trace the unique solution.</li>
            <li>Horizontal segments mark where <m>dy/dt=0</m>; these are potential equilibrium levels.</li>
            <li>Closely spaced, nearly parallel arrows signal regions where solutions share a common trend.</li>
        </ul>

        <p>
            In practice, software—whether a graphing calculator or a CAS—generates dense, accurate fields with a single command, freeing you to spend time interpreting rather than plotting.
        </p>
    </paragraphs>

	<paragraphs><title> A Special Case: <m>t</m>-only Dependence </title>
		<p>
			If the right-hand side of the differential equation in question is solely a function of t, or in other words, if dy/dt = f (t), the slope only affected by the value of <m>t</m> (see Figure ?). In other words, if we change the value of <m>t</m>, the slope will change, but if we change the value of <m>y</m>, the slope will not change.
		</p>

		        <p>
            If <m>f</m> depends only on <m>t</m>,
            <me>
                \frac{dy}{dt}=f(t),
            </me>
            then every horizontal line in the plane shares the same slope; moving up or down does nothing to the direction field.  Integrating recovers the solution directly:
        </p>

		<p>
			Geometrically, this means the slope segment will not change as you move up and down in the <m>y</m> direction. Thus, the slope segment at, say <m>(3, 2)</m>, will be parallel to the slope segment at <m>(3,*)</m> (<m>* = </m> anything). 
		</p>

		<p>
			A nice feature of an equation of the form
			<me>
				\frac{dy}{dt} = f(t)
			</me>
			is that it easily solved by direct integration. The solution is simply the integral of the slope generator function:
			<me>
				y(t) = \int f(t) \, dt + C,
			</me>
			where <m>C</m> is a constant of integration.
		</p>

		        <me>
            y(t)=\int f(t)\,dt + C.
        </me>

		<p>
			For example, consider the differential equation
			<me>
				\frac{dy}{dt} = 2t.
			</me>
			The slope generator function is <m>f(t) = 2t</m>, which only depends on <m>t</m>. The slope field for this equation consists of horizontal line segments with slopes determined by the value of <m>2t</m> at each point. This means that the solution curves are horizontal lines at each t-value.
		</p>

		        <p>
            For instance, when <m>dy/dt = 2t</m> the slopes increase linearly with time, and the slope field consists of equal-length, equally-spaced line segments slanting more steeply as you move right.  The analytic solution <m>y=t^2+C</m> is merely the antiderivative of the slope pattern.
        </p>
	</paragraphs>

    <conclusion><title> Wrap-Up </title>
        <p>
            A slope field turns a differential equation into a navigational chart: the arrows are the instructions every solution must obey.  By reading that chart you can predict qualitative behavior—growth, decay, equilibria, long-term trends—without ever writing down an explicit formula.  In the next section we focus on autonomous equations, whose slope fields have an extra layer of symmetry.
        </p>
    </conclusion>
</section>