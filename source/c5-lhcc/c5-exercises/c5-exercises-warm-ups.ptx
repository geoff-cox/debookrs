<exercises><title> Warm-ups &amp; Drills </title>

	<exercise>
		<p>
			Give the characteristic equation of the differential equation
			<me>
				y'' + 5y' - y = 0.
			</me>
		</p>

		<solution>
			<p>
				<me>
					r^2 + 5r - 1 = 0
				</me>
			</p>
		</solution>

	</exercise>
	
	<exercise>
	<p>
							Which of the linear differential equations have constant coefficients?
	</p>
	<statement>
			<me>
				\frac15 y^{(8)} - \sqrt{15}y' = y, 		\quad
				s'''+\pi s = \frac{7}{w}, 				\quad
				t\frac{dP}{dt} + P^2 = \sqrt{t}
			</me>
			<me>
				\frac{dg}{dx} + 3x^2 = 0, 				\quad
				\frac15 y^{(8)} - \sqrt{15}x y' = y, 	\quad
				\frac{d^2s}{dt^2} + \frac{ds}{dt} = 4s, \quad
			</me>
		</statement>
		<solution>
			<p>
				For this question, we need to make sure <em>all</em> the coefficients are constant.
			</p>
			<p>
				<me>
					\ul{3}\ y'' - \os{\text{no}}{\os{\downarrow}{\ul{2t}}}y' + \ul{1}y	= \ul{0}, 		\quad
					\frac{dg}{dx}	= -3x^2, 	\quad
					\frac{d^2s}{dt^2} + \frac{ds}{dt} - 4s = 0
				</me>.
				Only the first equation has constant coefficients.
			</p>
		</solution>

	</exercise>

	<exercise xml:id="lhcc-exercise-01">
		<statement>
			<p>
				Find any <m>r</m> values that make <m>y = e^{rx}</m> a solution to the LHCC equation
				<men xml:id="lhcc-exercise-01-eqn-01">
					y'' - 9y = 0.
				</men>
			</p>
		</statement>
		<solution>
			<p>
				Approach this as if you were verifying that <m>y = e^{rx}</m> is a solution to <xref ref="lhcc-exercise-01-eqn-01"/>. So, plug it into the equation and check if left and right-hand sides are equal.
			</p>

			<p>
				Since we need <m>y^{\prime\prime}</m>, let's compute this first.
			</p>
			<tabular>
				<row>
					<cell><m>\ds y' = e^{rx} \cdot (r) = re^{rx}</m></cell>
					<cell><em>(chain rule)</em></cell>
				</row>
				<row>
					<cell><m>\ds y'' = [re^{rx}]^{\prime} = r[e^{rx}]^{\prime}  = r(e^{rx} \cdot (r)) = r^2e^{rx}</m></cell>
					<cell><em>(chain rule)</em></cell>
				</row>
			</tabular>
			<p>
				Plugging <m>y^{\prime\prime}</m> and <m>y</m> into the left side of <xref ref="lhcc-exercise-01-eqn-01"/> gives
			</p>
			<tabular>
				<row>
					<cell><m>\ds r^2e^{rx} - 9e^{rx} = 0 </m></cell>
					<cell/>
				</row>
				<row>
					<cell><m>\ds (r^2 - 9)\ e^{rx} = 0</m></cell>
					<cell><em>(factor out <m>e^{rx}</m>)</em></cell>
				</row>
			</tabular>
			<p>
				Now, <m>y = e^{rx}</m> is only a solution if we can show LHS = RHS (<em><m>0 = 0</m> in this case</em>). It should be clear that this depends on the values of <m>r</m>. This is just an algebra problem where we must solve for <m>r</m>.
			</p>
			<tabular>
				<row>
					<cell><m>\ds r^2 - 9 = 0,</m></cell>
					<cell><m>\ds e^{rx} = 0</m></cell>
					<cell><em>(set each factor to 0)</em></cell>
				</row>
				<row>
					<cell><m>r = \pm 3,</m></cell>
					<cell>
						<em>no solution</em>
						<fn>
							Attempting to solve <m>\ds e^{rx} = 0</m> for <m>r</m> by applying <m>\ln</m> would give
							<me>
								\ds \ln(e^{rx}) = \ln(0) \, \leftarrow \text{not defined}
							</me>
						</fn>
					</cell>
					<cell/>
				</row>
			</tabular>
			<p>
				So, the only <m>r</m> values that make the LHS = RHS is <m>r = -3, 3</m>.
			</p>
		</solution>
	</exercise>

	<exercise>
		<p>
			Consider another exercise, a fourth-order LHCC equation:
			<me>  y^{(4)} - 5y'' + 4y = 0 </me>.
		</p>

		<solution>
			<p>
				The characteristic equation is:
				<md>
					<mrow> r^4 - 5r^2 + 4 = 0 </mrow>
				</md>.
				Let <m>u = r^2</m>, then we can rewrite the equation as:
				<md>
					<mrow> u^2 - 5u + 4 = 0 </mrow>
				</md>.
				Solving for <m>u</m>, we get:
				<md>
					<mrow> u = 1, \quad u = 4 </mrow>
				</md>.
				Thus, <m>r^2 = 1</m> gives <m>r = \pm 1</m>, and <m>r^2 = 4</m> gives <m>r = \pm 2</m>. The general solution is:
				<me> y = c_1 e^{x} + c_2 e^{-x} + c_3 e^{2x} + c_4 e^{-2x} </me>.
			</p>
		</solution>
	</exercise>

	<paragraphs xml:id="poly-root-solver"><title>Polynomial Factoring Calculator</title>
		<interactive xml:id="poly-root" platform="sage" width="95%" aspect="3.25:1">
			<slate surface="sage">
r = var('r')
n = 100
a = -50
b = 50
dx = (b - a)/(n-1)
partition = [a+k*dx for k in range(n)]
char_poly = r^2 - 2*r - 8
char_eqn = char_poly == 0
def get_roots(eqn, partition):
roots=list()
for i in range(n-1):
	try:
		roots.append(eqn.find_root(partition[i], partition[i+1]))
	except:
		pass
return roots

roots = get_roots(char_eqn, partition)

@interact
def _(ce = input_box(char_poly, label="	Polynomial:", type=str, width=30)):
ce_poly = sage_eval('lambda r: ' + ce)
pretty_print( html( r'Characteristic Equation: $ %s = 0 $'%latex(ce_poly(r) ) ) )
pretty_print( html( r'Roots: $ %s $'%latex(get_roots(ce_poly(r)==0, partition)) ) )
			</slate>
		</interactive>
	</paragraphs>

	<example><title> Identifying Linearity </title>

		<p>
			<statement>
		
				<p>
					Determine whether the following equations are linear:
				</p>
				<me>
					1.\quad y'' + 3y' - 5y = 0
				</me>
				<me>
					2.\quad y' + y^2 = \sin x
				</me>
				<me>
					3.\quad e^y y'' + y' = 4x
				</me>
				<me>
					1.\quad y'' + 3y' - 5y = \sin x
				</me>
				<me>
					2.\quad y' + y^2 = x
				</me>
				<me>
					3.\quad e^y y'' + y' = 4x
				</me>
			</statement>
		</p>

		<solution>
			<p>
				The first equation is linear because all terms involving <m>y</m> and its derivatives appear in the first power and are 
				not multiplied by each other. The second equation is nonlinear because of the <m>y^2</m> term. The third equation is also 
				nonlinear because <m>e^y</m> appears as a coefficient, making the equation nonlinear in <m>y</m>.
			</p>
		</solution>

		<solution>
			<p>
				The first equation is linear because all terms involving <m>y</m> and its derivatives appear in the first power 
				and are not multiplied by each other. The second equation is nonlinear because of the <m>y^2</m> term. 
				The third equation is also nonlinear because <m>e^y</m> appears as a coefficient, making the equation nonlinear in <m>y</m>.
			</p>
		</solution>
	</example>

	<example><title> Identifying Homogeneous Equations </title>

		<p>
			<statement>
				<p>
					Determine whether the following equations are homogeneous:
				</p>
				<me>
					1.\quad y'' - 4y' + 3y = 0
				</me>
				<me>
					2.\quad y'' + 2y' - y = \cos x
				</me>
				<me>
					1.\quad y'' - 4y' + 3y = 0
				</me>
				<me>
					2.\quad y'' + 2y' - y = \cos x
				</me>
				<me>
					3.\quad y''' + 5y'' - y' + 6y = 0
				</me>
				<me>
					1.\quad y'' + 2y' + y = 5x
				</me>
				<me>
					2.\quad y'' - 3y' + 4y = 0
				</me>
				<me>
					3.\quad y''' + 6y'' - 4y' + y = e^x
				</me>
				

			</statement>
		</p>

		<solution>
			<p>
				The first equation is homogeneous because the right-hand side is zero. The second equation is nonhomogeneous because the right-hand 
				side contains <m>\cos x</m>.
			</p>
		</solution>
		<solution>
			<p>
				The first and third equations are homogeneous because the right-hand side is zero, meaning that all terms involve 
				<m>y</m> and its derivatives. The second equation is not homogeneous because the right-hand side contains <m>\cos x</m>, 
				which is a function of <m>x</m> and does not depend on <m>y</m>.
			</p>
		</solution>
		<solution>
				<p>
					The first and third equations are nonhomogeneous because the right-hand sides contain nonzero functions of <m>x</m> 
					(<m>5x</m> and <m>e^x</m>, respectively). The second equation is homogeneous because the right-hand side is zero.
				</p>
			</solution>
	</example>

	<example><title> Identifying Constant Coefficients </title>

		<p>
			<statement>
				<p>
					Determine whether the following equations have constant coefficients:
				</p>
				<me>
					1.\quad y'' + 4y' - 5y = 0
				</me>
				<me>
					2.\quad x^2 y'' + 3x y' - 2y = 0
				</me>
				<me>
					1.\quad y'' + 4y' - 5y = 0
				</me>
				<me>
					2.\quad x^2 y'' + 3x y' - 2y = 0
				</me>
				<me>
					3.\quad \cos x\ y'' + 2 y' + y = 0
				</me>
				<me>
					1.\quad y'' + 2y' + y = 0
				</me>
				<me>
					2.\quad x y'' - 3 y' + 2y = 0
				</me>
				<me>
					3.\quad y''' + 4y'' - y' + x y = 0
				</me>
			</statement>
		</p>

		<solution>
			<p>
				The first equation has constant coefficients because each term's coefficient is a fixed number. The second equation does not 
				have constant coefficients because the coefficients depend on <m>x</m> (e.g., <m>x^2</m> and <m>3x</m>).
			</p>
		</solution>
		<solution>
			<p>
				The first equation has constant coefficients because each term's coefficient is a fixed number. 
				The second equation does not have constant coefficients because the coefficients <m>x^2</m> and <m>3x</m> depend on <m>x</m>. 
				The third equation also does not have constant coefficients because <m>\cos x</m> is not a constant.
			</p>
		</solution>
		<solution>
			<p>
				The first equation is an LCC equation because it is linear and has constant coefficients. 
				The second equation is not an LCC equation because the coefficient of <m>y''</m> is <m>x</m>, which is not constant. 
				The third equation is not an LCC equation because the term <m>x y</m> makes the equation nonlinear.
			</p>
		</solution>
	</example>

	<example><title> Verifying Superposition </title>

				<p>
					<statement>
						<p>
							Consider the second-order LHCC equation:
						</p>
						<men xml:id="lhcc-second-order-example">
							y'' - 3y' + 2y = 0.
						</men>

						<p>
							Suppose we have already determined that <m>y_1 = e^x</m> and <m>y_2 = e^{2x}</m> are solutions. 
							Show that their linear combination
						</p>

						<me>
							y = c_1 e^x + c_2 e^{2x}
						</me>

						<p>
							is also a solution for arbitrary constants <m>c_1</m> and <m>c_2</m>.
						</p>
					</statement>
				</p>

				<solution>
					<p>
						Differentiating <m>y</m>:
					</p>

					<md>
						<mrow> y' = c_1 e^x + 2c_2 e^{2x} </mrow>
						<mrow> y'' = c_1 e^x + 4c_2 e^{2x} </mrow>
					</md>

					<p>
						Substituting into <xref ref="lhcc-second-order-example" />:
					</p>

					<md>
						<mrow> (c_1 e^x + 4c_2 e^{2x}) - 3(c_1 e^x + 2c_2 e^{2x}) + 2(c_1 e^x + c_2 e^{2x}) = 0 </mrow>
						<mrow> c_1 e^x + 4c_2 e^{2x} - 3c_1 e^x - 6c_2 e^{2x} + 2c_1 e^x + 2c_2 e^{2x} = 0 </mrow>
						<mrow> (c_1 e^x - 3c_1 e^x + 2c_1 e^x) + (4c_2 e^{2x} - 6c_2 e^{2x} + 2c_2 e^{2x}) = 0 </mrow>
						<mrow> 0 = 0. </mrow>
					</md>

					<p>
						Since the equation holds for all values of <m>c_1</m> and <m>c_2</m>, this confirms that 
						their linear combination is also a solution.
					</p>
				</solution>
			</example>


		<example>
				<p>
					<statement>
						<p>
							Identify which of the following are LHCC equations.
						</p>
						<me>
							3y'' - 2ty' + y = 0, \qquad
							\frac{dg}{dx} + 3x^2 = 0, \qquad
							\frac{d^2s}{dt^2} + \frac{ds}{dt} = 4s
						</me>
						<me>
							3y'' - 2\tau y' + y = \tau, \qquad
							\sqrt{t} - \frac{dP}{dt} - \frac{P^2}{2} = 1, \qquad
							s''' = \frac{7s}{w}
						</me>
						<ol>
							<li> <m>y'' + 4y' + 6y = 0</m>, </li>
							<li> <m>x^2 y'' + xy' + y = \ln(x)</m>, </li>
							<li> <m>u'' + 2xu' + u = 5x</m>. </li>
						</ol>
					</statement>
				</p>
				<p>
					<solution>
						<p>
							The trick is to check if the constant term is zero and the equation has only <m>y</m> and its derivatives on the left-hand side. Let's rewrite each equation with the constant term isolated:
						</p>
						<p>
							<me>
							3y'' - 2ty' + y = {\color{BurntOrange} 0}, \quad
							\frac{dg}{dx} = {\color{BurntOrange} -3x^2}, \quad
							\frac{d^2s}{dt^2} + \frac{ds}{dt} - 4s = {\color{BurntOrange} 0}
							</me>.
						</p>
						<p>
							The first and last equations are homogeneous, but the second is not because the right-hand side is non-zero.
						</p>
					</solution>
					<solution>
						<p>
							Check if each coefficient is constant:
						</p>
						<p>
							<me>
								\os{\text{yes}}{\os{\downarrow}{\ul{3}}} y'' -
								\os{\text{no}}{\os{\downarrow}{\ul{2\tau}}}\ y' +
								\os{\text{yes}}{\os{\downarrow}{\ul{1}}} y = \tau, \quad
								\sqrt{t} -
								\os{\text{yes}}{\os{\downarrow}{\ul{1}}} \frac{dP}{dt} -
								\os{\text{yes}}{\os{\downarrow}{\ul{\frac{1}{2}}}} P^2 = 1, \quad
								\os{\text{yes}}{\os{\downarrow}{\ul{1}}} s''' =
								\os{\text{no}}{\os{\downarrow}{\ul{\frac{7}{w}}}} s
							</me>.
							The second equation has constant coefficients, while the others do not.
						</p>
					</solution>
					<solution>
						<dl>
							<li>
								<title>Equation 1:</title>
								<p>
									<dl>
										<li>Coefficient of <m>y''</m>: <m>1</m> (constant).</li>
										<li>Coefficient of <m>y'</m>: <m>4</m> (constant).</li>
										<li>Coefficient of <m>y</m>: <m>6</m> (constant).</li>
									</dl>
								</p>
							</li>
							<li>
								<title>Equation 2:</title>
								<p>
									<dl>
										<li>Coefficient of <m>y''</m>: <m>x^2</m> (variable).</li>
										<li>Coefficient of <m>y'</m>: <m>x</m> (variable).</li>
										<li>Coefficient of <m>y</m>: <m>1</m> (constant).</li>
									</dl>
								</p>
							</li>
							<li>
								<title>Equation 3:</title>
								<p>
									<dl>
										<li>Coefficient of <m>u''</m>: <m>1</m> (constant).</li>
										<li>Coefficient of <m>u'</m>: <m>2x</m> (variable).</li>
										<li>Coefficient of <m>u</m>: <m>1</m> (constant).</li>
									</dl>
								</p>
							</li>
						</dl>
					</solution>
				</p>
			</example>

</exercises>