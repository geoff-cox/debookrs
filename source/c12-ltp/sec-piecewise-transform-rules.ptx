<!-- LICENSING
  This file is part of the textbook "Exploring Differential Equations, An Interactive, Student-Centered Approach" by Geoffrey Cox.
  License: Creative Commons Attribution-ShareAlike 4.0 International (CC BY-SA 4.0)
  You are free to:
    ‚Ä¢ Share ‚Äî copy and redistribute the material in any medium or format.
    ‚Ä¢ Adapt ‚Äî remix, transform, and build upon the material for any purpose, even commercially.
  Under the following terms:
    ‚Ä¢ Attribution ‚Äî You must give appropriate credit, provide a link to the license, and indicate if changes were made.
    ‚Ä¢ ShareAlike ‚Äî If you remix, transform, or build upon the material, you must distribute your contributions under the same license.
  Full license text: https://creativecommons.org/licenses/by-sa/4.0/legalcode
  Recommended attribution: "Exploring Differential Equations" by Geoffrey Cox, licensed CC BY-SA 4.0.
-->
<section label="laplace-step-rules">
	<title>Laplace Transform Rules for Step Functions</title>

	<introduction>
		<p>
			Up to this point, you've seen how unit step functions can <q>switch</q> pieces of a function ON and OFF at the right times. But to actually use these functions in solving differential equations, we need to understand how they behave when we take their Laplace transform. 
		</p>

		<p>
			This section develops the Laplace transform rules for unit step functions:
		</p>

		<ul marker="square">
			<li><m>\lap{u_c(t)}</m> ‚Äì how to transform a single step switch.</li>
			<li><m>\lap{f(t) u_c(t)}</m> ‚Äì how to transform a function that is switched ON at <m>t=c</m>.</li>
			<li><m>\lap{f(t-c) u_c(t)}</m> ‚Äì how to transform a shifted function that starts at <m>t=c</m>.</li>
		</ul>

		<p>
			These rules are the backbone for handling piecewise functions with Laplace methods.
		</p>
	</introduction>

	<subsection label="laplace-uc">
		<title>Transform of <m>u_c(t)</m></title>

		<exercise label="prep-3-lap-uc-ftuc">
			<title><e component="emoji">üìñ‚ùì</e>  How Do Inputs Shift?</title>
			<statement correct="yes">
				<p>
					The function <m>f(t + 2)</m> is the same as <m>f(t)</m> shifted left by 2 units.
				</p>
			</statement>
			<feedback>
				<p>
					Replacing <m>t</m> with <m>t + c</m> shifts the graph to the left by <m>c</m> units. This is the opposite direction compared to <m>f(t - c)</m>.
				</p>
			</feedback>
		</exercise>
		
		<p>
			We begin with the Laplace transform of a single shifted unit step switch, <m>u_c(t)</m>. Finding its transform lays the groundwork for the more general rules that follow.
		</p>	

		<p>
			The Laplace transform of a shifted unit step function is as follows:
		</p>

		<assemblage xml:id="lap-uc">
			<title>üìú Laplace Transform of <m>u_c(t)</m></title>
			<p>
				<md>
					<mrow xml:id="lt-L9">
						\text{L}_9:\quad\lap{u_c(t)} = \frac{e^{-cs}}{s}, \qquad s \gt 0.
					</mrow>
				</md>
				<proof>
					<title>üí° Derivation of <m>\lap{u_c(t)}</m></title>
					<p>
						Start with the definition of the Laplace transform:
						<me>
							\lap{u_c(t)} = \int_{0}^{\infty} u_c(t) \, e^{-st} \, dt.
						</me>
					</p>

					<p>
						Recall that:
						<me>
							u_c(t) =
							\begin{cases}
							0, \amp t \lt c \\
							1, \amp t \ge c
							\end{cases}
						</me>
						which means the integrand is zero until <m>t=c</m> and equals <m>e^{-st}</m> afterward.
					</p>

					<p>
						That trims our integral down since:
						<me>
							\lap{u_c(t)}
							= \os{\large t\ \lt\ c}{\overline{\int_0^{c} (0)\ e^{-st}\ dt}} + \os{\large t\ \ge\ c}{\overline{\int_c^{\infty} (1)\ e^{-st}\ dt}}
							= \int_c^{\infty} e^{-st}\ dt
						</me>
					</p>

					<p>
						Evaluate the improper integral as a limit:
						<md>
							<mrow>
								\lap{u_c(t)} \amp = \lim_{b \to \infty} \int_{c}^{b} e^{-st}\ dt
							</mrow>
							<mrow>
								\amp = \lim_{b \to \infty} \left[ \frac{-1}{s} e^{-st} \right]_{c}^{b} = \lim_{b \to \infty} \left( \frac{-1}{s}\big(e^{-sb} - e^{-sc}\big) \right)
							</mrow>
						</md>
					</p>

					<p>
						As long as <m>s \gt 0</m>, the term <m>e^{-sb}</m> goes to zero as <m>b \to \infty</m>, leaving:
						<me>
							\lap{u_c(t)} = \frac{e^{-cs}}{s}.
						</me>
					</p>
				</proof>
			</p>
		</assemblage>

		<p>
			This result shows that the shifted unit step function introduces an exponential factor <m>e^{-cs}</m> in the Laplace domain. You will use it to transform terms of the form <m>k u_{c}(t)</m>, where <m>k</m> is a constant. For example,
			<me>
				\lap{6 u_3(t)} = 6\lap{u_3(t)} = \frac{6e^{-3s}}{s}
			</me>
		</p>
		
		<exercise label="chkpt-1-lap-uc">
			<title><e component="emoji">üìñ‚ùì</e> Finding the Laplace Transform of <m>u_c(t)</m></title>
			<statement>
				<p>
					What is the Laplace transform of <m>u_5(t)</m>?
				</p>
			</statement>
			<choices randomize="yes">
				<choice>
					<statement><p><m>\ds \frac{e^{-5}}{s}</m></p></statement>
					<feedback>
						<p>
							Close, but <m>s</m> is a variable in the Laplace domain, it doesn't get replaced by a number here.
						</p>
					</feedback>
				</choice>
				<choice correct="yes">
					<statement><p><m>\ds \frac{e^{-5s}}{s}</m></p></statement>
					<feedback>
						<p>
							That's the formula: <m>\lap{u_c(t)} = \frac{e^{-cs}}{s}</m>, and here <m>c = 5</m>.
						</p>
					</feedback>
				</choice>
				<choice>
					<statement><p><m>\ds \frac{1}{s + 5}</m></p></statement>
					<feedback>
						<p>
							That's the transform of <m>e^{-5t}</m>, not a step function. The exponential in <m>u_c(t)</m> appears in the numerator, not the exponent of the input.
						</p>
					</feedback>
				</choice>
				<choice>
					<statement><p><m>\ds \frac{s}{e^{-5s}}</m></p></statement>
					<feedback>
						<p>
							That's an incorrect inversion of the formula. The exponential should be in the numerator, and <m>s</m> in the denominator.
						</p>
					</feedback>
				</choice>
			</choices>
		</exercise>
	</subsection>

	<subsection label="laplace-ft-uc">
		<title>Transform of <m>f(t) u_c(t)</m></title>
		
		<p>
			The next rule provides a formula for the product of a step function and a function of <m>t</m> and will be the primary tool used when forward transforming a piecewise function. 
		</p>

		<assemblage xml:id="laplace-ft-uc">
			<title>üìú Laplace Transform of <m>f(t) u_c(t)</m></title>
			<p>
				<md>
					<mrow xml:id="lt-L10">
						\text{L}_{10}:\quad\lap{f(t) u_c(t)} = e^{-cs} \lap{f(t + c)}
					</mrow>.
				</md>
				<proof><title>üí° Derivation of <m>\lap{f(t)\ u_c(t)}</m></title>
					<p>
						Start with the Laplace transform definition:
						<me>
							\lap{f(t) u_c(t)} = \int_{0}^{\infty} f(t) u_c(t) e^{-st}\ dt.
						</me>
					</p>

					<p>
						Since <m>u_c(t) = 0</m> for <m>t \lt c</m>, the integral simplifies to:
						<me>
							\lap{f(t)\cdot u_c(t)} = \int_c^\infty f(t)\ e^{-st}\ dt.
						</me>
					</p>

					<p>
						This new integral looks a lot like the Laplace transform of <m>f(t)</m>, but it starts at <m>t = c</m> instead of <m>t = 0</m>. Luckily, we can shift the graph of <m>f(t)\ e^{-st}</m> to the left <m>c</m> units to force the integral start back at <m>t = 0</m>.
					</p>

					<p>
						Note: Shifting a function <m>c</m> units to the left means adding <m>c</m> to all of the <m>t</m> inputs:
						<me>
							\text{before shift:}\quad f(t)\ e^{-st}\qquad\text{after shift:}\quad f(t + c)\ e^{-s(t + c)}
						</me>
					</p>

					<p>
						Using this idea, leads to the desired transform:
					</p>



					<md>
						<mrow>
							\int_{c}^{\infty} f(t)\ e^{-st}\ dt 
							\amp \os{\large\DLBb \text{A}}{=} \int_{0}^{\infty} f(t + c)\ e^{-s(t + c)}\ dt
						</mrow>
						<mrow>
							\amp \os{\large\DLBb \text{B}}{=} \int_0^\infty f(t + c) \left(e^{-st} \cdot e^{-sc}\right)\ dt
						</mrow>
						<mrow>
							\amp \os{\large\DLBb \text{C}}{=} e^{-cs} \int_0^\infty f(t + c) e^{-st}\ dt
						</mrow>
						<mrow>
							\amp = e^{-cs} \lap{f(t + c)}
						</mrow>
					</md>

					<proof><title><m>\DLBb \text{A}, \text{B}, \text{C}</m> Details</title>
						<p>
							<term><m>\DLBb \text{A}\ </m></term>: Shifting <m>f(t)e^{-st}</m> to the left <m>c</m> units makes it <me>f(t + c)\ e^{-s(t + c)}</me> and starts the integral at <m>t=0</m>.
						</p>

						<p>
							<term><m>\DLBb \text{B}\ </m></term>: Exponential Property <m>e^{-s(t + c)} = e^{-st} e^{-sc}</m>
						</p>
					
						<p>
							<term><m>\DLBb \text{C}\ </m></term>: Factor out the constant, <m>e^{-sc}</m>, as we are integrating in <m>t</m>.
						</p>
					</proof>

					<p>
						Therefore,
						<me>
							\lap{f(t) \, u_c(t)} = e^{-cs} \lap{f(t + c)}.
						</me>
					</p>
				</proof>
			</p>
		</assemblage>

		<p>
			Let's try this on a few examples to see how the rule works in practice.
		</p>

		<example>
			<title>Transform of <m>(2 - t)\cdot u_3(t)</m></title>
			<statement>
				<p>
					Compute the Laplace transform of <m>(2 - t) u_3(t)</m>.
				</p>
			</statement>
			<solution><title><m>\rightarrow \lap{(2-t)\cdot u_3(t)}</m></title>
				<p>
					For this problem, we have <m>c=3</m>. So the rule becomes:
					<me>
						\lap{f(t)\cdot u_3(t)} = e^{-3s} \lap{f(t + 3)}
					</me>,
					where, in our case, <m>f(t) = 2-t</m>, so
					<me>
						f(t+3) = 2-(t+3) = -t-1
					</me>.
				</p>

				<p>
					Plugging <m>f(t)</m> and <m>f(t+3)</m> into the rule shows us that
					<me>
						\lap{(2-t)\cdot u_3(t)} = e^{-3s} \lap{-t-1}. \qquad \text{(‚≠ê)}
					</me>
				</p>

				<p>
					So all we have left to do is compute <m>\lap{-t-1}</m>:
					<me>
						\lap{-t-1} = -\lap{t}-\lap{1} = -\frac1{s^2}-\frac1{s}
					</me>
					and plug it into (‚≠ê), to complete the transform:
					<me>
						\lap{(2-t)\, u_3(t)} = -e^{-2s}\left(\frac{1 + s}{s^2}\right).
					</me>
				</p>
			</solution>
		</example>

		<exercise><title>Check Your Understanding</title>
			<task label="chkpt-1-lap-ft-uc">
				<title><e component="emoji">üìñ‚ùì</e> Apply the Rule for <m>f(t) u_c(t)</m></title>
				<statement>
					<p>
						What is the Laplace transform of <m>(t^2 - 1)\cdot u_2(t)</m>?
					</p>
				</statement>
				<choices randomize="yes">
					<choice>
						<statement><p><m>e^{-2s} \lap{t^2 - 1}</m></p></statement>
						<feedback>
							<p>
								Close, but we must shift the <em>input</em> inside the function, not leave it as <m>t</m>.
							</p>
						</feedback>
					</choice>
					<choice correct="yes">
						<statement><p><m>e^{-2s} \lap{(t + 2)^2 - 1}</m></p></statement>
						<feedback>
							<p>
								Correct. The shift rule says to replace <m>t</m> with <m>t + c</m> inside the function and multiply by <m>e^{-cs}</m>.
							</p>
						</feedback>
					</choice>
					<choice>
						<statement><p><m>e^{-2s} \lap{(t - 2)^2 - 1}</m></p></statement>
						<feedback>
							<p>
								Be careful, <m>t - 2</m> shifts the function right, but the rule calls for <m>t + 2</m> when we delay the function using <m>u_2(t)</m>.
							</p>
						</feedback>
					</choice>
					<choice>
						<statement><p><m>\lap{(t^2 - 1)\cdot u(t - 2)}</m></p></statement>
						<feedback>
							<p>
								This uses the right format, but doesn't evaluate the Laplace transform. We're looking for a formula that includes the exponential shift.
							</p>
						</feedback>
					</choice>
				</choices>
			</task>
			<task label="chkpt-ft-uc">
				<title><e component="emoji">üìñ‚ùì</e> Next Step for the <m>f(t) u_c(t)</m> Rule</title>
				<statement>
					<p>
						Suppose you want use <xref ref="lt-L10" text="custom">L<m>_{10}</m></xref> to find
						<me>\lap{15t^2 u_2(t)}</me>.  
						You note that <m>c=2</m> and update the rule as follows:
						<me>\lap{f(t)u_2(t)} = e^{-2s}\lap{f(t+2)}</me>.
						What's the best next step from here?
					</p>
				</statement>
				<choices randomize="yes">
					<choice correct="yes">
						<statement>Identify <m>f(t)</m>, find <m>f(t+2)</m>.</statement>
						<feedback>Correct ‚Äî you need <m>f(t+2)</m> to compute <m>\lap{f(t+2)}</m>.</feedback>
					</choice>
					<choice>
						<statement>Find <m>\lap{f(t)}</m>.</statement>
						<feedback>Finding <m>\lap{f(t)}</m> isn't needed for this rule.</feedback>
					</choice>
					<choice>
						<statement>Find <m>\ilap{e^{-2s}}</m>.</statement>
						<feedback>This does not help you compute <me>\lap{15t^2 u_2(t)}</me>.</feedback>
					</choice>
					<choice>
						<statement>Rewrite the rule by moving <m>e^{-2s}</m> to the denominator as <m>e^{2s}</m>.</statement>
						<feedback>You could do this, but there is a better answer.</feedback>
					</choice>
				</choices>
			</task>
		</exercise>
	</subsection>

	<subsection label="laplace-ftc-uc">
		<title>Transform of <m>f(t-c) u_c(t)</m></title>

		<p>
			Finally, we cover the last rule that will be particularly useful for inverting expressions in the Laplace domain (i.e., <xref ref="lt-step-3" text="custom">step 3</xref>) that are associated with step functions.
		</p>

		<assemblage xml:id="laplace-ftc-uc">
			<title>üìú Laplace Transform of <m>f(t-c) u_c(t)</m></title>
			<p>
				<md>
					<mrow xml:id="lt-L11">
						\text{L}_{11}:\quad\lap{f(t-c) u_c(t)} = e^{-cs} F(s), \quad\text{where}\quad F(s) = \lap{f(t)}
					</mrow>.
				</md>
				<proof>
					<title>Derivation of <m>\lap{f(t-c) u_c(t)}</m></title>

					<p>
						In terms of the definition of the Laplace transform, we want to show:
						<md>
							<mrow>
								\os{\ds\lap{f(t-c) u_c(t)}}{\os{\ds\downarrow}{\overline{\int_{0}^{\infty} f(t-c) u_c(t) e^{-st}\ dt}}}
								\amp = e^{-cs} \os{\ds \lap{f(t)}}{\os{\ds\downarrow}{\overline{\int_{0}^{\infty} f(t) e^{-st}\ dt}}}
							</mrow>
						</md>
					</p>

					<p>
						To show this, we will start with the integral on the left and show it leads to the integral on the right.
					</p>

					<md>
						<mrow>
							\int_{0}^{\infty} f(t-c) u_c(t) e^{-st}\ dt 
							\amp \os{\large\DLBb \text{A}}{=} \int_{c}^{\infty} f(t-c) e^{-st}\ dt
						</mrow>
						<mrow>
							\amp \os{\large\DLBb \text{B}}{=} \int_{0}^{\infty} f(t)\ e^{-s(t+c)}\ dt 
						</mrow>
						<mrow>
							\amp \os{\large\DLBb \text{C}}{=} e^{-cs} \int_0^\infty f(t) e^{-st} \, du
						</mrow>
					</md>

					<proof><title><m>\DLBb \text{A}, \text{B}, \text{C}</m> Details</title>
						<p>
							<term><m>\DLBb\text{A}\ </m></term>: <m>u_c(t)=0</m> on <m>[0,c)</m> makes the lower limit of the integral <m>c</m>.
						</p>

						<p>
							<term><m>\DLBb\text{B}\ </m></term>: Shifting <m>f(t-c)e^{-st}</m> to the left <m>c</m> units makes it <m>f(t)\ e^{-s(t + c)}</m> and starts the integral at <m>t=0</m>.
						</p>

						<p>
							<term><m>\DLBb\text{C}\ </m></term>: Use the exponential property <m>e^{-s(t + c)} = e^{-st} e^{-sc}</m> and factor out the constant, <m>e^{-sc}</m>, as we are integrating in <m>t</m>.
						</p>
					</proof>

					<p>
						Thus, we have shown
						<me>
							\lap{f(t-c) u_c(t)} = e^{-cs} F(s)
						</me>
						where <m>F(s) = \lap{f(t)}</m>.
					</p>
				</proof>
			</p>
		</assemblage>

		<p>
			Although you can use this for forward transforms, its main utility is for backward transforms since it only requires you to match terms that look like
			<me>e^{-cs}F(s)</me>
			where <m>F(s)</m> is one of the common Laplace transforms from the same table. We will explore later when we invert terms in the Laplace domain containing <m>e^{-cs}</m>.
		</p>

		<exercise>
			<title><e component="emoji">üìñ‚ùì</e> Identify the Shifted Input</title>
			<statement>
				<p>
					Select the expression that goes in the blank.
					<me>
						\lap{t^2 \cdot u_3(t)} = e^{-3s}\lap{<fillin characters="2" />}
					</me>
				</p>
			</statement>
			<choices randomize="yes">
			    <choice correct="yes">
					<statement><m>\ (t + 3)^2</m></statement>
					<feedback>Good! The rule requires replacing <m>t</m> with <m>t + c</m> when multiplying by <m>u_c(t)</m>.</feedback>
				</choice>
				<choice>
					<statement><m>\ t^2</m></statement>
					<feedback>Not quite ‚Äî you need to shift the input to <m>t + 3</m> because the step turns ON at <m>t=3</m>.</feedback>
				</choice>
				<choice>
					<statement><m>\ t^2 \cdot u_3(t)</m></statement>
					<feedback>Incorrect, try again.</feedback>
				</choice>
				<choice>
					<statement><m>\ t^2 \cdot (1 - u_3(t))</m></statement>
					<feedback>Incorrect, try again.</feedback>
				</choice>
			</choices>
		</exercise>

		<p>
			With these three rules, we can now transform any piecewise function both into and out of the Laplace domain. In the next section, we'll begin applying these rules to solve differential equations with piecewise forcing functions.
		</p>

		<exercise label="laplace-step-rules-cyu-bundle">
			<title><e component="emoji">ü§îüí≠</e> Laplace Transform Rules for Step Functions Reading Questions</title>

			<task label="laplace-step-rules-cyu-1">
				<title><e component="emoji">ü§îüí≠</e> Match the <m>t</m>-Domain Function</title>
				<statement>
					Which function goes into the blank?
					<me>
						\lap{<fillin characters="4" />} = e^{-2s} \left( \dfrac{1}{s^2} + \dfrac{2}{s} \right)
					</me>
				</statement>
				<choices randomize="yes">
					<choice correct="yes">
						<statement><m>\ (t + 2) \cdot u_2(t)</m></statement>
						<feedback>Yes!</feedback>
					</choice>
					<choice>
						<statement><m>(t - 2) \cdot u_2(t)</m></statement>
						<feedback>No ‚Äî try again.</feedback>
					</choice>
					<choice>
						<statement><m>t^2 \cdot u_2(t)</m></statement>
						<feedback>No ‚Äî try again.</feedback>
					</choice>
					<choice>
						<statement><m>(t + 2)^2 \cdot u_2(t)</m></statement>
						<feedback>No ‚Äî try again.</feedback>
					</choice>
				</choices>
			</task>
		</exercise>
	</subsection>

</section>