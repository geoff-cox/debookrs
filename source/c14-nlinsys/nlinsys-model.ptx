<!-- LICENSING
  This file is part of the textbook "Exploring Differential Equations, An Interactive, Student-Centered Approach" by Geoffrey Cox.
  License: Creative Commons Attribution-ShareAlike 4.0 International (CC BY-SA 4.0)
  You are free to:
    • Share — copy and redistribute the material in any medium or format.
    • Adapt — remix, transform, and build upon the material for any purpose, even commercially.
  Under the following terms:
    • Attribution — You must give appropriate credit, provide a link to the license, and indicate if changes were made.
    • ShareAlike — If you remix, transform, or build upon the material, you must distribute your contributions under the same license.
  Full license text: https://creativecommons.org/licenses/by-sa/4.0/legalcode
  Recommended attribution: "Exploring Differential Equations" by Geoffrey Cox, licensed CC BY-SA 4.0.
-->
<section label="nlinsys-modeling">
	<title>Modeling with Nonlinear Systems</title>

	<introduction>
		<p>
			Nonlinear systems exhibit behaviors impossible in linear systems: multiple equilibria, limit cycles, chaos, and extreme sensitivity to initial conditions. While harder to solve analytically, nonlinear models often capture reality more accurately than their linear approximations.
		</p>

		<p>
			In this section, we'll model an epidemic outbreak using the SIR model—a nonlinear system that reveals how diseases spread through populations and how interventions can control outbreaks.
		</p>
	</introduction>

	<subsection>
		<title>The Problem: Disease Outbreak and Control</title>

		<p>
			When an infectious disease emerges in a population, public health officials must predict its spread and evaluate intervention strategies. Will it cause an epidemic? How many will be affected? What vaccination level prevents an outbreak?
		</p>

		<p>
			The SIR (Susceptible-Infected-Recovered) model divides the population into three groups and tracks how individuals move between them.
		</p>
	</subsection>

	<subsection>
		<title>Assumptions</title>

		<ul>
			<li>The population is well-mixed (everyone has equal contact probability).</li>
			<li>Total population is constant (no births, deaths, or migration).</li>
			<li>Infection occurs through contact between susceptible and infected individuals.</li>
			<li>Recovery confers permanent immunity.</li>
			<li>The disease has a constant transmission rate and recovery rate.</li>
		</ul>
	</subsection>

	<subsection>
		<title>Building the Model</title>

		<p>
			Let:
		</p>
		<ul>
			<li><m>S(t)</m> = number of susceptible individuals</li>
			<li><m>I(t)</m> = number of infected individuals</li>
			<li><m>R(t)</m> = number of recovered individuals</li>
			<li><m>N = S + I + R</m> = total population (constant)</li>
		</ul>

		<p>
			<term>SIR Differential Equations:</term>
		</p>
		<md>
			<mrow> \frac{dS}{dt} \amp = -\frac{\beta SI}{N} </mrow>
			<mrow> \frac{dI}{dt} \amp = \frac{\beta SI}{N} - \gamma I </mrow>
			<mrow> \frac{dR}{dt} \amp = \gamma I </mrow>
		</md>

		<p>
			<term>Parameters:</term>
		</p>
		<ul>
			<li><m>\beta</m>: transmission rate (contacts per day × probability of transmission per contact)</li>
			<li><m>\gamma</m>: recovery rate (1/day), so <m>1/\gamma</m> is the average infectious period</li>
			<li><m>R_0 = \beta/\gamma</m>: basic reproduction number (average number of new infections from one infected person)</li>
		</ul>

		<p>
			<term>Key Insight:</term> An epidemic occurs (infections increase) only if <m>R_0 > 1</m> and <m>S(0)</m> is large enough.
		</p>

		<p>
			<term>Threshold Condition:</term> Infections increase when:
			<me>
				\frac{dI}{dt} > 0 \quad \Rightarrow \quad \frac{\beta S}{N} > \gamma \quad \Rightarrow \quad S > \frac{N}{R_0}
			</me>
		</p>
	</subsection>

	<subsection>
		<title>Phase Plane Analysis</title>

		<p>
			Since <m>S + I + R = N</m> is constant, we can eliminate <m>R</m> and analyze the <m>(S,I)</m> phase plane.
		</p>

		<p>
			<term>Nullclines:</term>
		</p>
		<ul>
			<li><m>\frac{dS}{dt} = 0</m> when <m>I = 0</m> or <m>S = 0</m></li>
			<li><m>\frac{dI}{dt} = 0</m> when <m>I = 0</m> or <m>S = N/R_0</m></li>
		</ul>

		<p>
			The vertical line <m>S = N/R_0</m> separates regions where <m>I</m> increases (left side, epidemic) from regions where <m>I</m> decreases (right side, no epidemic).
		</p>
	</subsection>

	<subsection>
		<title>Simulation Activity</title>

		<p>
			<term>Objective:</term> Explore epidemic dynamics and intervention strategies.
		</p>

		<p>
			<term>Scenario: Flu Outbreak in a Town</term>
		</p>

		<p>
			<term>Base Parameters:</term>
		</p>
		<ul>
			<li><m>N = 10000</m> people</li>
			<li><m>\beta = 0.5</m> /day (so <m>R_0 = 2.5</m> if <m>\gamma = 0.2</m>)</li>
			<li><m>\gamma = 0.2</m> /day (infectious period = 5 days)</li>
			<li>Initial: <m>S(0) = 9990</m>, <m>I(0) = 10</m>, <m>R(0) = 0</m></li>
		</ul>

		<p>
			<term>Part 1: Natural Progression</term>
		</p>

		<ol>
			<li>Simulate the system for 100 days.</li>
			<li>Plot <m>S(t)</m>, <m>I(t)</m>, and <m>R(t)</m> on the same graph.</li>
			<li>When does the infection peak? What is the maximum number of infected individuals?</li>
			<li>What fraction of the population is eventually infected (final <m>R</m> value)?</li>
			<li>Create a phase plane plot (<m>I</m> vs. <m>S</m>).</li>
		</ol>

		<p>
			<term>Part 2: Vaccination Campaign</term>
		</p>

		<p>
			Vaccinating a fraction <m>p</m> of the population reduces initial susceptibles: <m>S(0) = N(1-p)</m>, <m>R(0) = Np</m>.
		</p>

		<ol>
			<li>Test vaccination levels: <m>p = 0, 0.2, 0.4, 0.6, 0.8</m>.</li>
			<li>For each, simulate and record the peak infection level and final attack rate (total infected).</li>
			<li>Calculate the herd immunity threshold: <m>p_c = 1 - 1/R_0</m>. Does this match your simulations?</li>
			<li>Plot peak infections versus vaccination coverage.</li>
		</ol>

		<p>
			<term>Part 3: Social Distancing</term>
		</p>

		<p>
			Reducing contact rate decreases <m>\beta</m>. Model intervention starting at day 30:
		</p>

		<ol>
			<li>Reduce <m>\beta</m> from 0.5 to 0.3 at <m>t = 30</m>.</li>
			<li>Compare with no intervention.</li>
			<li>How much does this "flatten the curve"?</li>
			<li>What if intervention starts at day 10 instead? Day 50?</li>
		</ol>
	</subsection>

	<subsection>
		<title>Real-World Data Analysis</title>

		<p>
			<term>Objective:</term> Fit SIR model to actual outbreak data.
		</p>

		<p>
			<term>Data Sources:</term>
		</p>
		<ul>
			<li>COVID-19 data from a specific region (early outbreak phase)</li>
			<li>Historical flu pandemic data</li>
			<li>Measles outbreak in an unvaccinated community</li>
		</ul>

		<p>
			<term>Tasks:</term>
		</p>
		<ol>
			<li>Obtain cumulative case data (or infected count) over time.</li>
			<li>Estimate population size <m>N</m>.</li>
			<li>Estimate <m>\gamma</m> from known infectious period for the disease.</li>
			<li>Fit <m>\beta</m> by comparing model simulations with data (trial and error or optimization).</li>
			<li>Calculate <m>R_0</m> from fitted parameters.</li>
			<li>Plot data and model fit together.</li>
			<li>Discuss goodness of fit and model limitations.</li>
		</ol>
	</subsection>

	<subsection>
		<title>Analytical Questions</title>

		<ol>
			<li>Show that <m>\frac{d}{dt}(S+I+R) = 0</m>, confirming constant total population.</li>
			<li>Prove that <m>S(t)</m> is always decreasing (never increases). What is the physical interpretation?</li>
			<li>Derive the final size equation: <m>R_\infty = N - S_\infty</m> where <m>S_\infty</m> satisfies <m>S_\infty = S_0 e^{-R_0(R_\infty/N)}</m>.</li>
			<li>For <m>R_0 = 2.5</m>, calculate the herd immunity threshold <m>1 - 1/R_0</m>. Why is this the minimum vaccination coverage needed?</li>
			<li>How does doubling the infectious period (<m>1/\gamma</m>) affect <m>R_0</m> and outbreak dynamics?</li>
			<li>The SIR model has no equilibrium with <m>I > 0</m>. Why does this mean epidemics are transient, not sustained?</li>
		</ol>
	</subsection>

	<subsection>
		<title>Extensions: More Complex Models</title>

		<p>
			Explore variations of the SIR model:
		</p>

		<ul>
			<li><term>SEIR model:</term> Add exposed (E) compartment for latent period before infectiousness</li>
			<li><term>SIRS model:</term> Allow temporary immunity (R individuals become S again)</li>
			<li><term>Age-structured model:</term> Different transmission rates for different age groups</li>
			<li><term>Spatial model:</term> Track disease spread across connected regions</li>
			<li><term>Stochastic effects:</term> Include randomness in small populations</li>
		</ul>

		<p>
			Implement one extension and analyze how it changes predictions.
		</p>
	</subsection>

	<subsection>
		<title>Policy Analysis Activity</title>

		<p>
			You are a public health advisor. A new disease with <m>R_0 = 3</m> and 7-day infectious period emerges.
		</p>

		<ol>
			<li>What vaccination coverage is needed for herd immunity?</li>
			<li>If only 50% coverage is achievable, what contact reduction (decrease in <m>\beta</m>) is needed to compensate?</li>
			<li>Compare two strategies:
				<ul>
					<li>Strategy A: 60% vaccination, no other measures</li>
					<li>Strategy B: 40% vaccination + 30% reduction in contacts</li>
				</ul>
				Which prevents more infections?
			</li>
			<li>What is the optimal timing for interventions if they can only be sustained for 60 days?</li>
		</ol>
	</subsection>

	<subsection>
		<title>Final Report</title>

		<p>
			Submit a comprehensive report (5-6 pages) including:
		</p>

		<ol>
			<li>Derivation of the SIR model from first principles.</li>
			<li>Analysis of equilibria and phase plane structure.</li>
			<li>Derivation of the epidemic threshold and <m>R_0</m> interpretation.</li>
			<li>Simulation results for natural progression with detailed graphs.</li>
			<li>Analysis of vaccination campaign effectiveness with herd immunity calculations.</li>
			<li>Social distancing intervention results showing timing effects.</li>
			<li>Real-world data fitting with parameter estimates and discussion of fit quality.</li>
			<li>Answers to all analytical questions with complete derivations.</li>
			<li>Implementation and analysis of at least one model extension.</li>
			<li>Policy recommendations from the policy analysis activity with justifications.</li>
			<li>Critical discussion of model assumptions and limitations.</li>
			<li>Reflection on the role of mathematical modeling in public health decision-making.</li>
		</ol>
	</subsection>

	<conclusion>
		<p>
			Nonlinear systems capture phenomena that linear models cannot: thresholds, tipping points, and irreversible transitions. The SIR model demonstrates how mathematical analysis—even when exact solutions are unavailable—can guide critical decisions affecting millions of lives. Understanding <m>R_0</m>, herd immunity thresholds, and intervention timing has been crucial in managing diseases from smallpox to COVID-19. This framework extends beyond epidemiology to any system with thresholds: chemical reactions, opinion dynamics, technology adoption, financial contagion, and neural network activation. Nonlinear dynamics reveal that small changes in parameters or initial conditions can lead to dramatically different outcomes—a lesson essential for navigating complex systems in an uncertain world.
		</p>
	</conclusion>

</section>
