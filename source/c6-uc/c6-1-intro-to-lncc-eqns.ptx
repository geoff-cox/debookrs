<section xmlns:xi="http://www.w3.org/2001/XInclude"><title> Introduction to Linear Nonhomogeneous Constant Coefficient Equations </title>

	<introduction>

		<p>
			To understand why the general solution to a linear nonhomogeneous constant coefficient (LNCC) equation has two parts, we will consider the following second-order differential equation:
		</p>

		<me>
			y'' - 4y' + 3y = 9x
		</me>.

		<p>
			Let's start with the particular solution, <m>y_p</m>, which accounts for the <m>9x</m> on the right-hand side of the equation. We will then introduce the homogeneous solution, <m>y_h</m>, which accounts for the terms that cancel out when the solution is plugged into the differential equation.
		</p>
		
	</introduction>

	<subsection><title> Particular Solutions Mirror the Forcing Function </title>

	<p>
        When solving nonhomogeneous differential equations, a key observation is that the particular solution, <m>y_p</m>, often resembles the form of the nonhomogeneous term, <m>f(x)</m>, on the right-hand side of the equation. Understanding why this is the case helps us develop an efficient strategy for guessing <m>y_p</m>.
    </p>

    <p>
        Imagine you had to guess a function of <m>x</m> that satisfies the equation,
    </p>

    <me>
        y'' - 4y' + 3y = 9x
    </me>.

		<p>
			Any guess you make must have the property that
		</p>

		<me>
			(\text{guess})'' - 4(\text{guess})' + 3(\text{guess})\ \text{ simplifies to }\ 9x
		</me>. 

		<p>
			In order for these three terms to simplify to <m>9x</m>, then the guess itself must have a similar structure as <m>9x</m>. In particular, since <m>9x</m> is a linear function of <m>x</m> (i.e., a degree one polynomial), then it is reasonable that the guess is also a linear function of <m>x</m>.
		</p>

		<p>
			Let's guess that the solution is of the form <m>y = Ax + B</m> and see if we can sort out the coefficients <m>A</m> and <m>B</m>.
		</p>

		<md>
			<mrow>	(Ax + B)'' - 4(Ax + B)' + 3(Ax + B)	\amp = 9x	</mrow>
			<mrow>	0 - 4(A) + 3(Ax + B)				\amp = 9x	</mrow>
			<mrow>	3Ax - 4A + 3B						\amp = 9x	</mrow>
		</md>

		<p>
			Setting <m>A=3</m> puts a <m>9x</m> on the left side, as shown below.
		</p>

		<md>
			<mrow>	9x - 12 + 3B	\amp = 9x	</mrow>
		</md>

		<p>
			For both sides of this equation to be equal, we need <m>-12 + 3B = 0</m> or <m>B = 4</m>. Therefore, using <m>A=3</m> and <m>B=4</m> in our guess, we get the particular function,
			<me>
				y = 3x + 4
			</me>,
			which simplifies to <m>9x</m> when plugged into the differential equation.
		</p>

		<md>
			<mrow> y = 3x+4 </mrow>
			<mrow> (3x+4)'' - 4(3x+4)' + 3(3x+4) \amp = 9x </mrow>
			<mrow> 0 - 12 + 9x + 12 \amp = 9x </mrow>
			<mrow> 9x \amp = 9x \ \ ✅ </mrow>
		</md>.

		<p>
			The function, <m>y = 3x+4</m>, is the part of the general solution called the <term>particular solution</term> and it's sole purpose is to produce the <m>9x</m> on the right-hand side of the original equation.
		</p>

		<p>
			Next, we will examine how additional terms can be added to the general solution while still permitting the particular solution to account for the right-hand side of the equation.
		</p>

	</subsection>

	<subsection><title> General Solution to LNCC Equations </title>

		<p>
			Let's continue with the example from the previous section, 
		</p>

		<me>y'' - 4y' + 3y = 9x</me>. 
			
		<p>	
			We found the particular solution to be, <m>y_p = 3x + 4</m>, which accounts for the <m>9x</m> on the right-hand side. However, there are additional terms in the general solution that simplify to zero, which we must also include. This part is called the <term>homogeneous solution</term>, denoted <m>y_h</m>.
		</p>

		<p>
			In general, the terms of a general solution to an LNCC equation can be split into two parts:
		</p>

		<me>
			y = 
			{\color{BurntOrange}
			\ub{\boxed{
				\begin{array}{c}
					\text{Terms that simplify}\\
					\text{to} \ul{\text{ zero }} \text{when } y \text{ is}\\
					\text{plugged into the DE}
				\end{array}
			}}_{\Large y_h}} + 
			{\color{RoyalBlue}
			\ub{\boxed{
				\begin{array}{c}
					\text{Terms that simplify}\\
					\text{to } \ul{f(x)} \text{ when } y \text{ is}\\
					\text{plugged into the DE}
				\end{array}
			}}_{\Large y_p}}
		</me>
		
		<p>
			has a of the form <m>y = y_h + y_p</m>, where <m>y_h</m> is the solution to the homogeneous version of the equation. For the given equation, the homogeneous version is
		</p>

		<p>
			The other part of the general solution is denoted, <m>y_h</m>, and accounts for all the terms that would normally cancel out with each other and, therefore, will not effect the right-hand side. To get this part of the solution you simply solve the homogeneous version of given equation, which is
		</p>

		<me>
			y'' - 4y' + 3y = 0
		</me>.
	
		<p>
			In any nonhomogeneous differential equation, the solution should, to some extent, resemble the right-hand side and we can logically guess what function the solution should look like. Yet, hidden within the overall solution could be terms that cancel out each other, affecting only the structure without contributing directly to the right-hand side.
		</p>

		<men xml:id="lncc-example-eqn">
			y'' - 4y' + 3y = 9x
		</men>

		<p>
			To explore this, consider the following linear nonhomogeneous constant coefficient (LNCC) equation alongside its homogeneous counterpart:
		</p>

		<sidebyside widths="6% 32% 20% 27% 15%" valign="bottom">
			<p/>
			<p>
				<md>
					<mrow>	\text{Homogeneous}			</mrow>
					<mrow>	y'' - 4y' + 3y = 0			</mrow>
					<mrow>	\downarrow					</mrow>
					<mrow>	y_h = c_1e^{x} + c_2e^{3x}	</mrow>
				</md>
			</p>
			<p>
				<md>
					<mrow> \leftarrow\text{solutions}\rightarrow </mrow>
				</md>
			</p>
			<p>
				<md>
					<mrow>	\text{Nonhomogeneous}	</mrow>
					<mrow>	y'' - 4y' + 3y = 9x		</mrow>
					<mrow>	\downarrow				</mrow>
					<mrow>	y_p = 3x + 4			</mrow>
				</md>
			</p>
			<p/>
		</sidebyside>

		<p>
			Plugging <m>y_h</m> into the homogeneous equation gives
		</p>

		<mdn>
			<mrow xml:id="lncc-gen-soln-yh-eqn"> \ub{\left(c_1e^{x} + c_2e^{3x}\right)'' - 4\left(c_1e^{x} + c_2e^{3x}\right)' + 3\left(c_1e^{x} + c_2e^{3x}\right)}_{\large\text{all terms simplify to } 0} = 0</mrow>
		</mdn>,

		<p>
			and <m>y_p</m> into the nonhomogeneous equation gives
		</p>

		<mdn>
			<mrow xml:id="lncc-gen-soln-yp-eqn"> \ub{\left(3x + 4\right)'' - 4\left(3x + 4\right)' + 3\left(3x + 4\right)}_{\large\text{all terms simplify to } 9x} = 9x</mrow>
		</mdn>

		<p>
			Now, plugging <m>y_h + y_p</m> into the nonhomogeneous equation gives
		</p>

		<md>
			<mrow> \left(c_1e^{x} + c_2e^{3x} + 3x + 4\right)'' \amp - 4\left(c_1e^{x} + c_2e^{3x} + 3x + 4\right)' </mrow>
			<mrow> \amp + 3\left(c_1e^{x} + c_2e^{3x} + 3x + 4\right) = 9x </mrow>
		</md>.

		<p>
			Distributing the derivatives over <m>y_h</m> &amp; <m>y_p</m> and rearranging the terms shows
		</p>

		<md>
			<mrow> \ob{\left(c_1e^{x} + c_2e^{3x}\right)'' - 4\left(c_1e^{x} + c_2e^{3x}\right)' + 3\left(c_1e^{x} + c_2e^{3x}\right)}^{\large\text{all terms simplify to } 0 \text{ from eqn } <xref ref="lncc-gen-soln-yh-eqn"/>} \amp </mrow> 
			<mrow> + \ub{\left(3x + 4\right)'' - 4\left(3x + 4\right)' + 3\left(3x + 4\right)}_{\large\text{all terms simplify to } 9x \text{ from eqn } <xref ref="lncc-gen-soln-yp-eqn"/>} \amp = 9x </mrow> 
			<mrow> 0 + 9x \amp = 9x \ \ ✅</mrow> 
		</md>

		<p>
			This shows that both <m>y_p</m> and <m>y_p + y_h</m> are solutions to the nonhomogeneous equation <xref ref="lncc-example-eqn"/> and supports the following general fact.
		</p>
		
		<p>
			<assemblage xml:id="lncc-general-solution"><title> ✳️ LNCC General Solutions </title>
				<p>
					The linear nonhomogeneous constant coefficient (LNCC) equation
					<men xml:id="lncc-general-equation">
						a_n y^{(n)} + \cdots + a_1 y' + a_0 y = f(x)
					</men>
					has a solution with a <term>homogeneous</term> and <term>particular</term> part given by
					<men xml:id="lncc-general-solution-form">
						y = y_h + y_p
					</men>.
					where <m>y_h</m>, found by solving the LHCC equation
					<me>
						a_n y^{(n)} + \cdots + a_2 y'' + a_1 y' + a_0 y = 0
					</me>.
				</p>
				
				<p>
					Here, <m>y_h</m> contains the terms of the solution that cancel out, whereas, <m>y_p</m> contains the terms that simplify to <m>f(x)</m> when <xref ref="lncc-general-solution-form"/> is substituted into <xref ref="lncc-general-equation"/>.
				</p>
			</assemblage>
		</p>


		<example>
			<p>
				Find the general solution to the differential equation
				<me>
					y'' - 4y' - 12y = 3{e^{5t}}
				</me>
				given that the the particular solution is known to be <m>y_p(t) =  -\frac{3}{7}{{e}^{5t}}</m>.
			</p>
			<solution>
				<p>
					The general solution has the form:
					<me>y = y_h + y_p</me>
					Since <m>y_p</m> is given, we only need to solve the homogeneous equation:
					<me>y'' - 4y' - 12y = 0</me>
					Using the characteristic equation:
					<md>
						<mrow> r^2 - 4r - 12 	=\amp\ 0											</mrow>
						<mrow> (r - 6)(r + 2) 	=\amp\ 0 \quad \Rightarrow \quad r_1 = 6, r_2 = -2	</mrow>
					</md>
					The homogeneous solution is:
					<me> y_h(t) = c_1e^{-2t} + c_2e^{6t} </me>
					Therefore, the general solution is:
					<me> y = c_1e^{-2t} + c_2e^{6t} -\frac{3}{7}{e^{5t}} </me>
				</p>
			</solution>
		</example>

		<p>
			Before we can tackle solving these equations from scratch, we need a strategy for finding the particular solution <m>y_p</m>, which will be covered in the upcoming sections.
		</p>

		<!-- <xi:include href="./p3-c2-s2-interactives.ptx" /> -->

	</subsection>

</section>