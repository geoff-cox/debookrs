<section xmlns:xi="http://www.w3.org/2001/XInclude"><title> Introduction to Linear Nonhomogeneous Constant Coefficient Equations </title>

	<introduction>

		<p>
			To understand why the general solution to a linear nonhomogeneous constant coefficient (LNCC) equation has two parts, we will consider the following second-order differential equation:
		</p>

		<me>
			y'' - 4y' + 3y = 9x
		</me>.

		<p>
			Let's start with the particular solution, <m>y_p</m>, which accounts for the <m>9x</m> on the right-hand side of the equation. We will then introduce the homogeneous solution, <m>y_h</m>, which accounts for the terms that cancel out when the solution is plugged into the differential equation.
		</p>
		
	</introduction>

	<subsection><title> Why Particular Solutions Mirror the Forcing Function </title>

		<p>
			When solving nonhomogeneous differential equations, a key observation is that the particular solution, <m>y_p</m>, often resembles the form of the nonhomogeneous term, <m>f(x)</m>, on the right-hand side of the equation. Understanding why this is the case helps us develop an efficient strategy for guessing <m>y_p</m>.
		</p>

		<p>
			Imagine you had to guess a function of <m>x</m> that satisfies the equation,
		</p>

		<me>
			y'' - 4y' + 3y = 9x
		</me>.

		<p>
			Any guess you make must have the property that
		</p>

		<me>
			(\text{guess})'' - 4(\text{guess})' + 3(\text{guess})\ \text{ simplifies to }\ 9x
		</me>.

		<p>
			For these terms to simplify to <m>9x</m>, the guess itself must have a similar structure as <m>9x</m>. Since the right-hand side is a degree-one polynomial, differentiation will never introduce higher-degree terms. Thus, it makes sense to guess a polynomial of the same degree.
		</p>

		<p>
			Let's guess that the solution is of the form <m>y = Ax + B</m> and see if we can determine the coefficients <m>A</m> and <m>B</m>.
		</p>

		<md>
			<mrow>	(Ax + B)'' - 4(Ax + B)' + 3(Ax + B)	\amp = 9x	</mrow>
			<mrow>	0 - 4(A) + 3(Ax + B)				\amp = 9x	</mrow>
			<mrow>	3Ax - 4A + 3B						\amp = 9x	</mrow>
		</md>

		<p>
			To ensure that the left-hand side contains a term that matches <m>9x</m>, we set <m>A=3</m>, leading to:
		</p>

		<md>
			<mrow>	9x - 12 + 3B	\amp = 9x	</mrow>
		</md>

		<p>
			For both sides of this equation to be equal, we need <m>-12 + 3B = 0</m>, which gives <m>B = 4</m>. Thus, using these values in our guess, we obtain the particular solution:
			<me>
				y = 3x + 4
			</me>,
			which simplifies to <m>9x</m> when plugged into the equation, shown below.
		</p>

		<md>
			<mrow>	y = 3x+4: \quad (3x+4)'' - 4(3x+4)' + 3(3x+4)	\amp = 9x		  </mrow>
			<mrow>	0 - 12 + 9x + 12								\amp = 9x		  </mrow>
			<mrow>	9x												\amp = 9x \ \ ✅	</mrow>
		</md>.

		<p>
			The function <m>y = 3x+4</m> is the part of the general solution called the <term>particular solution</term>, whose sole purpose is to produce the <m>9x</m> on the right-hand side of the original equation.
		</p>

		<p>
			Next, we will explore the other part of the general solution that has no impact on the right-hand side of the equation.
		</p>

	</subsection>

	<subsection><title> General Solution to LNCC Equations </title>

		<p>
			In the previous subsection, we determined that the linear nonhomogeneous constant coefficient (LNCC) equation
		</p>

		<men xml:id="lncc-example-eqn">
			y'' - 4y' + 3y = 9x
		</men>

		<p>
			has the particular solution <m>y_p = 3x + 4</m>. This function is special because, when substituted for <m>y</m>, it ensures that the left-hand side simplifies to <m>9x</m>, thus satisfying the equation. However, this <m>y_p</m> does not include possible terms that naturally cancel out when substituted into the left-hand side. In particular, it does not include the exponential terms that arise from solving the homogeneous equation:
		</p>

		<me>
			y'' - 4y' + 3y = 0.
		</me>

		<p>
			The solution to this equation, which we will denote <m>y_h</m>, is the other part of the general solution called the <term>homogeneous</term> or <term>complementary solution</term>.
		</p>

		<p>
			The structure of the general solution is the sum of the homogeneous and particular solutions, and is summarized as follows:
		</p>

		<me>
			y = {\color{BurntOrange} y_h} + {\color{RoyalBlue} y_p} = 
			{\color{BurntOrange}
			\os{\large\text{Homogeneous Solution}}{
				\boxed{
				\begin{array}{c}
					\text{Terms of } y \text{ that }\\
					\ul{\text{cancel}} \text{ when } y \text{ is}\\
					\text{plugged into the DE}
				\end{array}}
			}} + 
			{\color{RoyalBlue}
			\os{\large\text{Particular Solution}}{
				\boxed{
				\begin{array}{c}
					\text{Terms of } y \text{ that simplify}\\
					\text{to } \ul{f(x)} \text{ when } y \text{ is}\\
					\text{plugged into the DE}
				\end{array}}
			}}
		</me>

		<p>
			Let's see how this idea works in the context of equation <xref ref="lncc-example-eqn"/>.
		</p>

		<sidebyside widths="10% 35% 10% 35% 10%" valign="bottom">
			<p/>
			<p>
				<md>
					<mrow>	\text{Homogeneous Solution}			</mrow>
					<mrow>	y'' - 4y' + 3y = 0			</mrow>
					<mrow>	\downarrow					</mrow>
					<mrow>	y_h = c_1e^{x} + c_2e^{3x}	</mrow>
				</md>
			</p>
			<p/>
			<p>
				<md>
					<mrow>	\text{Particular Solution}	</mrow>
					<mrow>	y'' - 4y' + 3y = 9x		</mrow>
					<mrow>	\downarrow				</mrow>
					<mrow>	y_p = 3x + 4			</mrow>
				</md>
			</p>
			<p/>
		</sidebyside>

		<p>
			Plugging <m>y_h</m> into the homogeneous equation gives
		</p>

		<mdn>
			<mrow xml:id="lncc-gen-soln-yh-eqn"> \ub{\left(c_1e^{x} + c_2e^{3x}\right)'' - 4\left(c_1e^{x} + c_2e^{3x}\right)' + 3\left(c_1e^{x} + c_2e^{3x}\right)}_{\large\text{all terms simplify to } 0} = 0</mrow>
		</mdn>,

		<p>
			and <m>y_p</m> into the nonhomogeneous equation gives
		</p>

		<mdn>
			<mrow xml:id="lncc-gen-soln-yp-eqn"> \ub{\left(3x + 4\right)'' - 4\left(3x + 4\right)' + 3\left(3x + 4\right)}_{\large\text{all terms simplify to } 9x} = 9x</mrow>
		</mdn>

		<p>
			Now, plugging <m>y_h + y_p</m> into the nonhomogeneous equation gives
		</p>

		<md>
			<mrow> \left(c_1e^{x} + c_2e^{3x} + 3x + 4\right)'' \amp - 4\left(c_1e^{x} + c_2e^{3x} + 3x + 4\right)' </mrow>
			<mrow> \amp + 3\left(c_1e^{x} + c_2e^{3x} + 3x + 4\right) = 9x </mrow>
		</md>.

		<p>
			Distributing the derivatives over <m>y_h</m> &amp; <m>y_p</m> and rearranging the terms shows
		</p>

		<md>
			<mrow> \ob{\left(c_1e^{x} + c_2e^{3x}\right)'' - 4\left(c_1e^{x} + c_2e^{3x}\right)' + 3\left(c_1e^{x} + c_2e^{3x}\right)}^{\large\text{all terms simplify to } 0 \text{ from eqn } <xref ref="lncc-gen-soln-yh-eqn"/>} \amp </mrow> 
			<mrow> + \ub{\left(3x + 4\right)'' - 4\left(3x + 4\right)' + 3\left(3x + 4\right)}_{\large\text{all terms simplify to } 9x \text{ from eqn } <xref ref="lncc-gen-soln-yp-eqn"/>} \amp = 9x </mrow> 
			<mrow> 0 + 9x \amp = 9x \ \ ✅</mrow> 
		</md>

		<p>
			This example confirms that while <m>y_p</m> produces <m>f(x)</m>, the full general solution requires the addition of <m>y_h</m> to include all possible solutions to the differential equation. It also supports the following concept about the structure of general solutions to LNCC equations.
		</p> 

		<p>
			<assemblage xml:id="lncc-general-solution"><title> ✳️ LNCC General Solutions </title>
				<p>
					The linear nonhomogeneous constant coefficient (LNCC) equation	
					<men xml:id="lncc-general-equation">
						a_n y^{(n)} + \cdots + a_1 y' + a_0 y = f(x)
					</men>
					has a two part general solution of the form
					<men xml:id="lncc-general-solution-form">
						y = y_h + y_p
					</men>
					where <m>y_p</m> is the <term>particular solution</term> that yields <m>f(x)</m> when plugged into <xref ref="lncc-general-equation"/> and <m>y_h</m> is the <term>homogeneous solution</term>, found by solving the equation
					<me>
						a_n y^{(n)} + \cdots + a_2 y'' + a_1 y' + a_0 y = 0
					</me>.
				</p>
			</assemblage>
		</p>

		<p>
			Here's a quick example to help solidify this concept.
		</p>

		<example><title> Finding the general solution, given <m>y_p</m> </title>
			<p>
				<statement>
					<p>
						Find the general solution to the differential equation
						<me>
							y'' - 4y' - 12y = 3{e^{5t}}
						</me>
						given that the the particular solution is known to be <m>y_p(t) =  -\frac{3}{7}{{e}^{5t}}</m>.
					</p>
				</statement>
			</p>
			<solution>
				<p>
					The general solution has the form:
				</p>

				<me>
					y = y_h + y_p
				</me>

				<p>
					Since <m>y_p</m> is given, we only need to solve the homogeneous equation:
				</p>

				<me>
					y'' - 4y' - 12y = 0
				</me>

				<p>
					Using the characteristic equation:
				</p>

				<md>
					<mrow> r^2 - 4r - 12 	=\amp\ 0											</mrow>
					<mrow> (r - 6)(r + 2) 	=\amp\ 0 \quad \Rightarrow \quad r_1 = 6, r_2 = -2	</mrow>
				</md>

				<p>
					The homogeneous solution is:
				</p>

				<me>
					y_h(t) = c_1e^{-2t} + c_2e^{6t}
				</me>

				<p>
					Therefore, the general solution is:
				</p>

				<me>
					y(t) = \ub{c_1e^{-2t} + c_2e^{6t}\vphantom{\frac{3}{7}}}_{\Large y_h}\ \ub{-\frac{3}{7}{e^{5t}}}_{\Large y_p}
				</me>
			</solution>
		</example>

		<!-- <xi:include href="./p3-c2-s2-interactives.ptx" /> -->

		<conclusion>
			 <p>
				Now that we understand the structure of the general solution, the next section will introduce methods for systematically determining <m>y_p</m> based on different forms of <m>f(x)</m>.
			</p>
		</conclusion>

	</subsection>

</section>