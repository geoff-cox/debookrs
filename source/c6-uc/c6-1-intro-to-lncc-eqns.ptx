<section xmlns:xi="http://www.w3.org/2001/XInclude"><title> Introduction to Linear Nonhomogeneous Constant Coefficient Equations </title>

	<introduction>

		<p>
			To understand why the general solution to a linear nonhomogeneous constant coefficient (LNCC) equation has two parts, we will consider the following second-order differential equation:
		</p>

		<me>
			y'' - 4y' + 3y = 9x
		</me>.

		<p>
			Let's start with the particular solution, <m>y_p</m>, which accounts for the <m>9x</m> on the right-hand side of the equation. We will then introduce the homogeneous solution, <m>y_h</m>, which accounts for the terms that cancel out when the solution is plugged into the differential equation.
		</p>
		
	</introduction>

	<subsection><title>  Why the Particular Solution Resembles the Forcing Function </title>

		<p>
			When solving nonhomogeneous differential equations, a key observation is that the particular solution, <m>y_p</m>, often resembles the forcing function, <m>f(x)</m>, on the right-hand side of the equation. Understanding why this is the case helps us develop an effective strategy for guessing <m>y_p</m>.
		</p>

		<p>
			Imagine you had to guess a function of <m>x</m> that satisfies the equation,
		</p>

		<me>
			y'' - 4y' + 3y = 9x
		</me>.

		<p>
			For a guess to satisfy the equation, it must have the property that
		</p>

		<me>
			\ub{(\text{guess})'' - 4(\text{guess})' + 3(\text{guess})}_{\Largeüíé}\ \text{ simplifies to }\ 9x
		</me>,

		<p>
			so that you end up with <m>9x=9x</m> when you verify the solution. Therefore, the <q>guess</q> itself must have a similar structure to <m>9x</m>. 
		</p>

		<p>
			Note that guesses of the form <m>e^{rx}</m>, <m>\cos(rx)</m>, or <m>\ln(rx)</m> could never work since üíé would never lead to <m>9x</m>. However, <m>x^r</m> might work. 
		</p>

		<p>
			Since differentiation reduces the degree of <m>x^r</m> terms by one, <m>3(\text{guess})</m> will always have the largest power. Because we want üíé to produce <m>9x</m>, then <m>3(\text{guess})</m> can have no term with a power greater than <m>1</m>. This reasoning leaves us with a guess that must be of the form <m>Ax + B</m>.
		</p>

		<p>
			Let's try plugging our guess in to see if we can figure out <m>A</m> and <m>B</m>.
		</p>

		<md>
			<mrow>	(Ax + B)'' - 4(Ax + B)' + 3(Ax + B)	\amp = 9x	</mrow>
			<mrow>	0 - 4(A) + 3(Ax + B)				\amp = 9x	</mrow>
			<mrow>	\ub{3Ax - 4A + 3B}_{\Large ‚≠ê}	   \amp = 9x  </mrow>
		</md>

		<p>
			To ensure that ‚≠ê becomes <m>9x</m>, we set <m>A=3</m>, leading to:
		</p>

		<me>
			3(3)x - 4(3) + 3B = 9x \quad \implies \quad \ub{9x - 12 + 3B}_{\Large üå∏} = 9x
		</me>

		<p>
			Now, for üå∏ to be <m>9x</m>, we need <m>-12 + 3B = 0</m>, which gives <m>B = 4</m>. Thus, with the values of <m>A</m> and <m>B</m> in hand, our guess becomes 
		</p>

		<me>
			3x + 4
		</me>.

		<p>
			This function is called the <term>particular solution</term>, denoted <m>y_p</m>, and it <em>represents the precise function needed for the left side of the equation to match the forcing function on the right</em>. At the risk of beating a dead horse, let's comfirm this important statement by plugging <m>y_p = 3x+4</m> into the differential equation. 
		</p>

		<md>
			<mrow>
				(3x+4)'' - 4(3x+4)' + 3(3x+4)
					\amp = 9x
			</mrow>
			<mrow>
				0 - 12 + 9x + 12
					\amp = 9x
			</mrow>
			<mrow>
				{\color{RoyalBlue}\text{all terms simplify to }\ \rightarrow}\quad 9x
					\amp = 9x\quad {\color{RoyalBlue}\leftarrow\ \text{forcing function}}
			</mrow>
		</md>

		<p>
			Now that we have identified the particular solution, <m>y_p</m> as the part of the general solution responsible for producing the forcing function, it is time to discuss the more <q>hidden</q> part of the general solution, whose terms just cancel out on the left side of the equation. 
		</p>

		<xi:include href="./c6-exercises/c6-chkpts-1-1-particular-solns.ptx" />

	</subsection>

	<subsection><title> General Solution to LNCC Equations </title>

		<p>
			In the previous subsection, we determined that equation
		</p>

		<men xml:id="lncc-example-eqn">
			\ub{y'' - 4y' + 3y}_{\Large üçÑ} = 9x
		</men>

		<p>
			has the particular solution <m>y_p = 3x + 4</m>. This function is special because it is what you plug in for <m>y</m> to ensure that üçÑ becomes <m>9x</m>.
		</p>

		<p>
			However, there are more terms that naturally cancel out when plugged into üçÑ. When you combine these vanishing terms with the particular solution, your solution still produces <m>9x</m>, but, now your solution is more general since it accounts for a larger number of possible solutions.
		</p>

		<p>
			Since you want the terms to cancel out, the terms you are looking for are the ones that make üçÑ simplify to <m>0</m>. To find them we simply solve
		</p>

		<me>
			y'' - 4y' + 3y = 0
		</me>,

		<p>
			which is the the homogeneous version of <xref ref="lncc-example-eqn"/>. We call the solution this equation the <term>homogeneous</term> or <term>complementary solution</term>, and denote it <m>y_h</m>. In this case,
		</p>

		<me>
			y_h = c_1e^{x} + c_2e^{3x}
		</me>.

		<p>
			The combination of the homogeneous and particular solutions form the general solution, which is structured as follows:
		</p>

		<me>
			y = {\color{BurntOrange} y_h} + {\color{RoyalBlue} y_p} = 
			{\color{BurntOrange}
			\os{\large\text{Homogeneous Solution}}{
				\boxed{
				\begin{array}{c}
					\text{Accounts for the terms of}\\
					\text{the solution} \text{ that } \ul{\text{cancel out}} \\
					\text{ when } \text{plugged into the DE}
				\end{array}}
			}} + 
			{\color{RoyalBlue}
			\os{\large\text{Particular Solution}}{
				\boxed{
				\begin{array}{c}
					\text{Accounts for the terms of the}\\
					\text{solution} \text{ that simplify to } \ul{f(x)}\\
					\text{when } \text{plugged into the DE}
				\end{array}}
			}}
		</me>

		<p>
			To see how <m>y_h</m> and <m>y_p</m> behave as different parts of the same solution, let's setup the general solution as
		</p>

		<me>
			y = y_h + y_p = c_1e^{x} + c_2e^{3x} + 3x + 4
		</me>


		<!-- <sidebyside widths="10% 35% 10% 35% 10%" valign="bottom">
			<p/>
			<p>
				<md>
					<mrow>	\text{Homogeneous Solution}			</mrow>
					<mrow>	y'' - 4y' + 3y = 0			</mrow>
					<mrow>	\downarrow					</mrow>
					<mrow>	y_h = c_1e^{x} + c_2e^{3x}	</mrow>
				</md>
			</p>
			<p/>
			<p>
				<md>
					<mrow>	\text{Particular Solution}	</mrow>
					<mrow>	y'' - 4y' + 3y = 9x		</mrow>
					<mrow>	\downarrow				</mrow>
					<mrow>	y_p = 3x + 4			</mrow>
				</md>
			</p>
			<p/>
		</sidebyside>

		<p>
			Plugging <m>y_h</m> into the homogeneous equation gives
		</p>

		<mdn>
			<mrow xml:id="lncc-gen-soln-yh-eqn"> \ub{\left(c_1e^{x} + c_2e^{3x}\right)'' - 4\left(c_1e^{x} + c_2e^{3x}\right)' + 3\left(c_1e^{x} + c_2e^{3x}\right)}_{\large\text{all terms simplify to } 0} = 0</mrow>
		</mdn>,

		<p>
			and <m>y_p</m> into the nonhomogeneous equation gives
		</p>

		<mdn>
			<mrow xml:id="lncc-gen-soln-yp-eqn"> \ub{\left(3x + 4\right)'' - 4\left(3x + 4\right)' + 3\left(3x + 4\right)}_{\large\text{all terms simplify to } 9x} = 9x</mrow>
		</mdn> -->

		<p>
			and substitute it into the nonhomogeneous equation <xref ref="lncc-example-eqn"/> to get
		</p>

		<md>
			<mrow> \left(c_1e^{x} + c_2e^{3x} + 3x + 4\right)'' \amp - 4\left(c_1e^{x} + c_2e^{3x} + 3x + 4\right)' </mrow>
			<mrow> \amp + 3\left(c_1e^{x} + c_2e^{3x} + 3x + 4\right) = 9x </mrow>
		</md>.

		<p>
			Distributing the derivatives onto <m>y_h</m> &amp; <m>y_p</m> and regrouping their terms we arrive at
		</p>

		<md>
			<mrow> \ob{\left(c_1e^{x} + c_2e^{3x}\right)'' - 4\left(c_1e^{x} + c_2e^{3x}\right)' + 3\left(c_1e^{x} + c_2e^{3x}\right)}^{\Large\text{ü´ê}} \amp </mrow> 
			<mrow> +\ \ub{\left(3x + 4\right)'' - 4\left(3x + 4\right)' + 3\left(3x + 4\right)}_{\Large\text{üçÄ}} \amp = 9x </mrow> 
		</md>

		<!-- <md>
			<mrow> \ob{\left(c_1e^{x} + c_2e^{3x}\right)'' - 4\left(c_1e^{x} + c_2e^{3x}\right)' + 3\left(c_1e^{x} + c_2e^{3x}\right)}^{\large\text{all terms simplify to } 0 \text{ from eqn }} \amp </mrow> 
			<mrow> +\ \ub{\left(3x + 4\right)'' - 4\left(3x + 4\right)' + 3\left(3x + 4\right)}_{\large\text{all terms simplify to } 9x \text{ from eqn } } \amp = 9x </mrow> 
			<mrow> 0 + 9x \amp = 9x \ \ ‚úÖ</mrow> 
		</md> -->

		<p>
			First we simplify ü´ê:
		</p>

		<md>
			<mrow>	
				\text{ü´ê}:\ \left(c_1e^{x} + c_2e^{3x}\right)'' \amp - 4\left(c_1e^{x} + c_2e^{3x}\right)' + 3\left(c_1e^{x} + c_2e^{3x}\right) 
			</mrow>
			<mrow>	
						\amp = c_1e^{x} + 9c_2e^{3x} - 4\left(c_1e^{x} + 3c_2e^{3x}\right) + 3\left(c_1e^{x} + c_2e^{3x}\right)
			</mrow>
			<mrow>	
						\amp = c_1e^{x} + 9c_2e^{3x} - 4c_1e^{x} + 12c_2e^{3x} + 3c_1e^{x} + 3c_2e^{3x}
			</mrow>
			<mrow>		\amp = 0	</mrow>
		</md>

		<p>
			Then we simplify üçÄ:
		</p>

		<md>
			<mrow>	
				\text{üçÄ}:\ \left(3x + 4\right)'' - 4\left(3x + 4\right)' + 3\left(3x + 4\right) = 0 - 12 + 9x + 12 = 9x
			</mrow>
		</md>

		<p>
			Not only does this verify that <m>y=y_h+y_p</m> is a solution to <xref ref="lncc-example-eqn"/>, but it also demostrates how the <m>y_h</m> terms (in ü´ê) cancel, while the <m>y_p</m> terms (in üçå) simplify to the forcing function, <m>9x</m>. This confirmation of the different roles <m>y_h</m> and <m>y_p</m> play in the general solution supports the general result, below.
		</p>

		<p>
			<assemblage xml:id="lncc-general-solution"><title> ‚ú≥Ô∏è LNCC General Solutions </title>
				<p>
					The linear nonhomogeneous constant coefficient (LNCC) equation	
					<men xml:id="lncc-general-equation">
						a_n y^{(n)} + \cdots + a_1 y' + a_0 y = f(x)
					</men>
					has a two part general solution of the form
					<men xml:id="lncc-general-solution-form">
						y = y_h + y_p
					</men>
					where <m>y_p</m> is the <term>particular solution</term> that yields <m>f(x)</m> when plugged into <xref ref="lncc-general-equation"/> and <m>y_h</m> is the <term>homogeneous solution</term>, found by solving the equation
					<me>
						a_n y^{(n)} + \cdots + a_2 y'' + a_1 y' + a_0 y = 0
					</me>.
				</p>
			</assemblage>
		</p>

		<p>
			Here's a quick example to help solidify this concept.
		</p>

		<example><title> Finding the general solution, given <m>y_p</m> </title>
			<p>
				<statement>
					<p>
						Find the general solution to the differential equation
						<me>
							y'' - 4y' - 12y = 3{e^{5t}}
						</me>
						given that the particular solution is known to be <m>y_p(t) =  -\frac{3}{7}{{e}^{5t}}</m>.
					</p>
				</statement>
			</p>
			<solution>
				<p>
					The general solution has the form:
				</p>

				<me>
					y = y_h + y_p
				</me>

				<p>
					Since <m>y_p</m> is given, we only need to solve the homogeneous equation:
				</p>

				<me>
					y'' - 4y' - 12y = 0
				</me>

				<p>
					Using the characteristic equation:
				</p>

				<md>
					<mrow> r^2 - 4r - 12 	\amp = 0											</mrow>
					<mrow> (r - 6)(r + 2) 	\amp = 0 \quad \Rightarrow \quad r_1 = 6, r_2 = -2	</mrow>
				</md>

				<p>
					The homogeneous solution is:
				</p>

				<me>
					y_h(t) = c_1e^{-2t} + c_2e^{6t}
				</me>

				<p>
					Therefore, the general solution is:
				</p>

				<me>
					y(t) = \ub{c_1e^{-2t} + c_2e^{6t}\vphantom{\frac{3}{7}}}_{\Large y_h}\ \ub{-\frac{3}{7}{e^{5t}}}_{\Large y_p}
				</me>
			</solution>
		</example>

		<xi:include href="./c6-exercises/c6-chkpts-1-2-lncc-general-soln.ptx" />

		<p>
			While the structure of LNCC solutions is now clear, actually determining <m>y_p</m> requires a systematic approach. The next section introduces the Method of Undetermined Coefficients, a technique for efficiently constructing <m>y_p</m> when <m>f(x)</m> has a specific form.
		</p>

	</subsection>

</section>