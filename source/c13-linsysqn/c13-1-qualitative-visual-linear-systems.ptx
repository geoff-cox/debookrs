<!-- LICENSING
  This file is part of the textbook "Exploring Differential Equations, An Interactive, Student-Centered Approach" by Geoffrey Cox.
  License: Creative Commons Attribution-ShareAlike 4.0 International (CC BY-SA 4.0)
  You are free to:
    ‚Ä¢ Share ‚Äî copy and redistribute the material in any medium or format.
    ‚Ä¢ Adapt ‚Äî remix, transform, and build upon the material for any purpose, even commercially.
  Under the following terms:
    ‚Ä¢ Attribution ‚Äî You must give appropriate credit, provide a link to the license, and indicate if changes were made.
    ‚Ä¢ ShareAlike ‚Äî If you remix, transform, or build upon the material, you must distribute your contributions under the same license.
  Full license text: https://creativecommons.org/licenses/by-sa/4.0/legalcode
  Recommended attribution: "Exploring Differential Equations" by Geoffrey Cox, licensed CC BY-SA 4.0"
-->
<section xml:id="qualitative-methods-for-linear-systems">
    <title>Qualitative Methods for Linear Systems</title>

    <introduction>

    </introduction>

    <!-- ============================= -->
    <!-- SUBSECTION: Phase Plane       -->
    <!-- ============================= -->
    <subsection xml:id="phase-plane">
        <title>Phase Planes and Direction Fields</title>

        <p>
            One of the best ways to understand a system ‚Äî especially a linear one ‚Äî is to <em>see it</em>.
        </p>

        <p>
            The <em>phase plane</em> is a two-dimensional space where we plot one variable on the horizontal axis and the other on the vertical axis.  
            A solution to the system becomes a <em>trajectory</em> ‚Äî a path through the plane traced as time flows.
        </p>

        <p>
            To see the <q>push</q> of the system without fully solving it, we can draw a <em>direction field</em> (or slope field): 
            at each point <m>(x, y)</m>, we sketch a small arrow showing the vector <m>(dx/dt, dy/dt)</m>.
        </p>

        <example xml:id="ex-phase-plane">
            <title>Phase Portrait of an Uncoupled System</title>
            <statement>
                <p>
                    Consider the uncoupled system:
                </p>
                <md>
                    <mrow>\frac{dx}{dt} \amp = -x</mrow>
                    <mrow>\frac{dy}{dt} \amp = -2y</mrow>
                </md>
                <p>
                    In the phase plane, every trajectory moves straight toward the origin ‚Äî 
                    <m>x</m> and <m>y</m> are simply decaying independently, so the arrows point inward along both axes.
                </p>
            </statement>
        </example>

        <p>
            For more interesting systems ‚Äî like ones with partial or full coupling ‚Äî 
            the direction field can show curved paths, spirals, or saddle-shaped flows.  
            This visual approach helps us predict system behavior even before we dive into equations.
        </p>
    </subsection>

	<subsection label="visualizing-systems">
		<title>Visualization Tools</title>
		<p>
			So far, we've seen examples of systems where variables evolve independently or influence each other. Now let's step back and look at how to visualize a system as a whole.
		</p>

		<p>
			The <em>phase plane</em> is a two-dimensional space where we plot one variable on the horizontal axis and the other on the vertical axis. A solution to a system like
		</p>

		<md>
			<mrow> \frac{dx}{dt} \amp = -x </mrow>
			<mrow> \frac{dy}{dt} \amp = -2y </mrow>
		</md>

		<p>
			becomes a curve in the <m>(x, y)</m> plane: a path that the system traces over time. We often call this a <em>trajectory</em>.
		</p>

		<p>
			Instead of plotting <m>x(t)</m> and <m>y(t)</m> separately, we visualize the pair <m>(x(t), y(t))</m> moving through the plane.
		</p>

		<p>
			To understand how the system behaves without solving it, we can draw a <em>slope field</em> or <em>direction field</em>: a grid of arrows showing the direction of motion at each point.
		</p>

		<p>
			Each arrow represents the vector <m>(dx/dt, dy/dt)</m> at a point <m>(x, y)</m>. Together, they show how the system wants to evolve.
		</p>

		<example xml:id="ex-slopefield-uncoupled">
			<title>Phase Portrait of an Uncoupled System</title>
			<statement>
			<p>
				Consider the system:
			</p>
			<md>
				<mrow> \frac{dx}{dt} \amp = -x </mrow>
				<mrow> \frac{dy}{dt} \amp = -2y </mrow>
			</md>
			<p>
				The phase portrait shows straight-line motion toward the origin along both axes, because each variable decays independently.
			</p>
			</statement>
		</example>

		<p>
			In more interesting systems, like partially coupled ones, the slope field reveals how the variables influence each other.
		</p>

		<example xml:id="ex-slopefield-partial">
			<title>Phase Portrait of a Partially Coupled System</title>
			<statement>
			<p>
				For the system:
			</p>
			<md>
				<mrow> \frac{dx}{dt} \amp = -x </mrow>
				<mrow> \frac{dy}{dt} \amp = -y + 2x </mrow>
			</md>
			<p>
				The phase portrait shows <m>x(t)</m> decaying, and <m>y(t)</m> temporarily increasing in response before decaying, reflecting the one-way interaction.
			</p>
			</statement>
		</example>

		<p>
			Phase portraits help us understand the big picture: where solutions are headed, whether they spiral, diverge, or settle down.
		</p>

		<corollary><title>Euler's Method Visualized</title>
			<statement>
				<p>
					This interactive slope field shows the direction of motion for the system <m>x' = x + y</m>, <m>y' = -x + y</m>.
					Each arrow represents the vector <m>(dx/dt, dy/dt)</m> at that location.
				</p>
				<p>
					<sidebyside width="80%" margins="15% 5%">
						<interactive xml:id="phase-plane-slopefield"
							platform="jsxgraph"
							aspect="1:1"
							dark-mode-enabled="yes"
							source="code/jsxgraph/visualizing-systems/phase-plane-slopefield.js"
						>
							<slate xml:id="phase-plane-slopefield-plot1" surface="jsxboard" aspect="1:1" />
							<static>
								<image source="code/jsxgraph/img-labels/t.png" width="70%"> Need to Add </image>
							</static>
						</interactive>
					</sidebyside>
				</p>
			</statement>
		</corollary>

		<!-- <corollary><title>Euler's Method Visualized 2</title>
			<statement>
				<p>
					This interactive slope field shows the direction of motion for the system <m>x' = x + y</m>, <m>y' = -x + y</m>.
					Each arrow represents the vector <m>(dx/dt, dy/dt)</m> at that location.
				</p> -->
				<!-- <sidebyside margins="0% 0%"> -->
					<figure>
							<interactive xml:id="phase-plane-w-timeplot-6"
								platform="jsxgraph"
								aspect="2:1"
								dark-mode-enabled="yes"
								source="code/jsxgraph/visualizing-systems/phase-plane-w-timeplot-6.js"
							>
								<sidebyside widths="49% 2% 49%">
									<slate xml:id="phase-plane-w-timeplot-6-plot1" surface="jsxboard" aspect="49:50" />
									<p/>
									<slate xml:id="phase-plane-w-timeplot-6-plot2" surface="jsxboard" aspect="49:50" />
								</sidebyside>
								<static>
									<image source="code/jsxgraph/img-labels/t.png" width="100%"> Need to Add </image>
								</static>
							</interactive>
						</figure>
				<!-- </sidebyside> -->
						
			<!-- </statement>
		</corollary> -->

		<conclusion><title>üì§ Wrap-Up</title>
			<paragraphs><title>Summary</title>
			<p>
				<ul marker="square">
				<li>The phase plane shows a system's behavior as a path in the <m>(x, y)</m> plane.</li>
				<li>A slope field shows the direction of motion at each point, based on the system's right-hand sides.</li>
				<li>These tools help us understand how the variables interact, even before solving the system.</li>
				</ul>
			</p>
			</paragraphs>
		</conclusion>
	</subsection>

    <!-- ================================= -->
    <!-- SUBSECTION: Qualitative Behavior  -->
    <!-- ================================= -->
    <subsection xml:id="qualitative-behavior">
        <title>Qualitative Behavior of Systems</title>

        <p>
            Once we start looking at direction fields, patterns emerge:
        </p>

        <p>
            Some systems push every solution toward a single point (stable equilibrium).  
            Others send trajectories outward (unstable).  
            Some cause spirals, as if the solution is both rotating and growing or shrinking at the same time.
        </p>

        <p>
            Even without solving a system, we can often describe these behaviors by looking at the arrows in the phase plane:
        </p>

        <ul marker="disc">
            <li><term>Straight decay</term>: trajectories slide smoothly toward the origin.</li>
            <li><term>Saddles</term>: some trajectories are drawn in, others are pushed away.</li>
            <li><term>Spirals</term>: solutions curve inward or outward in looping paths.</li>
        </ul>

        <p>
            Later, we'll connect these patterns to the algebra of the system's coefficients.  
            But even now, these <q>big picture</q> behaviors help us think about what the math is saying.
        </p>
    </subsection>

	<!-- ================================================================ -->
	<!-- WRAP-UP + READING QUESTIONS                                      -->
	<!-- ================================================================ -->
	<subsection label="qualitative-methods-for-linear-systems-wrap-up">
		<title>üì§ Wrap-Up</title>

		<assemblage label="qualitative-methods-for-linear-systems-wrap-up-takeaways">
			<p>
				üóùÔ∏è <m>\textbf{Key Takeaways...}</m>
				<ul marker="square">
					<li>The phase plane plots <m>(x, y)</m> pairs to show the system's motion as a path in 2D space.</li>
					<li>A direction field adds arrows showing the <q>push</q> of the system at every point.</li>
					<li>These tools help us see where solutions are heading ‚Äî even before solving the system algebraically.</li>
					<li>Phase plane diagrams reveal whether a system's solutions decay, grow, or spiral.</li>
					<li>You can often tell what will happen by the shape of the arrows ‚Äî even without solving equations.</li>
					<li>These qualitative insights give us a preview of the algebra we'll learn soon.</li>
					<li>We can write a system as <m>\vec{X}' = A \vec{X}</m>, with <m>\vec{X}</m> holding all unknowns and <m>A</m> holding the coefficients.</li>
					<li>This makes systems look simpler and connects them to powerful linear algebra tools.</li>
					<li>Even before we dive into solving, vector form is the natural language for linear systems.</li>
				</ul>
			</p>
		</assemblage>
		<paragraphs label="qualitative-methods-for-linear-systems-cyu">
			<title>Check Your Understanding</title>

			<exercise label="qualitative-methods-for-linear-systems-cyu-bundle">
				<title><e component="emoji">ü§îüí≠</e> Qualitative Methods for Linear Systems Reading Questions</title>
				
				<task label="qualitative-methods-for-linear-systems-cyu-1">
					<title><e component="emoji">ü§îüí≠</e> Linear or Not?</title>
					<statement>
						<p>
							Decide whether each system is linear or nonlinear.
						</p>
					</statement>
					<choices randomize="yes">
						<choice correct="yes">
							<statement><p><m>x' = 2x + 3y, \ y' = -x + y</m></p></statement>
						</choice>
						<choice correct="no">
							<statement><p><m>x' = xy, \ y' = x - y^2</m></p></statement>
							<feedback><p>The product <m>xy</m> and the square <m>y^2</m> make this nonlinear.</p></feedback>
						</choice>
						<choice correct="yes">
							<statement><p><m>x' = -4x + y, \ y' = 5y</m></p></statement>
						</choice>
						<choice correct="no">
							<statement><p><m>x' = e^x + y, \ y' = -y</m></p></statement>
							<feedback><p>The <m>e^x</m> term makes this nonlinear.</p></feedback>
						</choice>
					</choices>
				</task>
				<task label="qualitative-methods-for-linear-systems-cyu-2">
					<title><e component="emoji">ü§îüí≠</e> Defining Features</title>
					<statement>
						<p>
							What must be true for a system to be called <em>linear</em>?
						</p>
					</statement>
					<choices randomize="yes">
						<choice correct="yes">
							<statement><p>The unknowns and their derivatives appear without products, powers, or nonlinear functions.</p></statement>
						</choice>
						<choice correct="no">
							<statement><p>All coefficients must be positive.</p></statement>
							<feedback><p>Sign of coefficients doesn't determine linearity ‚Äî their form does.</p></feedback>
						</choice>
						<choice correct="no">
							<statement><p>The system must contain exactly two equations.</p></statement>
							<feedback><p>Systems can have more than two equations and still be linear.</p></feedback>
						</choice>
					</choices>
				</task>
				<task label="qualitative-methods-for-linear-systems-cyu-3">
					<title><e component="emoji">ü§îüí≠</e> What Does the Phase Plane Show?</title>
					<statement>
						<p>
							Select all statements that describe what a phase plane diagram shows.
						</p>
					</statement>
					<choices randomize="yes">
						<choice correct="yes">
							<statement><p>The trajectory of the system as <m>(x(t), y(t))</m> moves through time.</p></statement>
						</choice>
						<choice correct="yes">
							<statement><p>The direction of motion at each point (if we draw a direction field).</p></statement>
						</choice>
						<choice correct="no">
							<statement><p>Only the values of <m>x</m> over time, ignoring <m>y</m>.</p></statement>
							<feedback><p>The phase plane shows <em>both</em> variables as a path in 2D space.</p></feedback>
						</choice>
						<choice correct="no">
							<statement><p>Exact solutions for every initial condition.</p></statement>
							<feedback><p>The phase plane shows motion qualitatively ‚Äî we don't always solve for explicit formulas.</p></feedback>
						</choice>
					</choices>
				</task>
				<task label="qualitative-methods-for-linear-systems-cyu-4">
					<title><e component="emoji">ü§îüí≠</e> Recognizing Patterns</title>
					<statement>
						<p>
							Match each description to the type of behavior it suggests.
						</p>
					</statement>
					<choices randomize="yes">
						<choice correct="yes">
							<statement><p>Trajectories loop inward toward the origin ‚Üí Spiral sink</p></statement>
						</choice>
						<choice correct="yes">
							<statement><p>Some arrows point toward the origin, others point away ‚Üí Saddle</p></statement>
						</choice>
						<choice correct="yes">
							<statement><p>All trajectories move straight toward the origin ‚Üí Stable node</p></statement>
						</choice>
						<choice correct="no">
							<statement><p>Trajectories go in circles forever ‚Üí This always means the system is nonlinear.</p></statement>
							<feedback><p>Not true ‚Äî linear systems can also produce closed loops or spirals.</p></feedback>
						</choice>
					</choices>
				</task>
				<task label="qualitative-methods-for-linear-systems-cyu-5">
					<title><e component="emoji">ü§îüí≠</e> Benefits of Vector Form</title>
					<statement>
						<p>
							Why might we rewrite a system as <m>\vec{X}' = A \vec{X}</m>?
						</p>
					</statement>
					<choices randomize="yes">
						<choice correct="yes">
							<statement><p>It organizes the system neatly as a single equation.</p></statement>
						</choice>
						<choice correct="yes">
							<statement><p>It connects the system to linear algebra tools like eigenvalues.</p></statement>
						</choice>
						<choice correct="no">
							<statement><p>It makes the system nonlinear.</p></statement>
							<feedback><p>No ‚Äî writing it in vector form doesn't change linearity.</p></feedback>
						</choice>
						<choice correct="no">
							<statement><p>It means we no longer have to think about <m>x</m> and <m>y</m> separately.</p></statement>
							<feedback><p>Vector form is a tool for structure, but we still care about each variable's behavior.</p></feedback>
						</choice>
					</choices>
				</task>
			</exercise>
		</paragraphs>
	</subsection>
</section>