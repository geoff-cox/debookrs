<part><title> Laplace Transform Method </title>
	<introduction>
		<p>
			Solving an algebraic equation often involves isolating the unknown variable. However, in differential equations, the unknown is entangled within derivatives, making isolation more challenging. The Laplace Transform offers a powerful technique to temporarily reframe the equation, effectively <q>unwrapping</q> the derivatives and enabling a more straightforward isolation of the unknown, similar to algebra.
		</p>

		<p>
			By applying the Laplace Transform, the dependent variable is extracted from its derivatives and embedded within a special integral. This integral serves as a <q>container</q> that encapsulates the unknown function we seek. In this transformed state, these containers can be manipulated algebraically, allowing us to isolate the unknown function within. Once isolated, we can then revert the transform, releasing the function and revealing the solution.
		</p>

		<p>
			In essence, the Laplace Transform alters the mathematical landscape of a differential equation, simplifying the process of solving for the unknown function. This method is particularly powerful for tackling linear non-constant coefficient (LNCC) equations with discontinuous right-hand side functions.
		</p>

		<p>
			<assemblage xml:id="lt-roadmap"><title>Laplace Transform Big Picture Roadmap</title>
				<image source="figures/LT-Diagram-Steps-GIF.gif" width="100%">
					<shortdescription>(for accessibility)</shortdescription>
				</image>
			</assemblage>
		</p>

		<p>
			Throughout this chapter, we will frequently refer to this roadmap and apply it to the initial-value problem,
			<mdn xml:id="lt-model-ivp">
				<mrow xml:id="lt-model-equation">
					y'' + 3y' + 2y = -40e^{3t},
				</mrow>
				<mrow xml:id="lt-model-initial-values">
					y(0) = 0, \quad y'(0) = 1,
				</mrow>,
			</mdn>
			as a guiding example to illustrate the key concepts.
		</p>
			<me>s^2Y + 3sY + 2Y = \frac{-40}{s-3}.</me>
	</introduction>

	<chapter><title> Forward Transforms </title>

		<introduction>
			<p>
				To begin our exploration of the Laplace Transform, we start with the first step in the <xref ref="lt-roadmap" text="custom">Laplace Transform Roadmap</xref>, known as the forward Laplace transform. This step is foundational, as it sets the stage for the subsequent transformations outlined in the roadmap.
			</p>

			<p>
				<figure xml:id="lt-roadmap-step1">
					<caption>The Forward Laplace Transform. Converting the <m>y(t)</m>-differential equation into the <m>Y(s)</m>-algebra equation.</caption>
					<image source="figures/LT-Diagram-Focused-Step-1.png" width="100%">
						<shortdescription>The Forward Laplace Transform</shortdescription>
					</image>
				</figure>
			</p>

			<p>
				Applying the forward Laplace transform to a differential equation involves converting both the left-hand side (LHS) and right-hand side (RHS) of the equation into their Laplace-transformed counterparts.
			</p>

			<p>
				This section investigates how individual functions, like <m>-40e^{3t}</m> in step 1, are transformed into expressions such as <m>-\frac{40}{s-3}</m>. In the next section, we will show where the <m>s^2Y + 3sY + 2Y + 9</m> comes from in the forward transform.
			</p>
		</introduction>

		<section><title> Motivation </title>
			<p>
				The Laplace transform is a powerful tool for solving differential equations by exploiting integration by parts and the properties of exponential functions. Before we dive into the details, let's recall the basic formula for integration by parts:
				<me>\int u\ dv = uv - \int v\ du</me>.
			</p>

			<p>
				In this equation, <m>u</m> and <m>v</m> are functions of <m>t</m>. So <m>dv = v' \, dt</m>, and <m>du = u' \, dt</m>. Now, we can rewrite this formula as:
				<me> 
					\ub{\int u v'\, dt}_{\text{derivative on }v} = u v - \ub{\int v u'\, dt}_{\text{derivative on }u}
				</me>.
			</p>

			<p>
				Notice how the derivative initially applied to <m>v</m> on the left-hand side shifts over to <m>u</m> on the right-hand side. This ability to transfer derivatives between functions within an integral forms the core idea behind the Laplace transform.
			</p>

			<p>
				Let's see this concept in action. Consider an integral of the form:
				<me>\int e^{-st} y' \, dt</me>,
				where <m>s</m> is a constant. By setting <m>u = e^{-st}</m> and <m>dv = y' \, dt</m> in our integration by parts formula, we get:
				<me> 
					\os{\quad (1)}{\int \us{u}{\us{\uparrow}{\ul{e^{-st}\vphantom{y'}}}} \ \us{dv}{\us{\uparrow}{\ul{y' dt}}}} = 
					\us{u}{\us{\uparrow}{\ul{e^{-st}\vphantom{y}}}} \ \us{v}{\us{\uparrow}{\ul{y}}} - 
					\os{(2)}{\int \us{v}{\us{\uparrow}{\ul{y}}} \ \us{du}{\us{\uparrow}{\ul{(-s e^{-st} \ dt \vphantom{y})}}}} =
					e^{-st} \, y + s \os{\quad (3)}{\int e^{-st} \, y \, dt}
				</me>.
			</p>

			<p>
				What's happening here? The derivative on <m>y'</m> in integral <m>(1)</m> is effectively transferred to the exponential function <m>e^{-st}</m> in integral <m>(2)</m>, leaving an extra factor of <m>s</m> next to integral <m>(3)</m>. 
			</p>

			<p>
				This process of transferring derivatives between functions is a reoccuring theme in the Laplace transform method and in the coming sections, we will uncover how it uses this idea to solve a wide range of differential equations. 
			</p>

			<reading-questions><title> Check-Point Questions </title>
				<exercise label="p4-c1-s1-rq1"><title> <em>The Laplace transform method is leverages which concepts to solve differential equations?</em> </title>
					<statement/>
					<choices>
						<choice>
							<statement><p>Chain Rule</p></statement>
							<feedback>
								<p>
									Incorrect. The chain rule is not a key feature of the Laplace transform method. Think about a process that allows you to transfer derivatives.
								</p>
							</feedback>
						</choice>
						<choice>
							<statement><p>Product Rule</p></statement>
							<feedback>
								<p>
									No, the product rule is not a key concept in the Laplace transform method. Consider a method related to integration.
								</p>
							</feedback>
						</choice>
						<choice correct="yes">
							<statement><p>Integration by Parts</p></statement>
							<feedback>
								<p>
									Correct! The Laplace transform method leverages integration by parts to move derivatives from one function to another inside integrals.
								</p>
							</feedback>
						</choice>
						<choice correct="yes">
							<statement><p>Properties of Exponential Functions</p></statement>
							<feedback>
								<p>
									Correct! The Laplace transform method uses the properties of exponential functions, especially their behavior under differentiation and integration, to solve differential equations.
								</p>
							</feedback>
						</choice>
					</choices>
				</exercise>

				<exercise label="p4-c1-s1-rq2"><title> <em>Which concept from calculus allows you to transfer the derivative of one function to another inside an integral?</em> </title>
					<statement/>

					<choices>
						<choice>
							<statement><p>Chain Rule</p></statement>
							<feedback>
								<p>
									Incorrect. The chain rule is used for compositions of functions, not for transferring derivatives within integrals. Try again.
								</p>
							</feedback>
						</choice>
						<choice>
							<statement><p>L'Hopital's Rule</p></statement>
							<feedback>
								<p>
									Incorrect. L'Hopital's Rule is used to evaluate limits of indeterminate forms, not to transfer derivatives within integrals.
								</p>
							</feedback>
						</choice>
						<choice correct="yes">
							<statement><p>Integration by Parts</p></statement>
							<feedback>
								<p>
									Correct! Integration by Parts allows the transfer of a derivative from one function to another inside an integral, a fundamental tool in the Laplace transform method.
								</p>
							</feedback>
						</choice>
						<choice>
							<statement><p>Implicit Differentiation</p></statement>
							<feedback>
								<p>
									Incorrect. Implicit differentiation is used to differentiate equations where the variable isnâ€™t isolated, not to transfer derivatives within integrals.
								</p>
							</feedback>
						</choice>
					</choices>
				</exercise>

				<exercise label="p4-c1-s1-rq3"><title> <em><m>\ds\frac{d}{dt}\left[e^{-st}\right] =</m> <fillin characters="10" /></em> </title>
					<statement/>
					<choices>
						<choice correct="yes">
							<statement><m>-se^{-st}</m></statement>
							<feedback>
								<p>
									Correct! The derivative of <m>e^{-st}</m> with respect to <m>t</m> is <m>-se^{-st}</m>.
								</p>
							</feedback>
						</choice>
						<choice>
							<statement><m>e^{-st}</m></statement>
							<feedback>
								<p>
									Incorrect. The derivative should include a factor of <m>-s</m> due to the chain rule. 
								</p>
							</feedback>
						</choice>
						<choice>
							<statement><m>se^{-st}</m></statement>
							<feedback>
								<p>
									Incorrect. The derivative should be negative because the exponent of <m>e^{-st}</m> has a negative sign.
								</p>
							</feedback>
						</choice>
						<choice>
							<statement><m>-\frac{1}{s}e^{-st}</m></statement>
							<feedback>
								<p>
									Incorrect. This expression incorrectly represents the derivative of <m>e^{-st}</m>. Think about applying the chain rule to the exponent.
								</p>
							</feedback>
						</choice>
					</choices>
				</exercise>

				<exercise label="p4-c1-s1-rq4"><title> <em>Select the result of applying integration by parts to the integral, <m>\ \ \ds \int t^2 \ y'\ dt</m></em> </title>
					<statement/>
					<choices>
						<choice>
							<statement>
								<m>\ds \int t^2 \ y'\ dt = t^2\, y - \int y \ dt</m>
							</statement>
							<feedback>
								<p>
									Incorrect. Pay close attention to how integration by parts is applied. Try again.
								</p>
							</feedback>
						</choice>
						<choice>
							<statement>
								<m>\ds \int t^2 \ y'\ dt = t^2 y - \int t^2\, y \ dt</m>
							</statement>
							<feedback>
								<p>
									Incorrect. You need to transfer the derivative correctly by choosing the appropriate <m>u</m> and <m>dv</m>.
								</p>
							</feedback>
						</choice>
						<choice>
							<statement>
								<m>\ds \int t^2 \ y'\ dt = 2\int t\, y \ dt</m>
							</statement>
							<feedback>
								<p>
									Incorrect. This result is incorrect due to a missing term. Try applying integration by parts again.
								</p>
							</feedback>
						</choice>
						<choice correct="yes">
							<statement>
								<m>\ds \int t^2 \ y'\ dt = t^2\, y - 2\int t\, y \ dt</m>
							</statement>
							<feedback>
								<p>
									Correct! The result of applying integration by parts to <m>\ds \int t^2 \ y'\ dt</m> is <m>t^2 y - 2\int t \ y \ dt</m>.
								</p>
							</feedback>
						</choice>
					</choices>
				</exercise>
			</reading-questions>
		</section>

		<section><title> Definition </title>
			<p>
				In the previous section, we mentioned the importance of integration by parts and <m>e^{-st}</m> to the Laplace transform process. To perform a Laplace transform is to multiply both sides of an equation by <m>e^{-st}</m> and integrate with respect to <m>t</m>. For instance, applying this process to the equation 
				<me>
					e^{-st} \left( y'' + 3y' + 2y \right) = -40e^{3t}
				</me>
				would look like this:
				<md>
					<mrow> 
						e^{-st} \left( y'' + 3y' + 2y \right) 
							=\amp\ e^{-st} \left( -40e^{3t} \right)
					</mrow>
					<mrow> 
						\int e^{-st} \left( y'' + 3y' + 2y \right) \, dt 
							=\amp\ \int e^{-st} \left( -40e^{3t} \right) \, dt
					</mrow>
					<mrow> 
						\ub{\int e^{-st} {\color{blue} y''} \, dt}_{\text{transform of } {\color{blue} y''}} + 
						3\ub{\int e^{-st} {\color{blue} y'} \, dt}_{\text{transform of } {\color{blue} y'}} + 
						2\ub{\int e^{-st} {\color{blue} y} \, dt}_{\text{transform of } {\color{blue} y}} 
							=\amp\ \ub{\int e^{-st} \left( {\color{blue} -40e^{3t}} \right) \, dt}_{\text{transform of } {\color{blue} -40e^{3t}}}
					</mrow>
				</md>.
				As this shows, applying the transform to the equation amounts to applying it to each term of our original equation (in blue). The following definition of the Laplace transform makes this more precise.
			</p>

			<definition><title>Laplace Transform</title>
				<statement>
					The <term>Laplace Transform</term> of a given function <m>f(t)</m> is defined as

					<me> \lap{ {\color{blue} f(t)} } = \int_0^{\infty} e^{-st} {\color{blue} f(t)}\ dt,</me>

					provided that the integral exists (i.e., the improper integral converges).
				</statement>
			</definition>

			<p>
				This definition may appear daunting at first glance, but let's break it down. The <m>\infty</m> in the upper limit signals that we are dealing with an improper integral. In calculus, we learned that improper integrals can be understood as limits. Specifically:
			</p>
			
			<me>
				\int_0^{\infty} e^{-st} f(t)\, dt = \ub{\lim_{b \to \infty} \ob{\int_0^b e^{-st} f(t)\, dt}^{\text{step 1: compute the integral}}}_{\text{step 2: compute the limit}}
			</me>
			
			<p>
				Notice that while the integral involves both <m>s</m> and <m>t</m>, the integration is performed with respect to <m>t</m>. If you're unfamiliar with handling multiple variables like this, simply treat <m>s</m> as a constant during the integration process. Now, let's walk through an example to see this concept in action.
			</p>
			
			<example>
				<m>\ \ </m>Compute <m>\ds \lap{1}</m>.

				<solution>
					<p>
						By the definition above, we have the improper integral
						<men xml:id="lt-1-example-eqn-1"> 
							\lap{1} = \int_0^{\infty} e^{-st} \cdot 1\ dt = \lim_{b \to \infty} \ub{\int_0^b e^{-st}dt}_{I}
						</men>.
						To evaluate this, we treat <m>s</m> as a constant and integrate with respect to <m>t</m>.
						<md>
							<mrow>				
								I = \int_0^b e^{-st}dt
								=\amp\ -\frac{1}{s}e^{-st}\Big|_{t=0}^{t=b}
							</mrow>
							<mrow>			
								=\amp\ -\frac{1}{s}\left[ e^{-sb} - e^{-s\cdot 0} \right]
							</mrow>
							<mrow>			
								=\amp\ -\frac{1}{s}\left[ e^{-sb} - 1 \right]
							</mrow>
						</md>
						Now that we have <m>I</m>, we can plug it into the limit above.
						<md>
							<mrow> 
								\lim_{b \to \infty} -\frac{1}{s}\left[ e^{-sb} - 1 \right]
								=\amp\ -\frac{1}{s} \lim_{b \to \infty} \Big[ e^{-sb} - 1 \Big] 
								\qquad \leftarrow <xref text="custom" ref="reason-factor-out-s">why?</xref>
							</mrow>
							<mrow> 
									=\amp\ -\frac{1}{s} \Big[ \ub{\lim_{b \to \infty} e^{-sb}}_{L} - \us{=\ 1}{\ub{\lim_{b \to \infty} 1}} \Big] 
							</mrow>
						</md>
					</p>
			
					<p>
						The value of the remaining limit, <m>L</m>, depends on whether <m>s</m> is positive or negative. So we consider both cases:
						<ul>
							<li>
								<p>
									<line><m>s &lt; 0:\ </m> Since <m>\ds e^{-(\text{negative})b} = e^{(\text{positive})b} \to \infty</m> as <m>b \to \infty</m></line>
									<line><m>\hspace{4.0em} \implies\ </m> limit diverges (does not exist) when <m>s &lt; 0</m>.</line>
								</p>
							</li>
							<li>
								<p>
									<line><m>s &gt; 0:\ </m> Since <m>\ds e^{-(\text{positive})b} = e^{(\text{negative})b} \to 0</m> as <m>b \to \infty</m></line>
									<line><m>\hspace{4.0em} \implies\ </m> limit converges (exists) when <m>s &gt; 0</m>.</line>
								</p>
							</li>
						</ul>
						To visualize this, here is a <xref ref="compare-exp-graphs" text="custom">graph</xref> comparing <m>s=-1.2\ </m> versus <m>\, +1.2</m>.
					</p>
			
					<p>
						Therefore, when <m>s &gt; 0</m> the Laplace transform exists and evaluates to
						<me>\lap{1} = -\frac{1}{s} [0 - 1] = \frac{1}{s} \quad \text{for } s \gt 0.</me>
					</p>
				</solution>
			</example>

			<p>
				Now that we've worked through an example, here are a few key takeaways:
			</p>
			
			<ul marker="square">
				<li>
				<p>
					The Laplace transform always results in a function of <m>s</m>. We typically denote the Laplace transform of <m>f(t)</m> as <m>F(s)</m>. For instance,
					<me> \lap{f(t)} = F(s) \quad \text{or} \quad \lap{q(t)} = Q(s).</me>
				</p>
				</li>
			
				<li>
				<p>
					The values of <m>s</m> for which the integral converges are crucial. While these values usually don't affect the solution to the differential equation, we will make a habit of noting them as we build our Laplace transform toolbox.
				</p>
				</li>
			
				<li>
				<p>
					The notation <m>\lap{}</m> includes curly braces to indicate the function being transformed. These braces are essential, not optional.
				</p>
				</li>
			</ul>
			
			<p>
				With this, we've introduced our first Laplace transform. In the next section, we will explore a collection of common transforms that are used to solve differential equations.
			</p>

			<assemblage xml:id="lt-table-L1"><title>Common Laplace Transform <m>L_1</m></title>
				<p>
					<dl width="narrow">
						<li xml:id="L1"><title><m>{\LARGE \vphantom{\int}}L_1</m></title>
							<m>\ds \lap{ 1 } = \frac{1}{s}, \quad s &gt; 0 </m>
						</li>
					</dl>
				</p>
			</assemblage>

			<reading-questions><title> Check-Point Questions </title>
				<exercise><title> <em>The Laplace transform only exists if the improper integral converges</em> </title>
					<statement correct="yes"/>
					<feedback>
						<p>
							This statement is true. The Laplace transform is defined by an improper integral, and it only exists when this integral converges. If the integral diverges, the Laplace transform is not defined.
						</p>
					</feedback>
				</exercise>

				<exercise><title> <em>Which of the following best describes the Laplace transform of <m>f(t)</m>?</em> </title>
					<statement/>
					<choices>
						<choice>
							<statement><p>A function of <m>t</m> that solves differential equations.</p></statement>
							<feedback>
								<p>
									No, the Laplace transform is a function of <m>s</m> and is used to simplify the process of solving differential equations.
								</p>
							</feedback>
						</choice>
						<choice correct="yes">
							<statement><p>A function of <m>s</m> found by integrating <m>f(t)</m> multiplied by <m>\ds e^{-st}</m>.</p></statement>
							<feedback>
								<p>
									Correct! The Laplace transform converts a function of <m>t</m> into a function of <m>s</m> by integrating <m>f(t)</m> multiplied by <m>\ds e^{-st}</m>.
								</p>
							</feedback>
						</choice>
						<choice>
							<statement><p>A quadratic function of <m>s</m>.</p></statement>
							<feedback>
								<p>
									No, the Laplace transform is not necessarily a quadratic function; it depends on the original function <m>f(t)</m>.
								</p>
							</feedback>
						</choice>
						<choice>
							<statement><p>The anti-derivative of <m>f(t)</m>.</p></statement>
							<feedback>
								<p>
									While the Laplace transform involves integration, it is not the anti-derivative of <m>f(t)</m>.
								</p>
							</feedback>
						</choice>
					</choices>
				</exercise>
				
				<exercise><title> <em>What is the result of the Laplace transform of the constant function 1?</em> </title>
					<statement/>
					<choices>
						<choice>
							<statement><p><m>\ds \frac{1}{t}</m></p></statement>
							<feedback>
								<p>
									No, <m>\ds \frac{1}{t}</m> is not the result of the Laplace transform of 1.
								</p>
							</feedback>
						</choice>
						<choice correct="yes">
							<statement><p><m>\ds \frac{1}{s}</m></p></statement>
							<feedback>
								<p>
									Correct! The Laplace transform of the constant function 1 is <m>\ds \frac{1}{s}</m> for <m>s &gt; 0</m>.
								</p>
							</feedback>
						</choice>
						<choice>
							<statement><p><m>\ds \frac{1}{t+s}</m></p></statement>
							<feedback>
								<p>
									No, this is not the correct expression for the Laplace transform of 1.
								</p>
							</feedback>
						</choice>
						<choice>
							<statement><p><m>\ds \frac{1}{t-s}</m></p></statement>
							<feedback>
								<p>
									No, this expression does not represent the Laplace transform of 1.
								</p>
							</feedback>
						</choice>
					</choices>
				</exercise>

				<exercise><title> <em>The Laplace transform is defined as <m>\ds\lap{ f(t) } = \int_0^{\infty} e^{-st} f(t)\, dt</m>, provided the <fillin characters="10" /> exists</em> </title>
					<statement/>
					<choices>
						<choice correct="yes">
							<statement><p>integral</p></statement>
							<feedback>
								<p>
									Correct! The Laplace transform is defined only if the integral converges.
								</p>
							</feedback>
						</choice>
						<choice>
							<statement><p>function</p></statement>
							<feedback>
								<p>
									No, it is the convergence of the integral that determines whether the Laplace transform is defined.
								</p>
							</feedback>
						</choice>
						<choice>
							<statement><p><m>s</m>-value</p></statement>
							<feedback>
								<p>
									No, the Laplace transform is defined by an integral, not by a specific <m>s</m>-value.
								</p>
							</feedback>
						</choice>
						<choice>
							<statement><p>derivative</p></statement>
							<feedback>
								<p>
									No, the Laplace transform is defined by an integral, not by a derivative.
								</p>
							</feedback>
						</choice>
					</choices>
				</exercise>
				
				<exercise><title> <em>In the Laplace transform integral, the variable <m>s</m> is treated as a <fillin characters="10" /> during the integration process</em> </title>
					<statement/>
					<choices>
						<choice correct="yes">
							<statement><p>constant</p></statement>
							<feedback>
								<p>
									Correct! The variable <m>s</m> is treated as a constant when performing the integration in the Laplace transform.
								</p>
							</feedback>
						</choice>
						<choice>
							<statement><p>variable</p></statement>
							<feedback>
								<p>
									No, while <m>s</m> is technically a variable, it is treated as a constant during the integration with respect to <m>t</m>.
								</p>
							</feedback>
						</choice>
						<choice>
							<statement><p>coefficient</p></statement>
							<feedback>
								<p>
									No, <m>s</m> is treated as a constant, not as a coefficient, during the integration process.
								</p>
							</feedback>
						</choice>
						<choice>
							<statement><p>limit</p></statement>
							<feedback>
								<p>
									No, <m>s</m> does not represent a limit in this context; it is treated as a constant.
								</p>
							</feedback>
						</choice>
					</choices>
				</exercise>
				
				<exercise><title> <em>Fill-in-the-Blank. The process of finding a Laplace transform involves multiplying the original function by <m>\ul{\hspace{5em}}</m> and <m>\ul{\hspace{5em}}</m> with respect to <m>t</m></em> </title>
					<statement/>
					<choices>
						<choice>
							<statement><p><m>\ds \ e^{-t}, \ </m> integrating</p></statement>
							<feedback>
								<p>
									No, the correct expression involves the exponential function <m>\ds e^{-st}</m>.
								</p>
							</feedback>
						</choice>
						<choice correct="yes">
							<statement><p><m>\ds \ e^{-st}, \ </m> integrating</p></statement>
							<feedback>
								<p>
									Correct! The Laplace transform involves multiplying the original function by <m>\ds e^{-st}</m> and integrating with respect to <m>t</m>.
								</p>
							</feedback>
						</choice>
						<choice>
							<statement><p><m>\ds \ e^{st}, \ </m> integrating</p></statement>
							<feedback>
								<p>
									No, the correct expression involves the exponential function <m>\ds e^{-st}</m>.
								</p>
							</feedback>
						</choice>
						<choice>
							<statement><p><m>\ds \ e^{-st}, \ </m> differentiating</p></statement>
							<feedback>
								<p>
									No, the Laplace transform involves integrating with respect to <m>t</m>.
								</p>
							</feedback>
						</choice>
						<choice>
							<statement><p><m>\ds \ s, \ </m> differentiating</p></statement>
							<feedback>
								<p>
									No, the correct form involves the exponential function <m>\ds e^{-st}</m> and integrating with respect to <m>t</m>.
								</p>
							</feedback>
						</choice>
					</choices>
				</exercise>
			</reading-questions>
		</section>

	</chapter>

</part>